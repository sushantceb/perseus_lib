webpackJsonpPerseus([1],[,,,,,,,,,,,,,,,function(e,t,n){"use strict";e.exports=[[n(39),!1],[n(40),!1],[n(41),!1],[n(42),!1],[n(43),!1],[n(44),!1],[n(45),!1],[n(46),!1],[n(47),!1],[n(48),!1],[n(49),!1],[n(50),!1],[n(51),!1],[n(52),!1],[n(53),!1],[n(54),!1],[n(55),!1],[n(56),!1],[n(57),!1],[n(58),!1],[n(59),!1],[n(60),!1],[n(61),!1],[n(62),!1],[n(63),!1],[n(64),!1],[n(65),!1],[n(66),!1],[n(67),!1],[n(68),!1],[n(69),!1],!1,!1,!1]},,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r,i=n(13),o=i.StyleSheet,s=i.css,a=n(10),p=n(12),l=n(80),u=n(93),c=n(9),h=n(17).ClassNames,d=n(17).Options,f=n(84),g=f.iconCircle,m=f.iconCircleThin,v=n(81),y=n(8),b=n(16),T=n(34),P=n(35),x=a.createClass({displayName:"Categorizer",mixins:[u,l],propTypes:{apiOptions:d.propTypes,categories:a.PropTypes.arrayOf(a.PropTypes.string),items:a.PropTypes.arrayOf(a.PropTypes.string),trackInteraction:a.PropTypes.func.isRequired,values:a.PropTypes.arrayOf(a.PropTypes.number)},getDefaultProps:function(){return{items:[],categories:[],values:[]}},getInitialState:function(){return{uniqueId:c.uniqueId("perseus_radio_")}},render:function(){var e=this,t=this,n=this.props.apiOptions.isMobile,r=this.props.items.map(function(e,t){return[e,t]});this.props.randomizeItems&&(r=b.shuffle(r,this.props.problemNum));var i=a.createElement("table",{className:"categorizer-table"},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null,"Â "),this.props.categories.map(function(e,t){return a.createElement("th",{className:s(E.header),key:t},a.createElement(y,{content:e}))}))),a.createElement("tbody",null,r.map(function(r){var i=r[0],o=r[1],p=t.state.uniqueId+"_"+o;return a.createElement("tr",{key:o},a.createElement("td",null,a.createElement(y,{content:i})),c.range(t.props.categories.length).map(function(r){var i=t.props.values[o]===r;return a.createElement("td",{className:"category "+s(E.cell,E.responsiveCell),key:r},a.createElement("div",{className:h.INTERACTIVE,onClick:e.onChange.bind(e,o,r)},n&&a.createElement("input",{type:"radio",name:p,className:s(P.responsiveInput,P.responsiveRadioInput),checked:i,onChange:e.onChange.bind(e,o,r),onClick:function(e){return e.stopPropagation()}}),!n&&a.createElement("span",{className:s(E.responsiveSpan,E.radioSpan,i&&E.checkedRadioSpan,e.props.static&&i&&E.staticCheckedRadioSpan)},i?a.createElement(v,g):a.createElement(v,m))))}))}))),o=p({"categorizer-container":!0,"static-mode":this.props.static}),l=this.props.apiOptions.isMobile?[E.fullBleedContainer]:[];return a.createElement("div",{className:o+" "+s.apply(void 0,l)},i)},onChange:function(e,t){var n=c.clone(this.props.values);n[e]=t,this.change("values",n),this.props.trackInteraction()},simpleValidate:function(e){return x.validate(this.getUserInput(),e)}});c.extend(x,{validate:function(e,t){var n=!0,r=!0;return c.each(t.values,function(t,i){null==e.values[i]&&(n=!1),e.values[i]!==t&&(r=!1)}),n?{type:"points",earned:r?1:0,total:1,message:null}:{type:"invalid",message:i18n._("Make sure you select something for every row.")}}});var C=16,E=o.create({fullBleedContainer:(r={},r[T.mdOrSmaller]={marginLeft:-C,marginRight:-C,overflowX:"auto"},r),header:{textAlign:"center",verticalAlign:"bottom"},cell:{textAlign:"center",padding:0,color:"#ccc",verticalAlign:"middle"},radioSpan:{fontSize:30,paddingRight:3,":hover":{color:"#999"}},checkedRadioSpan:{color:"#333"},staticCheckedRadioSpan:{color:"#888"}});e.exports={name:"categorizer",displayName:"Categorizer",widget:x,transform:function(e){return c.pick(e,"items","categories","randomizeItems")},staticTransform:function(e){return c.pick(e,"items","categories","values","randomizeItems")}}},function(e,t,n){"use strict";function r(e){var t=u.replace("{programID}",e),n=document.location.hostname,r="www.khanacademy.org";return l.test(n)&&(r=n),t.replace("{hostname}",r)}var i=n(10),o=n(9),s=n(80),a=n(16).updateQueryString,p=2,l=/khanacademy\.org/,u="https://{hostname}/computer-programming/program/{programID}/embedded?embed=yes&author=no",c=i.createClass({displayName:"CSProgram",mixins:[s],propTypes:{programID:i.PropTypes.string,width:i.PropTypes.number,height:i.PropTypes.number,settings:i.PropTypes.array,showEditor:i.PropTypes.bool,showButtons:i.PropTypes.bool,status:i.PropTypes.oneOf(["incomplete","incorrect","correct"]),message:i.PropTypes.string},getDefaultProps:function(){return{showEditor:!1,showButtons:!1,status:"incomplete",message:null}},handleMessageEvent:function(e){var t={};try{t=JSON.parse(e.originalEvent.data)}catch(e){return}if(!o.isUndefined(t.testsPassed)){var n=t.testsPassed?"correct":"incorrect";this.change({status:n,message:t.message})}},componentDidMount:function(){$(window).on("message",this.handleMessageEvent)},componentWillUnmount:function(){$(window).off("message",this.handleMessageEvent)},render:function(){if(!this.props.programID)return i.createElement("div",null);var e,t=r(this.props.programID),n={height:this.props.height};if(this.props.showEditor?(t+="&editor=yes",n.width="100%",e="perseus-scratchpad-editor"):(t+="&editor=no",n.width=this.props.width+p,e="perseus-scratchpad"),this.props.showButtons?(t+="&buttons=yes",n.height+=50):t+="&buttons=no",this.props.settings){var s={};o.each(this.props.settings,function(e){e.name&&e.value&&(s[e.name]=e.value)}),t=a(t,"settings",JSON.stringify(s))}return i.createElement("iframe",{sandbox:"allow-same-origin allow-scripts",src:t,style:n,className:e,allowFullScreen:!0})},simpleValidate:function(e){return c.validate({status:this.props.status,message:this.props.message},e)},statics:{validate:function(e,t){return"correct"===e.status?{type:"points",earned:1,total:1,message:e.message||null}:"incorrect"===e.status?{type:"points",earned:0,total:1,message:e.message||null}:{type:"invalid",message:"Keep going, you're not there yet!"}}}});e.exports={name:"cs-program",displayName:"CS Program",supportedAlignments:["block","full-width"],widget:c}},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(13),o=i.StyleSheet,s=i.css,a=n(12),p=n(10),l=n(11),u=n(9),c=n(17).ClassNames,h=n(17).Options,d=n(81),f=n(36),g=n(84),m=g.iconDropdownArrow,v=n(16).captureScratchpadTouchStart,y=24,b=p.createClass({displayName:"Dropdown",propTypes:{apiOptions:h.propTypes,choices:p.PropTypes.arrayOf(p.PropTypes.string),onChange:p.PropTypes.func.isRequired,placeholder:p.PropTypes.string,selected:p.PropTypes.number,trackInteraction:p.PropTypes.func.isRequired},getDefaultProps:function(){return{choices:[],selected:0,placeholder:"",apiOptions:h.defaults}},render:function(){var e=this.props.choices.slice(),t=a({"perseus-widget-dropdown":!0});return p.createElement("div",null,p.createElement("select",{onChange:this._handleChangeEvent,onTouchStart:v,className:t+" "+s(P.dropdown)+" "+c.INTERACTIVE,disabled:this.props.apiOptions.readOnly,value:this.props.selected},p.createElement("option",{value:0,disabled:!0},this.props.placeholder),e.map(function(e,t){return p.createElement("option",{key:""+(t+1),value:t+1},e)})),p.createElement(d,r({},m,{style:{marginLeft:"-"+y+"px",height:y,width:y}})))},focus:function(){return l.findDOMNode(this).focus(),!0},_handleChangeEvent:function(e){this._handleChange(parseInt(e.target.value))},_handleChange:function(e){this.props.trackInteraction(),this.props.onChange({selected:e})},getUserInput:function(){return{value:this.props.selected}},simpleValidate:function(e){return b.validate(this.getUserInput(),e)}});u.extend(b,{validate:function(e,t){var n=e.value;if(0===n)return{type:"invalid",message:null};var r=t.choices[n-1].correct;return{type:"points",earned:r?1:0,total:1,message:null}}});var T=function(e){return{placeholder:e.placeholder,choices:u.map(e.choices,function(e){return e.content})}},P=o.create({dropdown:{appearance:"none",backgroundColor:"transparent",border:"1px solid "+f.gray76,borderRadius:4,boxShadow:"none",fontFamily:f.baseFontFamily,padding:"9px "+(y+1)+"px 9px 9px",":focus":{outline:"none",border:"2px solid "+f.kaGreen,padding:"8px "+y+"px 8px 8px"},":focus + svg":{color:""+f.kaGreen},":disabled":{color:f.gray68},":disabled + svg":{color:f.gray68}}});e.exports={name:"dropdown",displayName:"Drop down",defaultAlignment:"inline-block",accessible:!0,widget:b,transform:T}},function(e,t,n){"use strict";var r,i,o=n(13),s=o.StyleSheet,a=o.css,p=n(10),l=n(11),u=n(9),c=n(80),h=n(17),d=n(8),f=n(34),g=n(36),m={showPrompt:"Explain",hidePrompt:"Hide explanation",explanation:"explanation goes here\n\nmore explanation",widgets:{}},v=p.createClass({displayName:"Explanation",mixins:[c],propTypes:{apiOptions:h.Options.propTypes,explanation:p.PropTypes.string,hidePrompt:p.PropTypes.string,showPrompt:p.PropTypes.string,trackInteraction:p.PropTypes.func.isRequired,widgets:p.PropTypes.object},getDefaultProps:function(){return m},getInitialState:function(){return{expanded:!1,contentHeight:0}},_onClick:function(){this._updateHeight(),this.setState({expanded:!this.state.expanded}),this.props.trackInteraction()},_updateHeight:function(){var e=l.findDOMNode(this.refs.content),t=this.props.apiOptions.isMobile,n=2*b+2*P,r=Array.prototype.reduce.call(e.childNodes,function(e,t){return e+(t.offsetHeight||0)},t?0:n);r!==this.state.contentHeight&&this.setState({contentHeight:r})},componentDidMount:function(){this._updateHeight()},componentDidUpdate:function(e,t){e!==this.props&&this._updateHeight()},render:function(){var e=this.props.apiOptions.baseElements.Link,t=this.props.apiOptions,n=t.readOnly,r=t.isMobile,i=this.state.expanded?this.props.hidePrompt:this.props.showPrompt,o=void 0,s=n?null:"javascript:void(0)",l=n?null:this._onClick;o=r?p.createElement("div",{className:a(C.linkContainer)},p.createElement("a",{className:a(C.mobileExplanationLink),href:s,onClick:l},i),this.state.expanded&&p.createElement("svg",{className:a(C.disclosureArrow)},p.createElement("polygon",{style:{fill:x},points:"0,"+P+" "+(T+","+P+" ")+(T/2+",0")}))):p.createElement("div",{className:a(C.linkContainer)},p.createElement(e,{className:a(C.explanationLink),href:s,onClick:l},"["+i+"]"));var u=r?C.contentExpandedMobile:C.contentExpanded;return p.createElement("div",{className:a(C.container)},o,p.createElement("div",{className:a(C.content,r&&C.contentMobile,this.state.expanded&&u),style:{height:this.state.expanded?this.state.contentHeight:0,overflow:this.state.expanded?"visible":"hidden"},ref:"content"},p.createElement(d,{apiOptions:this.props.apiOptions,content:this.props.explanation,widgets:this.props.widgets})))},getUserInput:function(){return{}},simpleValidate:function(e){return v.validate(this.getUserInput(),e)}}),y=23,b=10,T=30,P=14,x=g.gray95,C=s.create({container:{display:"inline",position:"relative"},linkContainer:{display:"inline-block"},explanationLink:(r={fontStyle:"italic",color:"#007d96"},r[f.xl]={fontSize:20,lineHeight:1.1},r[f.lgOrSmaller]={fontSize:17,lineHeight:1.4},r[f.smOrSmaller]={fontSize:14,lineHeight:1.3},r),mobileExplanationLink:(i={color:g.kaGreen,borderBottom:"dashed 1px "+g.kaGreen,textDecoration:"none"},i[f.xl]={fontSize:22,lineHeight:1.4},i[f.lgOrSmaller]={fontSize:20,lineHeight:1.5},i[f.smOrSmaller]={fontSize:18,lineHeight:1.2},i),content:{position:"relative",transition:"all 0.1s"},contentExpanded:{borderLeft:"5px solid #ccc",marginLeft:-y,paddingLeft:y,paddingBottom:b,marginBottom:P,marginTop:P},contentExpandedMobile:{boxSizing:"content-box",paddingTop:32,paddingBottom:32,marginTop:P},contentMobile:{background:x,marginLeft:g.negativePhoneMargin,marginRight:g.negativePhoneMargin,paddingLeft:g.phoneMargin,paddingRight:g.phoneMargin},disclosureArrow:{bottom:-(P+5),height:P,left:"50%",marginLeft:-(T/2),position:"absolute",width:T}});u.extend(v,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),e.exports={name:"explanation",displayName:"Explanation (for hints)",defaultAlignment:"inline",widget:v,transform:u.identity}},function(e,t,n){"use strict";function r(e,t,n){var r=function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1])};return r(n[0],n[1],t)>0!=r(n[0],n[1],e)>0}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(10),s=n(9),a=n(94),p=n(32),l=n(16),u=n(95),c=n(86),h=c.MovablePoint,d=c.MovableLine,f=n(96),g=n(123).number,m=n(123).vector,v=n(123).point,y=n(97),b=n(72),T=b.containerSizeClassPropType,P=n(36),x=P.interactiveSizes,C=n(72),E=C.getInteractiveBoxFromSizeClass,k=n(80),M=n(112),w=M.GrapherUtil,S=M.typeToButton,I=M.functionForType,N=M.DEFAULT_GRAPHER_PROPS,R={padding:"5px 5px"},O=o.createClass({displayName:"FunctionGrapher",mixins:[k],_coords:function(e){e=e||this.props;var t=e.graph,n=e.model&&w.maybePointsFromNormalized(e.model.defaultCoords,t.range,t.step,t.snapStep);return e.coords||n||null},_asymptote:function(e){return e=e||this.props,e.asymptote},propTypes:{flexibleType:o.PropTypes.bool,graph:o.PropTypes.any,hideHairlines:o.PropTypes.func,isMobile:o.PropTypes.bool,model:o.PropTypes.any,onChange:o.PropTypes.func,setDrawingAreaAvailable:o.PropTypes.func,showHairlines:o.PropTypes.func,showTooltips:o.PropTypes.bool,static:o.PropTypes.bool},getDefaultProps:function(){return{graph:{range:[[-10,10],[-10,10]],step:[1,1]},coords:null,asymptote:null,isMobile:!1}},render:function(){var e=this,t=function(t,n){return o.createElement(h,{key:n,coord:t,static:e.props.static,constraints:[a.MovablePoint.constraints.bound(),a.MovablePoint.constraints.snap(),function(t){var r=s.all(e._coords(),function(e,r){return n===r||!e||!g.equal(t[0],e[0])});if(!r)return!1;if(e.props.model&&e.props.model.extraCoordConstraint){var i=e.props.model.extraCoordConstraint,o=s.clone(e._coords()),a=s.clone(o[n]);return o[n]=t,i(t,a,o,e._asymptote(),e.props.graph)}return r}],onMove:function(t,i){var o,a=e._asymptote();o=a&&e.props.model.allowReflectOverAsymptote&&r(t,i,a)?s.map(e._coords(),function(e){return v.reflectOverLine(e,a)}):s.clone(e._coords()),o[n]=t,e.props.onChange({coords:o})},showHairlines:e.props.showHairlines,hideHairlines:e.props.hideHairlines,showTooltips:e.props.showTooltips,isMobile:e.props.isMobile})},n=s.map(this._coords(),t),l=this.props.graph.box,u=this.props.graph.backgroundImage,d=null;if(u.url){var f=l[0]/x.defaultBoxSize;d=o.createElement(p,{src:u.url,width:u.width,height:u.height,scale:f})}return o.createElement("div",{className:"perseus-widget perseus-widget-grapher",style:{width:l[0],height:this.props.flexibleType?"auto":l[1],boxSizing:"initial"}},o.createElement("div",{className:"graphie-container above-scratchpad",style:{width:l[0],height:l[1]}},d,o.createElement(c,i({},this.props.graph,{setDrawingAreaAvailable:this.props.setDrawingAreaAvailable}),this.props.model&&this.renderPlot(),this.props.model&&this.renderAsymptote(),this.props.model&&n)))},renderPlot:function(){var e=this.props.model,t=this.props.graph.range[0],n=i({stroke:this.props.isMobile?y.BLUE_C:y.DYNAMIC},this.props.isMobile?{"stroke-width":3}:{}),r=e.getCoefficients(this._coords(),this._asymptote());if(r){var s=e.getPropsForCoeffs(r,t);return o.createElement(e.Movable,i({},s,{key:this.props.model.url,range:t,style:n}))}},renderAsymptote:function(){var e=this,t=this.props.model,n=this.props.graph,r=this._asymptote(),i={strokeDasharray:"- "};return r&&o.createElement(d,{onMove:function(t,n){var r=m.subtract(t,n),i=s.map(e._asymptote(),function(e){return m.add(e,r)});e.props.onChange({asymptote:i})},constraints:[a.MovableLine.constraints.bound(),a.MovableLine.constraints.snap(),function(r,i){var o=m.subtract(r,i),a=s.map(e._asymptote(),function(e){return m.add(e,o)});return!t.extraAsymptoteConstraint||t.extraAsymptoteConstraint(r,i,e._coords(),a,n)}],normalStyle:i,highlightStyle:i},s.map(r,function(t,n){return o.createElement(h,{key:"asymptoteCoord-"+n,coord:t,static:!0,draw:null,extendLine:!0,showHairlines:e.props.showHairlines,hideHairlines:e.props.hideHairlines,showTooltips:e.props.showTooltips,isMobile:e.props.isMobile})}))}}),A=o.createClass({displayName:"Grapher",propTypes:{apiOptions:o.PropTypes.any,availableTypes:o.PropTypes.arrayOf(o.PropTypes.any),containerSizeClass:T.isRequired,graph:o.PropTypes.any,markings:o.PropTypes.string,onChange:o.PropTypes.func,plot:o.PropTypes.any,static:o.PropTypes.bool,trackInteraction:o.PropTypes.func.isRequired},getDefaultProps:function(){return N},render:function(){var e=this.props.plot.type,t=this.props.plot.coords,n=this.props.plot.asymptote,r=o.createElement("div",{style:R,className:"above-scratchpad"},o.createElement(u,{value:e,allowEmpty:!0,buttons:s.map(this.props.availableTypes,S),onChange:this.handleActiveTypeChange})),a=E(this.props.containerSizeClass),p=i({},this.props.graph,w.getGridAndSnapSteps(this.props.graph,a[0]),{gridConfig:this._getGridConfig(i({},this.props.graph,{box:a},w.getGridAndSnapSteps(this.props.graph,a[0])))}),l={graph:{box:a,range:p.range,step:p.step,snapStep:p.snapStep,backgroundImage:p.backgroundImage,options:p,setup:this._setupGraphie},onChange:this.handlePlotChanges,model:e&&I(e),coords:t,asymptote:n,static:this.props.static,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable,isMobile:this.props.apiOptions.isMobile,showTooltips:this.props.graph.showTooltips,showHairlines:this.showHairlines,hideHairlines:this.hideHairlines};return o.createElement("div",null,o.createElement(O,l),this.props.availableTypes.length>1&&r)},handlePlotChanges:function(e){var t=s.extend({},this.props.plot,e);this.props.onChange({plot:t}),this.props.trackInteraction()},handleActiveTypeChange:function(e){var t=this.props.graph,n=s.extend({},this.props.plot,w.defaultPlotProps(e,t));this.props.onChange({plot:n})},_getGridConfig:function(e){return s.map(e.step,function(t,n){return l.gridDimensionConfig(t,e.range[n],e.box[n],e.gridStep[n])})},_setupGraphie:function(e,t){var n=this.props.apiOptions.isMobile;if("graph"===t.markings?(e.graphInit({range:t.range,scale:s.pluck(t.gridConfig,"scale"),axisArrows:"<->",labelFormat:function(e){return"\\small{"+e+"}"},gridStep:t.gridStep,snapStep:t.snapStep,tickStep:n?l.constrainedTickStepsFromTickSteps(s.pluck(t.gridConfig,"tickStep"),t.range):s.pluck(t.gridConfig,"tickStep"),labelStep:1,unityLabels:s.pluck(t.gridConfig,"unityLabel"),isMobile:n}),e.label([0,t.range[1][1]],t.labels[1],n?"below right":"above"),e.label([t.range[0][1],0],t.labels[0],n?"above left":"right")):"grid"===t.markings?e.graphInit({range:t.range,scale:s.pluck(t.gridConfig,"scale"),gridStep:t.gridStep,axes:!1,ticks:!1,labels:!1,isMobile:n}):"none"===t.markings&&e.init({range:t.range,scale:s.pluck(t.gridConfig,"scale")}),this.props.apiOptions.isMobile){var r={normalStyle:{strokeWidth:1}};this.horizHairline=new f(e,[0,0],[0,0],r),this.horizHairline.attr({stroke:y.INTERACTIVE}),this.horizHairline.hide(),this.vertHairline=new f(e,[0,0],[0,0],r),this.vertHairline.attr({stroke:y.INTERACTIVE}),this.vertHairline.hide()}},showHairlines:function(e){this.props.apiOptions.isMobile&&"none"!==this.props.markings&&(this.horizHairline.moveTo([this.props.graph.range[0][0],e[1]],[this.props.graph.range[0][1],e[1]]),this.horizHairline.show(),this.vertHairline.moveTo([e[0],this.props.graph.range[1][0]],[e[0],this.props.graph.range[1][1]]),this.vertHairline.show())},hideHairlines:function(){this.props.apiOptions.isMobile&&(this.horizHairline.hide(),this.vertHairline.hide())},simpleValidate:function(e){return w.validate(this.getUserInput(),e)},getUserInput:function(){return this.props.plot},focus:$.noop}),_=function(e){var t={availableTypes:e.availableTypes,graph:e.graph};if(1===t.availableTypes.length){var n=t.graph,r=w.chooseType(t.availableTypes);t.plot=w.defaultPlotProps(r,n)}return t},D=function(e){return s.extend({},_(e),{availableTypes:[e.correct.type],plot:e.correct})};e.exports={name:"grapher",displayName:"Grapher",widget:A,transform:_,staticTransform:D}},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(12),o=n(10),s=n(9),a=n(17).Options,p=n(80),l=n(84),u=l.iconOk,c=l.iconRemove,h=(l.icon,n(81)),d=n(8),f=n(98),g=n(36),m=g.gray76,v=g.phoneMargin,y=g.negativePhoneMargin,b=g.tableBackgroundAccent,T=g.kaGreen,P=n(13),x=P.StyleSheet,C=P.css,E={ungraded:"ungraded",correct:"correct",incorrect:"incorrect",invalid:"invalid"},k=f.ANSWER_BAR_STATES,M=function(e,t){switch(e){case k.HIDDEN:return t?k.ACTIVE:e;case k.ACTIVE:return t?e:k.INACTIVE;case k.INACTIVE:return t?k.ACTIVE:e;case k.INCORRECT:return t?k.ACTIVE:k.INACTIVE;default:return e}},w="We couldn't grade your answer.",S="It looks like you left something blank or entered in an invalid answer.",I=o.createClass({displayName:"GradedGroup",propTypes:{apiOptions:a.propTypes,content:o.PropTypes.string,hasHint:o.PropTypes.bool,hint:o.PropTypes.object,images:o.PropTypes.object,inGradedGroupSet:o.PropTypes.bool,onBlur:o.PropTypes.func,onFocus:o.PropTypes.func,onNextQuestion:o.PropTypes.func,title:o.PropTypes.string,trackInteraction:o.PropTypes.func.isRequired,widgets:o.PropTypes.object},mixins:[p],getDefaultProps:function(){return{title:"",content:"",widgets:{},images:{},hint:null,hasHint:!1}},getInitialState:function(){return{status:E.ungraded,showHint:!1,message:"",answerBarState:k.HIDDEN}},shouldComponentUpdate:function(e,t){return e!==this.props||t!==this.state},_onInteractWithWidget:function(e){if(this.setState({status:E.ungraded,message:""}),this.refs.renderer){this.change("widgets",this.props.widgets);var t=this.refs.renderer.emptyWidgets(),n=0===t.length,r=this.state.answerBarState;this.setState({answerBarState:M(r,n)})}},_checkAnswer:function(){var e=this.refs.renderer.score(),t=void 0,n=void 0;"points"===e.type?(t=e.total===e.earned?E.correct:E.incorrect,n=e.message||""):(t=E.invalid,n=e.message?w+" "+e.message:w+" "+S),this.setState({status:t,message:n,answerBarState:"correct"===t?k.CORRECT:k.INCORRECT}),this.props.trackInteraction({status:t})},getInputPaths:function(){return this.refs.renderer.getInputPaths()},setInputValue:function(e,t,n){return this.refs.renderer.setInputValue(e,t,n)},getAcceptableFormatsForInputPath:function(e){return this.refs.renderer.getAcceptableFormatsForInputPath(e)},focus:function(){return this.refs.renderer.focus()},focusInputPath:function(e){this.refs.renderer.focusPath(e)},blurInputPath:function(e){this.refs.renderer.blurPath(e)},render:function(){var e,t=this,n=s.extend({},a.defaults,this.props.apiOptions,{onFocusChange:function(e,n){n&&t.props.onBlur(n),e&&t.props.onFocus(e)}}),p=null;this.state.status===E.correct?p=o.createElement(h,r({},u,{style:{color:"#526f03"}})):this.state.status===E.incorrect&&(p=o.createElement(h,r({},c,{style:{color:"#ff5454"}})));var l=C(this.props.inGradedGroupSet?R.gradedGroupInSet:R.gradedGroup),g=i((e={},e[l]=n.isMobile,e["perseus-graded-group"]=!0,e["answer-correct"]=!n.isMobile&&this.state.status===E.correct,e["answer-incorrect"]=!n.isMobile&&this.state.status===E.incorrect,e)),m=this.state.answerBarState,v=m===k.CORRECT,y=n.readOnly||n.isMobile&&v;return o.createElement("div",{className:g},!!this.props.title&&o.createElement("div",{className:C(R.title)},this.props.title),o.createElement(d,r({},this.props,{ref:"renderer",apiOptions:r({},n,{readOnly:y}),onInteractWithWidget:this._onInteractWithWidget})),!n.isMobile&&p&&o.createElement("div",{className:"group-icon"},p),!n.isMobile&&o.createElement("p",null,this.state.message),!n.isMobile&&o.createElement("input",{type:"button",value:i18n._("Check"),className:"simple-button",disabled:this.props.apiOptions.readOnly,onClick:this._checkAnswer}),!n.isMobile&&v&&this.props.onNextQuestion&&o.createElement("input",{type:"button",value:i18n._("Next question"),className:"simple-button",disabled:this.props.apiOptions.readOnly,onClick:this.props.onNextQuestion,style:{marginLeft:5}}),this.props.hint&&this.props.hint.content&&(this.state.showHint?o.createElement("div",null,o.createElement("div",{className:C(R.explanationTitle),onClick:function(){return t.setState({showHint:!1})}},i18n._("Hide explanation")),o.createElement(d,r({},this.props.hint,{ref:"hints-renderer",apiOptions:n}))):o.createElement("div",{onClick:function(){return t.setState({showHint:!0})},className:C(R.showHintLink)},i18n._("Explain"))),n.isMobile&&m!==k.HIDDEN&&o.createElement(f,{apiOptions:n,answerBarState:m,onCheckAnswer:this._checkAnswer,onNextQuestion:this.props.onNextQuestion}))}}),N=function(e,t){return s.extend({},e,t(e))};e.exports={name:"graded-group",displayName:"Graded Group",widget:I,traverseChildWidgets:N,hidden:!1,tracking:"all"};var R=x.create({gradedGroupInSet:{marginLeft:0,paddingLeft:0},gradedGroup:{borderTop:"1px solid "+m,borderBottom:"1px solid "+m,backgroundColor:b,marginLeft:y,marginRight:y,paddingBottom:v,paddingLeft:v,paddingRight:v,paddingTop:10,width:"auto"},showHintLink:{marginTop:20,color:T,cursor:"pointer"},explanationTitle:{marginTop:20,color:T,marginBottom:10,cursor:"pointer"},title:{fontSize:12,color:m,textTransform:"uppercase",marginBottom:11,letterSpacing:.8}})},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(10),o=(n(9),n(13)),s=o.StyleSheet,a=o.css,p=n(17).Options,l=n(80),u=n(44).widget,c=n(36),h=c.grayLight,d=c.gray76,f=c.tableBackgroundAccent,g=c.kaGreen,m=c.phoneMargin,v=c.negativePhoneMargin,y=i.createClass({displayName:"Indicators",propTypes:{currentGroup:i.PropTypes.number.isRequired,numGroups:i.PropTypes.number.isRequired,onChangeCurrentGroup:i.PropTypes.func.isRequired},render:function(){for(var e=this,t=[],n=function(n){t.push(i.createElement("div",{key:n,className:a(P.indicator,n===e.props.currentGroup&&P.selectedIndicator),onClick:function(){return e.props.onChangeCurrentGroup(n)}}))},r=0;r<this.props.numGroups;r++)n(r);return i.createElement("div",{className:a(P.indicatorContainer)},t)}}),b=i.createClass({displayName:"GradedGroupSet",propTypes:{apiOptions:p.propTypes,gradedGroups:i.PropTypes.array,trackInteraction:i.PropTypes.func.isRequired},mixins:[l],getDefaultProps:function(){return{gradedGroups:[]}},getInitialState:function(){return{currentGroup:0}},shouldComponentUpdate:function(e,t){return e!==this.props||t!==this.state},getInputPaths:function(){return this._childGroup.getInputPaths()},setInputValue:function(e,t,n){return this._childGroup.setInputValue(e,t,n)},getAcceptableFormatsForInputPath:function(e){return this._childGroup.getAcceptableFormatsForInputPath(e)},focus:function(){return this._childGroup.focus()},focusInputPath:function(e){this._childGroup.focusInputPath(e)},blurInputPath:function(e){this._childGroup.blurInputPath(e)},handleNextQuestion:function(){var e=this.state.currentGroup,t=this.props.gradedGroups.length;e<t-1&&this.setState({currentGroup:e+1})},render:function(){var e=this,t=this.props.gradedGroups[this.state.currentGroup];if(!t)return i.createElement("span",null,"No current group...");var n=this.props.gradedGroups.length,o=this.state.currentGroup<n-1?this.handleNextQuestion:null;return i.createElement("div",{className:a(P.container)},i.createElement("div",{className:a(P.top)},i.createElement("div",{className:a(P.title)},t.title),i.createElement("div",{className:a(P.spacer)}),i.createElement(y,{numGroups:n,currentGroup:this.state.currentGroup,onChangeCurrentGroup:function(t){return e.setState({currentGroup:t})}})),i.createElement(u,r({key:this.state.currentGroup,ref:function(t){return e._childGroup=t}},this.props,t,{inGradedGroupSet:!0,title:null,onNextQuestion:o})))}}),T=function(e,t){return{groups:e.gradedGroups.map(t)}};e.exports={name:"graded-group-set",displayName:"Graded Group Set",widget:b,traverseChildWidgets:T,hidden:!1,tracking:"all"};var P=s.create({top:{display:"flex",flexDirection:"row"},spacer:{flex:1},title:{fontSize:12,color:d,textTransform:"uppercase",marginBottom:11,letterSpacing:.8},indicatorContainer:{display:"flex",flexDirection:"row"},indicator:{width:10,height:10,borderRadius:5,backgroundColor:h,marginLeft:5,cursor:"pointer"},selectedIndicator:{backgroundColor:g},container:{borderTop:"1px solid "+d,borderBottom:"1px solid "+d,backgroundColor:f,marginLeft:v,marginRight:v,paddingBottom:m,paddingLeft:m,paddingRight:m,paddingTop:10,width:"auto"}})},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(10),o=n(9),s=n(17).Options,a=n(80),p=n(8),l=i.createClass({displayName:"Group",mixins:[a],propTypes:{content:i.PropTypes.string,widgets:i.PropTypes.object,images:i.PropTypes.object,icon:i.PropTypes.object,reviewModeRubric:i.PropTypes.object},getDefaultProps:function(){return{content:"",widgets:{},images:{},icon:null}},componentDidMount:function(){this.forceUpdate()},render:function(){var e=this,t=o.extend({},s.defaults,this.props.apiOptions,{onFocusChange:function(t,n){n&&e.props.onBlur(n),t&&e.props.onFocus(t)}}),n=o.indexOf(this.props.interWidgets("group"),this),a=this.props.apiOptions.groupAnnotator(n,this.props.widgetId),l=function(t){e.refs.renderer&&e.change("widgets",e.refs.renderer.props.widgets)};return i.createElement("div",{className:"perseus-group"},a,i.createElement(p,r({},this.props,{ref:"renderer",apiOptions:t,interWidgets:this._interWidgets,reviewMode:!!this.props.reviewModeRubric,onInteractWithWidget:l})),this.props.icon&&i.createElement("div",{className:"group-icon"},this.props.icon))},_interWidgets:function(e,t){return t.length?t:this.props.interWidgets(e)},getUserInput:function(){return this.refs.renderer.getUserInput()},getSerializedState:function(){return this.refs.renderer.getSerializedState()},restoreSerializedState:function(e,t){return this.refs.renderer.restoreSerializedState(e,t),null},simpleValidate:function(e){return this.refs.renderer.score()},getInputPaths:function(){return this.refs.renderer.getInputPaths()},setInputValue:function(e,t,n){return this.refs.renderer.setInputValue(e,t,n)},getAcceptableFormatsForInputPath:function(e){return this.refs.renderer.getAcceptableFormatsForInputPath(e)},getRenderer:function(){return this.refs.renderer},focus:function(){return this.refs.renderer.focus()},focusInputPath:function(e){this.refs.renderer.focusPath(e)},blurInputPath:function(e){this.refs.renderer.blurPath(e)}}),u=function(e,t){return o.extend({},e,t(e))};e.exports={name:"group",displayName:"Group",widget:l,traverseChildWidgets:u,hidden:!1}},function(e,t,n){"use strict";var r=n(10),i=n(9),o=n(80),s=n(93),a=n(16).updateQueryString,p=r.createClass({displayName:"Iframe",mixins:[o,s],propTypes:{width:r.PropTypes.string,height:r.PropTypes.string,url:r.PropTypes.string,settings:r.PropTypes.array,status:r.PropTypes.oneOf(["incomplete","incorrect","correct"]),message:r.PropTypes.string,allowFullScreen:r.PropTypes.bool},getDefaultProps:function(){return{status:"incomplete",message:null,allowFullScreen:!1}},handleMessageEvent:function(e){var t={};try{t=JSON.parse(e.originalEvent.data)}catch(e){return}if(!i.isUndefined(t.testsPassed)){var n=t.testsPassed?"correct":"incorrect";this.change({status:n,message:t.message})}},componentDidMount:function(){$(window).on("message",this.handleMessageEvent)},componentWillUnmount:function(){$(window).off("message",this.handleMessageEvent)},render:function(){var e={width:this.props.width,height:this.props.height},t=this.props.url;if(t&&t.length&&0!==t.indexOf("http")&&(t="https://www.khanacademy.org/computer-programming/program/"+t+"/embedded?buttons=no&embed=yes&editor=no&author=no",t=a(t,"width",this.props.width),t=a(t,"height",this.props.height),t=a(t,"origin",window.location.origin)),"undefined"!=typeof KA&&KA.isZeroRated&&(t.match(/https?:\/\/[^\/]*khanacademy.org/)?t.match(/zero.khanacademy.org/)||(t=t.replace("khanacademy.org","zero.khanacademy.org")):t="/zero/external-link?context=iframe&url="+encodeURIComponent(t)),this.props.settings){
var n={};i.each(this.props.settings,function(e){e.name&&e.value&&(n[e.name]=e.value)}),t=a(t,"settings",JSON.stringify(n))}return r.createElement("iframe",{sandbox:"allow-same-origin allow-scripts",style:e,src:t,allowFullScreen:this.props.allowFullScreen})},simpleValidate:function(e){return p.validate(this.getUserInput(),e)}});i.extend(p,{validate:function(e,t){return"correct"===e.status?{type:"points",earned:1,total:1,message:e.message||null}:"incorrect"===e.status?{type:"points",earned:0,total:1,message:e.message||null}:{type:"invalid",message:"Keep going, you're not there yet!"}}}),e.exports={name:"iframe",displayName:"Iframe",widget:p,hidden:!0}},function(e,t,n){"use strict";var r,i=n(12),o=n(13),s=o.StyleSheet,a=o.css,p=n(10),l=n(9),u=n(17).Options,c=n(36),h=c.baseUnitPx,d=n(80),f=n(34),g=n(8),m=n(32),v=400,y=[0,10],b={url:null,width:0,height:0},T=["block","float-left","float-right","full-width"],P=["block","full-width"],x="block",C=p.createClass({displayName:"ImageWidget",propTypes:{alignment:p.PropTypes.oneOf(T),alt:p.PropTypes.string,apiOptions:u.propTypes,backgroundImage:p.PropTypes.shape({url:p.PropTypes.string,width:p.PropTypes.number,height:p.PropTypes.number}),box:p.PropTypes.arrayOf(p.PropTypes.number),caption:p.PropTypes.string,labels:p.PropTypes.arrayOf(p.PropTypes.shape({content:p.PropTypes.string,coordinates:p.PropTypes.arrayOf(p.PropTypes.number),alignment:p.PropTypes.string})),range:p.PropTypes.arrayOf(p.PropTypes.arrayOf(p.PropTypes.number)),title:p.PropTypes.string,trackInteraction:p.PropTypes.func.isRequired},statics:{styles:s.create({caption:(r={display:"inline-block",marginTop:h,maxWidth:640},r[f.lgOrSmaller]={maxWidth:540},r[f.smOrSmaller]={maxWidth:450},r)})},mixins:[d],getDefaultProps:function(){return{alignment:x,title:"",range:[y,y],box:[v,v],backgroundImage:b,labels:[],alt:"",caption:""}},render:function(){var e,t,n=this.props.apiOptions,r=this.props.backgroundImage;if(r.url&&(e=p.createElement(m,{src:r.url,alt:this.props.alt?"":void 0,width:r.width,height:r.height,preloader:n.imagePreloader,extraGraphie:{box:this.props.box,range:this.props.range,labels:this.props.labels},trackInteraction:this.props.trackInteraction,zoomToFullSizeOnMobile:n.isMobile,constrainHeight:n.isMobile,allowFullBleed:n.isMobile})),this.props.alt&&(t=p.createElement("span",{className:"perseus-sr-only"},p.createElement(g,{content:this.props.alt,apiOptions:n}))),n.isMobile){var o;if(this.props.title||this.props.caption){var s=this.props.title;s&&(this.props.caption&&!/[.?!"']\s*$/.test(s)&&(s+="."),s="**"+s+"** ");var l=i({"perseus-image-caption":!0,"has-title":!!s}),u=this.props.alignment,c="block"===u||"full-width"===u,h=c?null:"0 !important";o=p.createElement("div",{className:l},p.createElement("div",{className:a(C.styles.caption),style:{minWidth:h}},p.createElement(g,{content:s+this.props.caption,apiOptions:n})))}return p.createElement("div",{className:"perseus-image-widget"},e,t,o)}var d,f;return this.props.title&&(d=p.createElement("div",{className:"perseus-image-title"},p.createElement(g,{content:this.props.title,apiOptions:n}))),this.props.caption&&(f=p.createElement("div",{className:"perseus-image-caption"},p.createElement(g,{content:this.props.caption,apiOptions:n}))),p.createElement("div",{className:"perseus-image-widget"},d,e,t,f)},getUserInput:function(){return null},simpleValidate:function(e){return C.validate(this.getUserInput(),e)},focus:$.noop});l.extend(C,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),e.exports={name:"image",accessible:function(e){var t=e.backgroundImage;return!(t&&t.url&&!e.alt)},defaultAlignment:x,supportedAlignments:P,displayName:"Image",widget:C}},function(e,t,n){"use strict";var r=n(10),i=n(9),o=n(80),s=n(86),a=s.Label,p=s.Line,l=s.MovablePoint,u=s.MovableLine,c=s.Plot,h=s.PlotParametric,d=s.Point,f=s.Rect,g=n(123).vector,m=function(e,t){t=t||{};for(var n=e+"||"+t.decimal_separatpr+"||",r=t.functions,i=r?r.length:0,o=0;o<i;o++)n+=r[o]+"|";return n},v=Object.create(null),y=function(e,t){var n=m(e,t),r=v[n];return r?r:(r=KAS.parse(e,t),v[n]=r,r)},b=Object.create(null),T=function(e,t){var n=m(e,t),r=b[n];if(r)return r;var i=KAS.parse(e,t).expr;return r=i?i.compile():function(){return 0},b[n]=r,r},P={graph:{box:[400,400],labels:["x","y"],range:[[-10,10],[-10,10]],tickStep:[1,1],gridStep:[1,1],markings:"graph"},elements:[]},x=r.createClass({displayName:"Interaction",mixins:[o],propTypes:{graph:r.PropTypes.object,elements:r.PropTypes.arrayOf(r.PropTypes.object)},getDefaultProps:function(){return P},getInitialState:function(){return{variables:this._getInitialVariables(this.props.elements),functions:this._getInitialFunctions(this.props.elements)}},_getInitialVariables:function(e){var t={};return i.each(i.where(e,{type:"movable-point"}),function(e){var n=e.options.varSubscript,r=y(e.options.startX||"0").expr,i=y(e.options.startY||"0").expr,o=0,s=0;r&&(o=r.eval({})||0),i&&(s=i.eval({})||0),t["x_"+n]=o,t["y_"+n]=s},this),i.each(i.where(e,{type:"movable-line"}),function(e){var n=e.options.startSubscript,r=e.options.endSubscript,i=y(e.options.startX||"0").expr,o=y(e.options.startY||"0").expr,s=y(e.options.endX||"0").expr,a=y(e.options.endY||"0").expr,p=0,l=0,u=0,c=0;i&&(p=i.eval({})||0),o&&(l=o.eval({})||0),s&&(u=s.eval({})||0),a&&(c=a.eval({})||0),t["x_"+n]=p,t["y_"+n]=l,t["x_"+r]=u,t["y_"+r]=c},this),i.each(i.where(e,{type:"function"}),function(e){t[e.options.funcName]=e.options.value}),t},_getInitialFunctions:function(e){return i.map(i.where(e,{type:"function"}),function(e){return e.options.funcName})},componentWillReceiveProps:function(e){this.setState({variables:this._getInitialVariables(e.elements),functions:this._getInitialFunctions(e.elements)})},_setupGraphie:function(e,t){if(e.graphInit(i.extend({},t,{grid:i.contains(["graph","grid"],this.props.graph.markings),axes:i.contains(["graph"],this.props.graph.markings),ticks:i.contains(["graph"],this.props.graph.markings),labels:i.contains(["graph"],this.props.graph.markings),labelFormat:function(e){return"\\small{"+e+"}"},axisArrows:"<->",unityLabels:!1})),"graph"===this.props.graph.markings){var n=this.props.graph.labels,r=this.props.graph.range;e.label([0,r[1][1]],n[1],"above"),e.label([r[0][1],0],n[0],"right")}},_updatePointLocation:function(e,t){var n=i.clone(this.state.variables);n["x_"+e]=t[0],n["y_"+e]=t[1],this.setState({variables:n}),this.props.trackInteraction()},_updateLineLocation:function(e,t){var n=this._eval("("+e.endX+")-("+e.startX+")"),r=this._eval("("+e.endY+")-("+e.startY+")"),o=g.add(t,[n,r]),s=i.clone(this.state.variables);s["x_"+e.startSubscript]=t[0],s["y_"+e.startSubscript]=t[1],s["x_"+e.endSubscript]=o[0],s["y_"+e.endSubscript]=o[1],this.setState({variables:s}),this.props.trackInteraction()},_eval:function(e,t){var n=this,r=T(e,{functions:this.state.functions}),o=i.extend({},this.state.variables,t);return i.each(i.keys(o),function(e){if(i.isString(o[e])){var t=T(o[e],{functions:n.state.functions});o[e]=function(e){return t(i.extend({},o,{x:e}))}}}),r(o)||0},_extractVars:function(e){if(null==e)return[];var t=[];return i.each(e.args(),function(e){e&&"Expr"===e.constructor.name&&(t=t.concat(this._extractVars(e)))},this),"Var"===e.name()&&t.push(e.prettyPrint()),t},render:function(){return r.createElement(s,{box:this.props.graph.box,range:this.props.graph.range,options:this.props.graph,setup:this._setupGraphie,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable},i.map(this.props.elements,function(e,t){var n=this;if("point"===e.type)return r.createElement(d,{key:e.key,coord:[this._eval(e.options.coordX),this._eval(e.options.coordY)],color:e.options.color});if("line"===e.type){var o=[this._eval(e.options.startX),this._eval(e.options.startY)],s=[this._eval(e.options.endX),this._eval(e.options.endY)];return r.createElement(p,{key:e.key,start:o,end:s,style:{stroke:e.options.color,strokeWidth:e.options.strokeWidth,strokeDasharray:e.options.strokeDasharray,arrows:e.options.arrows}})}if("movable-point"===e.type){var g=[function(t){var r=Math.max(n._eval(e.options.constraintXMin),Math.min(n._eval(e.options.constraintXMax),t[0])),i=Math.max(n._eval(e.options.constraintYMin),Math.min(n._eval(e.options.constraintYMax),t[1]));return[r,i]}];return"snap"===e.options.constraint?g.push(l.constraints.snap(e.options.snap)):"x"===e.options.constraint?g.push(function(t){return[n._eval(e.options.constraintFn,{y:t[1]}),t[1]]}):"y"===e.options.constraint&&g.push(function(t){return[t[0],n._eval(e.options.constraintFn,{x:t[0]})]}),r.createElement(l,{key:e.key,coord:[this.state.variables["x_"+e.options.varSubscript],this.state.variables["y_"+e.options.varSubscript]],constraints:g,foo_x:e.options.constraint,foo_y:e.options.constraintFn,foo_z:e.options.snap,onMove:i.partial(this._updatePointLocation,e.options.varSubscript)})}if("movable-line"===e.type){var g=[function(t){var r=Math.max(n._eval(e.options.constraintXMin),Math.min(n._eval(e.options.constraintXMax),t[0])),i=Math.max(n._eval(e.options.constraintYMin),Math.min(n._eval(e.options.constraintYMax),t[1]));return[r,i]}];"snap"===e.options.constraint?g.push(l.constraints.snap(e.options.snap)):"x"===e.options.constraint?g.push(function(t){return[n._eval(e.options.constraintFn,{y:t[1]}),t[1]]}):"y"===e.options.constraint&&g.push(function(t){return[t[0],n._eval(e.options.constraintFn,{x:t[0]})]});var o=[this.state.variables["x_"+e.options.startSubscript],this.state.variables["y_"+e.options.startSubscript]],s=[this.state.variables["x_"+e.options.endSubscript],this.state.variables["y_"+e.options.endSubscript]];return r.createElement(u,{key:e.key,constraints:g,onMove:i.bind(this._updateLineLocation,this,e.options),foo_x:e.options.constraint,foo_y:e.options.constraintFn,foo_z:e.options.snap},r.createElement(l,{coord:o,static:!0,normalStyle:{stroke:"none",fill:"none"}}),r.createElement(l,{coord:s,static:!0,normalStyle:{stroke:"none",fill:"none"}}))}if("function"===e.type){var m=function(t){return n._eval(e.options.value,{x:t})},v=i.without(this._extractVars(y(e.options.value).expr),"x"),b=i.object(v,i.map(v,function(e){return n.state.variables[e]})),T=[this._eval(e.options.rangeMin,this.state.variables),this._eval(e.options.rangeMax,this.state.variables)];return r.createElement(c,{key:e.key,fn:m,foo_fn:e.options.value,foo_varvalues:b,range:T,style:{stroke:e.options.color,strokeWidth:e.options.strokeWidth,strokeDasharray:e.options.strokeDasharray,plotPoints:100}})}if("parametric"===e.type){var m=function(t){return[n._eval(e.options.x,{t:t}),n._eval(e.options.y,{t:t})]},v=i.without(this._extractVars(y(e.options.x).expr).concat(this._extractVars(y(e.options.y).expr)),"t"),b=i.object(v,i.map(v,function(e){return n.state.variables[e]})),T=[this._eval(e.options.rangeMin,this.state.variables),this._eval(e.options.rangeMax,this.state.variables)];return r.createElement(h,{key:e.key,fn:m,foo_fnx:e.options.x,foo_fny:e.options.y,foo_varvalues:b,range:T,style:{stroke:e.options.color,strokeWidth:e.options.strokeWidth,strokeDasharray:e.options.strokeDasharray,plotPoints:100}})}if("label"===e.type){var P=[this._eval(e.options.coordX),this._eval(e.options.coordY)];return r.createElement(a,{key:t+1,coord:P,text:e.options.label,style:{color:e.options.color}})}return"rectangle"===e.type?r.createElement(f,{key:t+1,x:this._eval(e.options.coordX),y:this._eval(e.options.coordY),width:i.max([this._eval(e.options.width),0]),height:i.max([this._eval(e.options.height),0]),style:{stroke:"none",fill:e.options.color}}):void 0},this))},getUserInput:function(){return{}},simpleValidate:function(e){return x.validate(this.getUserInput(),e)}});i.extend(x,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),e.exports={name:"interaction",displayName:"Interaction",widget:x,transform:i.identity}},function(e,t,n){"use strict";function r(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1])}function i(e,t,n){return z(r(e,t,n),0)}function o(e){return z(e,0)?0:e>0?1:-1}function s(e,t){return null==e?t:e}function a(e,t,n){return n[0]<=Math.max(e[0],t[0])&&n[0]>=Math.min(e[0],t[0])&&n[1]<=Math.max(e[1],t[1])&&n[1]>=Math.min(e[1],t[1])}function p(e,t){var n=[[e[0],e[1],t[0]],[e[0],e[1],t[1]],[t[0],t[1],e[0]],[t[0],t[1],e[1]]],i=k.map(n,function(e){return o(r.apply(null,e))});if(i[0]!==i[1]&&i[2]!==i[3])return!0;for(var s=0;s<4;s++)if(0===i[s]&&a.apply(null,n[s]))return!0;return!1}function l(e,t){return k.map(k.zip(e,t),function(e){return e[0]-e[1]})}function u(e){return Math.sqrt(k.reduce(e,function(e,t){return e+Math.pow(t,2)},0))}function c(e,t){return k.reduce(k.zip(e,t),function(e,t){return e+t[0]*t[1]},0)}function h(e){var t=k.zip(e,y(e));return k.map(t,function(e){return u(l.apply(null,e))})}function d(e){var t=k.zip(y(e,-1),e,y(e,1)),n=k.map(t,function(e){var t=l(e[1],e[0]),n=l(e[2],e[1]),i=Math.acos(c(t,n)/(u(t)*u(n)));return o(r.apply(null,e))>0?i:-i}),i=k.reduce(n,function(e,t){return e+t},0);return k.map(n,function(e){return i>0?Math.PI-e:Math.PI+e})}function f(e,t,n){if(e.length!==t.length)return!1;for(var r=e.length,i=d(e),o=d(t),s=h(e),a=h(t),p=0;p<2*r;p++){var l=o.slice(),u=a.slice();if(p>=r&&(l.reverse(),u.reverse(),u=y(u,1)),l=y(l,p),u=y(u,p),V(i,l)){var c=k.zip(s,u),f=k.map(c,function(e){return e[0]/e[1]}),g=k.all(f,function(e){return z(f[0],e)}),m=k.all(c,function(e){return R.equal(e[0],e[1],n)});if(g&&m)return!0}}return!1}function g(e,t){return e<t||z(e,t)}function m(e,t,n){return 180*Math.acos((e*e+t*t-n*n)/(2*e*t))/Math.PI}function v(e){var t=e[0],n=e[1],r=e[2],i=e[3];t<0&&(t*=-1,n*=-1,r*=-1);var o=2*Math.PI;for(n<0&&(n*=-1,r*=-1,r+=o/2);r>0;)r-=o;for(;r<0;)r+=o;return[t,n,r,i]}function y(e,t){return t="undefined"==typeof t?1:t%e.length,e.slice(t).concat(e.slice(0,t))}function b(e){return e.replace(/(?:^|-)(.)/g,function(e,t){return t.toUpperCase()})}function T(e,t){if(z(e[0],t[0]))return"x = "+e[0].toFixed(3);var n=(t[1]-e[1])/(t[0]-e[0]),r=e[1]-n*e[0];return"y = "+n.toFixed(3)+"x + "+r.toFixed(3)}function P(e,t){var n=e[0][0],r=e[0][1],i=e[1][0],o=e[1][1],s=t[0][0],a=t[0][1],p=t[1][0],l=t[1][1],u=(n-i)*(a-l)-(r-o)*(s-p);if(Math.abs(u)<1e-9)return"Lines are parallel";var c=((n*o-r*i)*(s-p)-(n-i)*(s*l-a*p))/u,h=((n*o-r*i)*(a-l)-(r-o)*(s*l-a*p))/u;return"Intersection: ("+c.toFixed(3)+", "+h.toFixed(3)+")"}function x(e,t){return Math.floor((e[1]-e[0])/t)}var C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},E=n(10),k=n(9),M=n(99),w=n(100),S=n(94),I=n(101),N=n(16),R=n(123).number,O=n(123).point,A=n(97),_=n(102),D=n(36),F=(D.interactiveSizes,n(72)),L=F.containerSizeClassPropType,G=F.getInteractiveBoxFromSizeClass,U=n(96),q=N.DeprecationMixin,B="https://ka-perseus-graphie.s3.amazonaws.com/b1452c0d79fd0f7ff4c3af9488474a0a0decb361.png",H={url:null},z=N.eq,V=N.deepEq,W="unlimited",Y={showGraph:function(e){return{markings:e.showGraph?"graph":"none"}}},j=E.createClass({displayName:"InteractiveGraph",propTypes:{containerSizeClass:L.isRequired,trackInteraction:E.PropTypes.func.isRequired},getInitialState:function(){return{shouldShowInstructions:this._getShouldShowInstructions()}},getDefaultProps:function(){return{labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],backgroundImage:H,markings:"graph",showTooltips:!1,showProtractor:!1,showRuler:!1,rulerLabel:"",rulerTicks:10,graph:{type:"linear"}}},mixins:[q],deprecatedProps:Y,_getShouldShowInstructions:function(e){return e=e||this.props,this.isClickToAddPoints(e)&&(null==e.graph.coords||0===e.graph.coords.length)},componentDidUpdate:function(e,t){var n=e.graph.type,r=this.props.graph.type;n===r&&e.graph.allowReflexAngles===this.props.graph.allowReflexAngles&&e.graph.angleOffsetDeg===this.props.graph.angleOffsetDeg&&e.graph.numPoints===this.props.graph.numPoints&&e.graph.numSides===this.props.graph.numSides&&e.graph.numSegments===this.props.graph.numSegments&&e.graph.showAngles===this.props.graph.showAngles&&e.graph.showSides===this.props.graph.showSides&&e.graph.snapTo===this.props.graph.snapTo&&e.graph.snapDegrees===this.props.graph.snapDegrees||(this["remove"+b(n)+"Controls"](),this["add"+b(r)+"Controls"]()),this.shouldResetGraphie&&this.resetGraphie()},render:function(){var e,t,n=this;if(this.props.flexibleType)if(e=E.createElement("select",{value:this.props.graph.type,onChange:function(e){var t=e.target.value;n.onChange({graph:{type:t}})}},E.createElement("option",{value:"linear"},"Linear function"),E.createElement("option",{value:"quadratic"},"Quadratic function"),E.createElement("option",{value:"sinusoid"},"Sinusoid function"),E.createElement("option",{value:"circle"},"Circle"),E.createElement("option",{value:"point"},"Point(s)"),E.createElement("option",{value:"linear-system"},"Linear System"),E.createElement("option",{value:"polygon"},"Polygon"),E.createElement("option",{value:"segment"},"Line Segment(s)"),E.createElement("option",{value:"ray"},"Ray"),E.createElement("option",{value:"angle"},"Angle")),"point"===this.props.graph.type)t=E.createElement("select",{key:"point-select",value:this.props.graph.numPoints||1,onChange:function(e){var t=+e.target.value||e.target.value;n.onChange({graph:{type:"point",numPoints:t,coords:null}})}},k.map(k.range(1,7),function(e){return E.createElement("option",{value:e},e," point",e>1&&"s")}),E.createElement("option",{value:W},"unlimited"));else if("polygon"===this.props.graph.type)t=E.createElement("div",null,E.createElement("div",null,E.createElement("select",{key:"polygon-select",value:this.props.graph.numSides||3,onChange:function(e){var t=+e.target.value||e.target.value,r=k.extend({},n.props.graph,{numSides:t,coords:null,snapTo:"grid"});n.onChange({graph:r})}},k.map(k.range(3,13),function(e){return E.createElement("option",{value:e},e," sides")}),E.createElement("option",{value:W},"unlimited sides"))),E.createElement("div",null,E.createElement("label",null," Snap to"," ",E.createElement("select",{key:"polygon-snap",value:this.props.graph.snapTo,onChange:function(e){var t=k.extend({},n.props.graph,{snapTo:e.target.value,coords:null});n.onChange({graph:t})}},E.createElement("option",{value:"grid"},"grid"),this.props.graph.numSides!==W&&[E.createElement("option",{value:"angles"}," ","interior angles"," "),E.createElement("option",{value:"sides"}," ","side measures"," ")])),E.createElement(w,null,E.createElement("p",null,"These options affect the movement of the vertex points. The grid option will guide the points to the nearest half step along the grid."),E.createElement("p",null,"The interior angle and side measure options guide the points to the nearest whole angle or side")," measure respectively."," ")),E.createElement("div",null,E.createElement("label",null,"Show angle measures:"," ",E.createElement("input",{type:"checkbox",checked:this.props.graph.showAngles,onChange:this.toggleShowAngles})),E.createElement(w,null,E.createElement("p",null,"Displays the interior angle measures."))),E.createElement("div",null,E.createElement("label",null,"Show side measures:"," ",E.createElement("input",{type:"checkbox",checked:this.props.graph.showSides,onChange:this.toggleShowSides})),E.createElement(w,null,E.createElement("p",null,"Displays the side lengths."))));else if("segment"===this.props.graph.type)t=E.createElement("select",{key:"segment-select",value:this.props.graph.numSegments||1,onChange:function(e){var t=+e.target.value;n.onChange({graph:{type:"segment",numSegments:t,coords:null}})}},k.map(k.range(1,7),function(e){return E.createElement("option",{value:e},e," segment",e>1&&"s")}));else if("angle"===this.props.graph.type){var r=s(this.props.graph.allowReflexAngles,!0);t=E.createElement("div",null,E.createElement("div",null,E.createElement("label",null,"Show angle measure:"," ",E.createElement("input",{type:"checkbox",checked:this.props.graph.showAngles,onChange:this.toggleShowAngles}))),E.createElement("div",null,E.createElement("label",null,"Allow reflex angles:"," ",E.createElement("input",{type:"checkbox",checked:r,onChange:function(e){n.onChange({graph:k.extend({},n.props.graph,{allowReflexAngles:!r,coords:null})})}})),E.createElement(w,null,E.createElement("p",null,"Reflex angles are angles with a measure greater than 180 degrees."),E.createElement("p",null,"By default, these should remain enabled."))),E.createElement("div",null,E.createElement("label",null,"Snap to increments of"," ",E.createElement(I,{key:"degree-snap",placeholder:1,value:this.props.graph.snapDegrees,onChange:function(e){n.onChange({graph:k.extend({},n.props.graph,{snapDegrees:Math.abs(e),coords:null})})}})," ","degrees"," ")),E.createElement("div",null,E.createElement("label",null," ","With an offset of"," ",E.createElement(I,{key:"angle-offset",placeholder:0,value:this.props.graph.angleOffsetDeg,onChange:function(e){n.onChange({graph:k.extend({},n.props.graph,{angleOffsetDeg:e,coords:null})})}})," ","degrees"," ")))}var i,o=G(this.props.containerSizeClass);this.isClickToAddPoints()&&this.state.shouldShowInstructions?"point"===this.props.graph.type?i=i18n._("Click to add points"):"polygon"===this.props.graph.type&&(i=i18n._("Click to add vertices")):i=void 0;var a=this.isClickToAddPoints()?this.handleAddPointsMouseDown:null,p=this.props.gridStep||N.getGridStep(this.props.range,this.props.step,o[0]),l=this.props.snapStep||N.snapStepFromGridStep(p),u=this.props.apiOptions.isMobile;return E.createElement("div",{className:"perseus-widget perseus-widget-interactive-graph",style:{width:o[0],height:this.props.flexibleType?"auto":o[1]}},E.createElement(M,{instructions:i,ref:"graph",box:o,labels:this.props.labels,range:this.props.range,step:u?N.constrainedTickStepsFromTickSteps(this.props.step,this.props.range):this.props.step,gridStep:p,snapStep:l,markings:this.props.markings,backgroundImage:this.props.backgroundImage,showProtractor:this.props.showProtractor,showRuler:this.props.showRuler,rulerLabel:this.props.rulerLabel,rulerTicks:this.props.rulerTicks,onMouseDown:a,onGraphieUpdated:this.setGraphie,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable,isMobile:u}),e,t)},componentDidMount:function(){this.setGraphie(this.refs.graph.graphie())},setGraphie:function(e){this.graphie=e,this.setupGraphie()},handleAddPointsMouseDown:function(e){if(!this.isClickToAddPoints())throw new Error("handleAddPointsClick should not be registeredwhen isClickToAddPoints() is false");if(!this.isCoordInTrash(e)){var t;if("point"===this.props.graph.type){if(t=this.createPointForPointsType(e,this.points.length),!t.constrain())return void t.remove();this.points.push(t);var n=this.points.length-1;this.points[n].grab(e),this.updateCoordsFromPoints()}else if("polygon"===this.props.graph.type){if(this.polygon.closed())return;t=this.createPointForPolygonType(e,this.points.length),this.points.push(t);var n=this.points.length-1;this.points[n].grab(e),this.updatePolygon()}this.setState({shouldShowInstructions:!1})}},resetGraphie:function(){this.shouldResetGraphie=!1,this.parabola=null,this.sinusoid=null,this.refs.graph.reset()},setupGraphie:function(){this.setTrashCanVisibility(0),this.isClickToAddPoints()&&this.setTrashCanVisibility(.5),this.props.apiOptions.isMobile&&(this.horizHairline=new U(this.graphie,[0,0],[0,0],{normalStyle:{strokeWidth:1}}),this.horizHairline.attr({stroke:A.INTERACTIVE}),this.horizHairline.hide(),this.vertHairline=new U(this.graphie,[0,0],[0,0],{normalStyle:{strokeWidth:1}}),this.vertHairline.attr({stroke:A.INTERACTIVE}),this.vertHairline.hide());var e=this.props.graph.type;this["add"+b(e)+"Controls"]()},showHairlines:function(e){this.props.apiOptions.isMobile&&"none"!==this.props.markings&&(this.horizHairline.moveTo([this.props.range[0][0],e[1]],[this.props.range[0][1],e[1]]),this.horizHairline.show(),this.vertHairline.moveTo([e[0],this.props.range[1][0]],[e[0],this.props.range[1][1]]),this.vertHairline.show())},hideHairlines:function(){this.props.apiOptions.isMobile&&(this.horizHairline.hide(),this.vertHairline.hide())},setTrashCanVisibility:function(e){var t=this.graphie;R.equal(e,0)?this.trashCan&&(this.trashCan.remove(),this.trashCan=null):this.props.apiOptions.isMobile||(this.trashCan||(this.trashCan=t.raphael.image(B,t.xpixels-40,t.ypixels-40,40,40)),this.trashCan.attr({opacity:e}))},componentWillReceiveProps:function(e){this.isClickToAddPoints()!==this.isClickToAddPoints(e)&&(this.shouldResetGraphie=!0,this.setState({shouldShowInstructions:this._getShouldShowInstructions(e)})),this.props.containerSizeClass!==e.containerSizeClass&&(this.shouldResetGraphie=!0)},isClickToAddPoints:function(e){return e=e||this.props,"point"===e.graph.type&&e.graph.numPoints===W||"polygon"===e.graph.type&&e.graph.numSides===W},_lineStroke:function(){return this.props.isMobile?{"stroke-width":3}:{}},addLine:function(e){var t=this,n=this,r=n.graphie,i=j.getLineCoords(n.props.graph,n.props),o=n.points=k.map(i,function(e){return S.addMaybeMobileMovablePoint(t,{coord:e,constraints:[S.MovablePoint.constraints.bound(),S.MovablePoint.constraints.snap()],onMove:function(){var e=k.extend({},n.props.graph,{coords:k.invoke(o,"coord")});n.onChange({graph:e})}})}),s={points:o,static:!0,normalStyle:C({stroke:this.props.apiOptions.isMobile?A.BLUE_C:A.INTERACTIVE},this._lineStroke())};"line"===e?s.extendLine=!0:"ray"===e&&(s.extendRay=!0);n.line=S.addMovableLine(r,s);o[0].listen("constraints","isLine",function(e){return!O.equal(e,o[1].coord())}),o[1].listen("constraints","isLine",function(e){return!O.equal(e,o[0].coord())})},removeLine:function(){k.invoke(this.points,"remove"),this.line.remove()},addLinearControls:function(){this.addLine("line")},removeLinearControls:function(){this.removeLine()},addQuadraticControls:function(){var e=this,t=(this.graphie,this.props.graph.coords);t||(t=j.defaultQuadraticCoords(this.props));var n,r,i,o=function(){var t=k.extend({},e.props.graph,{coords:[n.coord(),r.coord(),i.coord()]});e.onChange({graph:t}),e.updateQuadratic()};n=this.pointA=S.addMaybeMobileMovablePoint(this,{coord:t[0],constraints:[S.MovablePoint.constraints.bound(),S.MovablePoint.constraints.snap(),function(e){return!n||e[0]!==r.coord()[0]&&e[0]!==i.coord()[0]}],onMove:o}),r=this.pointB=S.addMaybeMobileMovablePoint(this,{coord:t[1],constraints:[S.MovablePoint.constraints.bound(),S.MovablePoint.constraints.snap(),function(e){return!r||e[0]!==n.coord()[0]&&e[0]!==i.coord()[0]}],onMove:o}),i=this.pointC=S.addMaybeMobileMovablePoint(this,{coord:t[2],constraints:[S.MovablePoint.constraints.bound(),S.MovablePoint.constraints.snap(),function(e){return!i||e[0]!==n.coord()[0]&&e[0]!==r.coord()[0]}],onMove:o}),this.updateQuadratic()},updateQuadratic:function(){var e=j.getCurrentQuadraticCoefficients(this.props);if(e){var t=e[0],n=e[1],r=e[2];if(this.parabola){var i=this.graphie.svgParabolaPath(t,n,r);this.parabola.attr({path:i})}else this.parabola=this.graphie.parabola(t,n,r),this.parabola.attr(C({stroke:this.props.apiOptions.isMobile?A.BLUE_C:A.DYNAMIC},this._lineStroke())),this.parabola.toBack()}},removeQuadraticControls:function(){this.pointA.remove(),this.pointB.remove(),this.pointC.remove(),this.parabola&&(this.parabola.remove(),this.parabola=null)},addSinusoidControls:function(){var e=this,t=(this.graphie,this.props.graph.coords);t||(t=j.defaultSinusoidCoords(this.props));var n,r,i=function(){var t=k.extend({},e.props.graph,{coords:[n.coord(),r.coord()]});e.onChange({graph:t}),e.updateSinusoid()};n=this.pointA=S.addMaybeMobileMovablePoint(this,{coord:t[0],constraints:[S.MovablePoint.constraints.bound(),S.MovablePoint.constraints.snap(),function(e){return!n||e[0]!==r.coord()[0]}],onMove:i}),r=this.pointB=S.addMaybeMobileMovablePoint(this,{coord:t[1],constraints:[S.MovablePoint.constraints.bound(),S.MovablePoint.constraints.snap(),function(e){return!n||e[0]!==n.coord()[0]}],onMove:i}),this.updateSinusoid()},updateSinusoid:function(){var e=j.getCurrentSinusoidCoefficients(this.props);if(e){var t=e[0],n=e[1],r=e[2],i=e[3];if(this.sinusoid){var o=this.graphie.svgSinusoidPath(t,n,r,i);this.sinusoid.attr({path:o})}else this.sinusoid=this.graphie.sinusoid(t,n,r,i),this.sinusoid.attr(C({stroke:this.props.apiOptions.isMobile?A.BLUE_C:A.DYNAMIC},this._lineStroke())),this.sinusoid.toBack()}},removeSinusoidControls:function(){this.pointA.remove(),this.pointB.remove(),this.sinusoid&&(this.sinusoid.remove(),this.sinusoid=null)},addCircleControls:function(){var e=this,t=this.graphie,n=k.min(t.snap),r=this.circle=t.addCircleGraph({center:this.props.graph.center||[0,0],radius:this.props.graph.radius||k.min(this.props.step),snapX:t.snap[0],snapY:t.snap[1],minRadius:2*n,snapRadius:n});$(r).on("move",function(){var t=k.extend({},e.props.graph,{center:r.center,radius:r.radius});e.onChange({graph:t})})},removeCircleControls:function(){this.circle.remove()},addLinearSystemControls:function(){var e=this,t=this.graphie,n=j.getLinearSystemCoords(this.props.graph,this.props),r=[A.INTERACTIVE,A.GREEN],i=this.points=k.map(n,function(t,n){var i=k.map(t,function(t,o){return S.addMaybeMobileMovablePoint(e,{coord:t,constraints:[S.MovablePoint.constraints.bound(),S.MovablePoint.constraints.snap(),function(e){if(i)return!O.equal(e,i[1-o].coord())}],onMove:function(){var t=k.extend({},e.props.graph,{coords:k.map(e.points,function(e){return k.invoke(e,"coord")})});e.onChange({graph:t})},normalStyle:{fill:r[n]},highlightStyle:{fill:r[n]}})});return i});this.lines=k.map(i,function(e,n){return S.addMovableLine(t,{points:e,static:!0,extendLine:!0,normalStyle:{stroke:r[n]}})})},removeLinearSystemControls:function(){k.invoke(this.lines,"remove"),k.map(this.points,function(e){return k.invoke(e,"remove")})},isCoordInTrash:function(e){if(this.props.apiOptions.isMobile)return!1;var t=this.graphie,n=t.scalePoint(e);return n[0]>=t.xpixels-40&&n[1]>=t.ypixels-40},createPointForPointsType:function(e,t){var n=this,r=(n.graphie,function(){n.points=k.filter(n.points,function(e){return e!==i}),n.updateCoordsFromPoints(),setTimeout(i.remove.bind(i),0)}),i=S.addMaybeMobileMovablePoint(this,C({coord:e,constraints:[S.MovablePoint.constraints.bound(),S.MovablePoint.constraints.snap(),function(e){return k.all(n.points,function(t){return i===t||!O.equal(e,t.coord())})}],onMoveStart:function(){n.isClickToAddPoints()&&n.setTrashCanVisibility(1)},onMove:n.updateCoordsFromPoints,onMoveEnd:function(e){n.isClickToAddPoints()&&(n.isCoordInTrash(e)&&r(),n.setTrashCanVisibility(.5))}},this.props.apiOptions.isMobile&&n.isClickToAddPoints()?{onRemove:r}:{}));return i},removePoint:function(e){var t=null;return this.points=k.filter(this.points,function(n,r){return n!==e||(t=r,!1)}),t},createPointForPolygonType:function(e,t){var n=this,s=(this.graphie,!k.contains(["angles","sides"],this.props.graph.snapTo)),a=function(e){return(t+e+n.points.length)%n.points.length},c=function(){var e=n.removePoint(v);n.polygon.closed()&&(n.points=y(n.points,e),n.polygon.update({closed:!1})),n.updatePolygon(),n.clearCoords(),setTimeout(v.remove.bind(v),0)},h=function(e){if(n.isClickToAddPoints()){if(n.isCoordInTrash(e))c();else if(n.points.length>1&&(v===n.points[0]&&O.equal(e,k.last(n.points).coord())||v===k.last(n.points)&&O.equal(e,n.points[0].coord()))){var t=n.points.pop();n.points.length>2?(n.polygon.update({closed:!0}),n.updateCoordsFromPoints()):(n.polygon.update({closed:!1}),n.clearCoords()),n.updatePolygon(),setTimeout(t.remove.bind(t),0)}else{var r=k.any(n.points,function(t){return t!==v&&O.equal(t.coord(),e)});r?(n.removePoint(v),n.points.length<3?(n.polygon.update({closed:!1}),n.clearCoords()):n.polygon.closed()&&n.updateCoordsFromPoints(),n.updatePolygon(),setTimeout(v.remove.bind(v),0)):v!==n.points[0]&&v!==k.last(n.points)||v.hasMoved()||v.state.isInitialMove||n.polygon.closed()||!(n.points.length>2)||(n.polygon.update({closed:!0}),n.updatePolygon(),n.updateCoordsFromPoints())}n.setTrashCanVisibility(.5)}v.state.isInitialMove=!1},f=function(e){if(null==n.points||0===n.points.length)return!0;var s=k.invoke(n.points,"coord");if(s[t]=e,!n.isClickToAddPoints()){if(i(s[a(-2)],s[a(-1)],s[t])||i(s[a(-1)],s[t],s[a(1)])||i(s[t],s[a(1)],s[a(2)]))return!1;
var c=k.zip(s,y(s));if(n.points.length>3)for(var h=-1;h<=0;h++)for(var f=c[a(h)],v=k.without(c,f,c[a(h-1)],c[a(h+1)]),b=0;b<v.length;b++){var T=v[b];if(p(f,T))return!1}}if("angles"===n.props.graph.snapTo&&n.points.length>2){var P=k.map(d(s),function(e){return 180*e/Math.PI});k.each([-1,1],function(e){P[a(e)]=Math.round(P[a(e)])});var x=function(e,t,n){var r=_.findAngle(s[a(e)],s[a(n)],s[a(t)]);return(r+360)%360},C=[P[a(-1)]-x(-2,-1,1),P[a(1)]-x(-1,1,2)];if(C[2]=180-(C[0]+C[1]),k.any(C,function(e){return g(e,1)}))return!1;var E=u(l(s[a(-1)],s[a(1)])),M=1===o(r(s[a(-1)],s[a(1)],s[t])),w=Math.sin(C[1]*Math.PI/180)/Math.sin(C[2]*Math.PI/180)*E,S=_.findAngle(s[a(1)],s[a(-1)]),I=n.graphie.polar(w,S+(M?1:-1)*C[0]);return n.graphie.addPoints(s[a(-1)],I)}if("sides"===n.props.graph.snapTo&&n.points.length>1){var N=k.map([[s[a(-1)],s[t]],[s[t],s[a(1)]],[s[a(-1)],s[a(1)]]],function(e){return u(l.apply(null,e))});if(k.each([0,1],function(e){N[e]=Math.round(N[e])}),g(N[1]+N[2],N[0])||g(N[0]+N[2],N[1])||g(N[0]+N[1],N[2]))return!1;var R=m(N[0],N[2],N[1]),S=_.findAngle(s[a(1)],s[a(-1)]),M=1===o(r(s[a(-1)],s[a(1)],s[t])),I=n.graphie.polar(N[0],S+(M?1:-1)*R);return n.graphie.addPoints(s[a(-1)],I)}return!0},v=S.addMaybeMobileMovablePoint(this,C({coord:e,constraints:[S.MovablePoint.constraints.bound(),s?S.MovablePoint.constraints.snap():null,f],onMoveStart:function(){n.isClickToAddPoints()&&n.setTrashCanVisibility(1)},onMove:function(){n.polygon.closed()&&n.updateCoordsFromPoints()},onMoveEnd:h},this.props.apiOptions.isMobile&&this.isClickToAddPoints()?{onRemove:c}:{}));return v.state.isInitialMove=!0,v},updateCoordsFromPoints:function(){var e=k.extend({},this.props.graph,{coords:k.map(this.points,function(e){return k.result(e,"coord")})});this.onChange({graph:e})},clearCoords:function(){var e=k.extend({},this.props.graph,{coords:null});this.onChange({graph:e})},onChange:function(e){this.props.onChange(e),this.props.trackInteraction()},addPointControls:function(){var e=j.getPointCoords(this.props.graph,this.props);this.points=[],this.points=k.map(e,this.createPointForPointsType,this)},removePointControls:function(){k.invoke(this.points,"remove")},addSegmentControls:function(){var e=this,t=this,n=this.graphie,r=j.getSegmentCoords(this.props.graph,this.props),i=function(t){return S.addMaybeMobileMovablePoint(e,t)};this.points=[],this.lines=k.map(r,function(e,r){var o=function(){var e=k.extend({},t.props.graph,{coords:k.invoke(t.lines,"coords")});t.onChange({graph:e})},s=k.map(e,function(e,t){return i({coord:e,constraints:[S.MovablePoint.constraints.bound(),S.MovablePoint.constraints.snap(),function(e){if(s)return!O.equal(e,s[1-t].coord())}],onMove:o})});t.points=t.points.concat(s);var a=S.addMovableLine(n,{points:s,static:!1,constraints:[S.MovableLine.constraints.bound(),S.MovableLine.constraints.snap()],onMove:[S.MovableLine.onMove.updatePoints,o],normalStyle:C({stroke:this.props.apiOptions.isMobile?A.BLUE_C:A.INTERACTIVE},this._lineStroke()),highlightStyle:C({stroke:this.props.apiOptions.isMobile?A.BLUE_C:A.INTERACTING},this._lineStroke())});return k.invoke(s,"toFront"),a},this)},removeSegmentControls:function(){k.invoke(this.points,"remove"),k.invoke(this.lines,"remove")},addRayControls:function(){this.addLine("ray")},removeRayControls:function(){this.removeLine()},addPolygonControls:function(){this.polygon=null;var e=j.getPolygonCoords(this.props.graph,this.props);this.points=[],this.points=k.map(e,this.createPointForPolygonType,this),this.updatePolygon()},updatePolygon:function(){var e;e=this.polygon?this.polygon.closed():this.points.length>=3;var t=this.graphie,n=this.points.length,r=!k.contains(["angles","sides"],this.props.graph.snapTo),i=k.times(n,function(t){return this.props.graph.showAngles&&(e||0!==t&&t!==n-1)?"angles"===this.props.graph.snapTo?"$deg0":"$deg1":""},this),o=k.times(n,function(t){return e||0!==t&&t!==n-1},this),s=k.times(n,function(t){return this.props.graph.showAngles&&(e||0!==t&&t!==n-1)?1:0},this),a=k.times(n,function(t){return!this.props.graph.showSides||!e&&t===n-1?"":"sides"===this.props.graph.snapTo?"$len0":"$len1"},this);if(null==this.polygon){var p=this;p.polygon=S.addMovablePolygon(t,{constraints:[S.MovablePolygon.constraints.bound(),r?S.MovablePolygon.constraints.snap():null],closed:e,points:p.points,angleLabels:i,showRightAngleMarkers:o,numArcs:s,sideLabels:a,onMove:[S.MovablePolygon.onMove.updatePoints,function(){this.closed()&&p.updateCoordsFromPoints()}],normalStyle:C({stroke:this.props.apiOptions.isMobile?A.BLUE_C:A.INTERACTIVE},this._lineStroke())})}else this.polygon.update({closed:e,points:this.points,angleLabels:i,showRightAngleMarkers:o,numArcs:s,sideLabels:a})},removePolygonControls:function(){k.invoke(this.points,"remove"),this.polygon.remove()},addAngleControls:function(){var e=this,t=this.graphie,n=j.getAngleCoords(this.props.graph,this.props);this.points=k.map(n,function(e,n){return t.addMovablePoint(k.extend({coord:e,normalStyle:{stroke:A.INTERACTIVE,fill:A.INTERACTIVE}},1===n?{snapX:t.snap[0],snapY:t.snap[1]}:{}))}),this.angle=t.addMovableAngle({points:this.points,snapDegrees:this.props.graph.snapDegrees||1,snapOffsetDeg:this.props.graph.angleOffsetDeg||0,angleLabel:this.props.graph.showAngles?"$deg0":"",pushOut:2,allowReflex:s(this.props.graph.allowReflexAngles,!0)}),$(this.angle).on("move",function(){var t=k.extend({},e.props.graph,{coords:e.angle.getClockwiseCoords()});e.onChange({graph:t})})},removeAngleControls:function(){k.invoke(this.points,"remove"),this.angle.remove()},toggleShowAngles:function(){var e=k.extend({},this.props.graph,{showAngles:!this.props.graph.showAngles});this.onChange({graph:e})},toggleShowSides:function(){var e=k.extend({},this.props.graph,{showSides:!this.props.graph.showSides});this.onChange({graph:e})},getUserInput:function(){return this.props.graph},simpleValidate:function(e){return j.validate(this.getUserInput(),e,this)},focus:$.noop});k.extend(j,{getQuadraticCoefficients:function(e){var t=e[0],n=e[1],r=e[2],i=(t[0]-n[0])*(t[0]-r[0])*(n[0]-r[0]);if(0!==i){var o=(r[0]*(n[1]-t[1])+n[0]*(t[1]-r[1])+t[0]*(r[1]-n[1]))/i,s=(r[0]*r[0]*(t[1]-n[1])+n[0]*n[0]*(r[1]-t[1])+t[0]*t[0]*(n[1]-r[1]))/i,a=(n[0]*r[0]*(n[0]-r[0])*t[1]+r[0]*t[0]*(r[0]-t[0])*n[1]+t[0]*n[0]*(t[0]-n[0])*r[1])/i;return[o,s,a]}},getSinusoidCoefficients:function(e){var t=e[0],n=e[1],r=n[1]-t[1],i=Math.PI/(2*(n[0]-t[0])),o=t[0]*i,s=t[1];return[r,i,o,s]},getLineCoords:function(e,t){return e.coords||j.pointsFromNormalized(t,[[.25,.75],[.75,.75]])},getPointCoords:function(e,t){var n=e.numPoints||1,r=e.coords;if(r)return r;switch(n){case 1:r=[e.coord||[0,0]];break;case 2:r=[[-5,0],[5,0]];break;case 3:r=[[-5,0],[0,0],[5,0]];break;case 4:r=[[-6,0],[-2,0],[2,0],[6,0]];break;case 5:r=[[-6,0],[-3,0],[0,0],[3,0],[6,0]];break;case 6:r=[[-5,0],[-3,0],[-1,0],[1,0],[3,0],[5,0]];break;case W:r=[]}var i=[[-10,10],[-10,10]];r=j.normalizeCoords(r,i);var r=j.pointsFromNormalized(t,r);return r},getLinearSystemCoords:function(e,t){return e.coords||k.map([[[.25,.75],[.75,.75]],[[.25,.25],[.75,.25]]],function(e){return j.pointsFromNormalized(t,e)})},getPolygonCoords:function(e,t){var n=e.coords;if(n)return n;var r=e.numSides||3;if(r===W)n=[];else{var i=2*Math.PI/r,o=(1/r-.5)*Math.PI,s="sides"===e.snapTo?Math.sqrt(3)/3*7:4;n=k.times(r,function(e){return[s*Math.cos(e*i+o),s*Math.sin(e*i+o)]})}var a=[[-10,10],[-10,10]];n=j.normalizeCoords(n,a);var p=!k.contains(["angles","sides"],e.snapTo);return n=j.pointsFromNormalized(t,n,!p)},getSegmentCoords:function(e,t){var n=e.coords;if(n)return n;var r=e.numSegments||1,i={1:[5],2:[5,-5],3:[5,0,-5],4:[6,2,-2,-6],5:[6,3,0,-3,-6],6:[5,3,1,-1,-3,-5]}[r],o=[[-10,10],[-10,10]];return k.map(i,function(e){var n=[[-5,e],[5,e]];return n=j.normalizeCoords(n,o),n=j.pointsFromNormalized(t,n)})},getAngleCoords:function(e,t){var n=e.coords;if(n)return n;for(var r=e.snapDegrees||1,i=r;i<20;)i+=r;i=i*Math.PI/180;var o=(e.angleOffsetDeg||0)*Math.PI/180;n=j.pointsFromNormalized(t,[[.85,.5],[.5,.5]]);var s=u(l.apply(null,n));return n[0]=[n[1][0]+s*Math.cos(o),n[1][1]+s*Math.sin(o)],n[2]=[n[1][0]+s*Math.cos(i+o),n[1][1]+s*Math.sin(i+o)],n},normalizeCoords:function(e,t){return k.map(e,function(e){return k.map(e,function(e,n){var r=t[n][1]-t[n][0];return(e+t[n][1])/r})})},getEquationString:function(e){var t=e.graph.type,n="get"+b(t)+"EquationString";return j[n](e)},pointsFromNormalized:function(e,t,n){return k.map(t,function(t){return k.map(t,function(t,r){var i=e.range[r];if(n)return i[0]+(i[1]-i[0])*t;var o=e.step[r],s=x(i,o),a=Math.round(t*s);return i[0]+o*a})})},getLinearEquationString:function(e){var t=j.getLineCoords(e.graph,e);if(z(t[0][0],t[1][0]))return"x = "+t[0][0].toFixed(3);var n=(t[1][1]-t[0][1])/(t[1][0]-t[0][0]),r=t[0][1]-n*t[0][0];return z(n,0)?"y = "+r.toFixed(3):"y = "+n.toFixed(3)+"x + "+r.toFixed(3)},getCurrentQuadraticCoefficients:function(e){var t=e.graph.coords||j.defaultQuadraticCoords(e);return j.getQuadraticCoefficients(t)},defaultQuadraticCoords:function(e){var t=[[.25,.75],[.5,.25],[.75,.75]];return j.pointsFromNormalized(e,t)},getQuadraticEquationString:function(e){var t=j.getCurrentQuadraticCoefficients(e);return"y = "+t[0].toFixed(3)+"x^2 + "+t[1].toFixed(3)+"x + "+t[2].toFixed(3)},getCurrentSinusoidCoefficients:function(e){var t=e.graph.coords||j.defaultSinusoidCoords(e);return j.getSinusoidCoefficients(t)},defaultSinusoidCoords:function(e){var t=[[.5,.5],[.65,.6]];return j.pointsFromNormalized(e,t)},getSinusoidEquationString:function(e){var t=j.getCurrentSinusoidCoefficients(e);return"y = "+t[0].toFixed(3)+"sin("+t[1].toFixed(3)+"x - "+t[2].toFixed(3)+") + "+t[3].toFixed(3)},getCircleEquationString:function(e){var t=e.graph,n=t.center||[0,0],r=t.radius||2;return"center ("+n[0]+", "+n[1]+"), radius "+r},getLinearSystemEquationString:function(e){var t=j.getLinearSystemCoords(e.graph,e);return"\n"+T(t[0][0],t[0][1])+"\n"+T(t[1][0],t[1][1])+"\n"+P(t[0],t[1])},getPointEquationString:function(e){var t=j.getPointCoords(e.graph,e);return t.map(function(e){return"("+e[0]+", "+e[1]+")"}).join(", ")},getSegmentEquationString:function(e){var t=j.getSegmentCoords(e.graph,e);return k.map(t,function(e){return"["+k.map(e,function(e){return"("+e.join(", ")+")"}).join(" ")+"]"}).join(" ")},getRayEquationString:function(e){var t=j.getLineCoords(e.graph,e),n=t[0],r=t[1],i=j.getLinearEquationString(e);return i+=n[0]>r[0]?" (for x <= "+n[0].toFixed(3)+")":n[0]<r[0]?" (for x >= "+n[0].toFixed(3)+")":n[1]>r[1]?" (for y <= "+n[1].toFixed(3)+")":" (for y >= "+n[1].toFixed(3)+")"},getPolygonEquationString:function(e){var t=j.getPolygonCoords(e.graph,e);return k.map(t,function(e){return"("+e.join(", ")+")"}).join(" ")},getAngleEquationString:function(e){var t=j.getAngleCoords(e.graph,e),n=_.findAngle(t[2],t[0],t[1]);return n.toFixed(0)+"Â° angle at ("+t[1].join(", ")+")"},validate:function(e,t,n){var r=!!(e.coords||e.center&&e.radius);if(e.type===t.correct.type&&r)if("linear"===e.type){var o=e.coords,s=t.correct.coords;if(i(s[0],s[1],o[0])&&i(s[0],s[1],o[1]))return{type:"points",earned:1,total:1,message:null}}else if("linear-system"===e.type){var o=e.coords,s=t.correct.coords;if(i(s[0][0],s[0][1],o[0][0])&&i(s[0][0],s[0][1],o[0][1])&&i(s[1][0],s[1][1],o[1][0])&&i(s[1][0],s[1][1],o[1][1])||i(s[0][0],s[0][1],o[1][0])&&i(s[0][0],s[0][1],o[1][1])&&i(s[1][0],s[1][1],o[0][0])&&i(s[1][0],s[1][1],o[0][1]))return{type:"points",earned:1,total:1,message:null}}else if("quadratic"===e.type){var a=this.getQuadraticCoefficients(e.coords),p=this.getQuadraticCoefficients(t.correct.coords);if(V(a,p))return{type:"points",earned:1,total:1,message:null}}else if("sinusoid"===e.type){var a=this.getSinusoidCoefficients(e.coords),p=this.getSinusoidCoefficients(t.correct.coords),l=v(a),u=v(p);if(V(l,u))return{type:"points",earned:1,total:1,message:null}}else if("circle"===e.type){if(V(e.center,t.correct.center)&&z(e.radius,t.correct.radius))return{type:"points",earned:1,total:1,message:null}}else if("point"===e.type){var o=e.coords,s=j.getPointCoords(t.correct,n);if(o=o.slice(),s=s.slice(),o.sort(),s.sort(),V(o,s))return{type:"points",earned:1,total:1,message:null}}else if("polygon"===e.type){var c,o=e.coords.slice(),s=t.correct.coords.slice();if("similar"===t.correct.match?c=f(o,s,Number.POSITIVE_INFINITY):"congruent"===t.correct.match?c=f(o,s,R.DEFAULT_TOLERANCE):"approx"===t.correct.match?c=f(o,s,.1):(o.sort(),s.sort(),c=V(o,s)),c)return{type:"points",earned:1,total:1,message:null}}else if("segment"===e.type){var o=e.coords.slice(),s=t.correct.coords.slice();if(o=k.invoke(o,"sort").sort(),s=k.invoke(s,"sort").sort(),V(o,s))return{type:"points",earned:1,total:1,message:null}}else if("ray"===e.type){var o=e.coords,s=t.correct.coords;if(V(o[0],s[0])&&i(s[0],s[1],o[1]))return{type:"points",earned:1,total:1,message:null}}else if("angle"===e.type){var c,o=e.coords,s=t.correct.coords;if("congruent"===t.correct.match){var h=k.map([o,s],function(e){var t=_.findAngle(e[2],e[0],e[1]);return(t+360)%360});c=z.apply(null,h)}else c=V(o[1],s[1])&&i(s[1],s[0],o[0])&&i(s[1],s[2],o[2]);if(c)return{type:"points",earned:1,total:1,message:null}}return!r||k.isEqual(e,t.graph)?{type:"invalid",message:null}:{type:"points",earned:0,total:1,message:null}}}),e.exports={name:"interactive-graph",displayName:"Interactive graph",widget:j}},function(e,t,n){"use strict";var r=n(10),i=n(9),o=n(80),s=n(93),a=5,p={display:"table",tableLayout:"fixed"},l={display:"table-row"},u={display:"table-cell",padding:a},c={borderRadius:10,cursor:"pointer"},h={padding:a,display:"inline-block"},d={float:"right",paddingRight:a},f=50,g={plus:function(){return[[!1,!0,!1],[!0,!0,!0],[!1,!0,!1]]},x:function(){return[[!0,!1,!0],[!1,!0,!1],[!0,!1,!0]]},"plus/x":function(e){return e%2?g.x():g.plus()}},m=r.createClass({displayName:"Tile",propTypes:{value:r.PropTypes.bool.isRequired,size:r.PropTypes.number.isRequired},render:function(){var e=this.props.value?"#55dd55":"#115511",t=i.extend({},c,{width:this.props.size,height:this.props.size,backgroundColor:e});return r.createElement("div",{style:t,onClick:this._flip})},_flip:function(){this.props.onChange(!this.props.value)}}),v=r.createClass({displayName:"TileGrid",propTypes:{cells:r.PropTypes.arrayOf(r.PropTypes.arrayOf(r.PropTypes.bool)).isRequired,size:r.PropTypes.number.isRequired},render:function(){var e=this;return r.createElement("div",{style:p,className:"no-select"},i.map(this.props.cells,function(t,n){return r.createElement("div",{key:n,style:l},i.map(t,function(t,o){return r.createElement("div",{key:o,style:u},r.createElement(m,{value:t,size:e.props.size,onChange:i.partial(e.props.onChange,n,o)}))}))}))}}),y=function(e,t){return i.map(e,function(e,n){return i.map(e,function(e,r){return t(n,r)?!e:e})})},b=function(e,t,n,r){return y(e,function(e,i){var o=e-t,s=i-n;return Math.abs(o)<=1&&Math.abs(s)<=1&&r[o+1][s+1]})},T=r.createClass({displayName:"LightsPuzzle",mixins:[o,s],propTypes:{cells:r.PropTypes.arrayOf(r.PropTypes.arrayOf(r.PropTypes.bool)),startCells:r.PropTypes.arrayOf(r.PropTypes.arrayOf(r.PropTypes.bool)),flipPattern:r.PropTypes.string.isRequired,moveCount:r.PropTypes.number.isRequired},getDefaultProps:function(){return{cells:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],startCells:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],flipPattern:"plus",moveCount:0}},render:function(){var e=this._width(),t=f,n=e*(t+2*a);return r.createElement("div",null,r.createElement(v,{cells:this.props.cells,size:t,onChange:this._flipTile}),r.createElement("div",{style:{width:n}},r.createElement("div",{style:h},"Moves: ",this.props.moveCount),r.createElement("div",{style:d},r.createElement("input",{type:"button",value:"Reset",onClick:this._reset,className:"simple-button"}))),r.createElement("div",{className:"clearfix"}))},_width:function(){return 0!==this.props.cells.length?this.props.cells[0].length:0},componentDidMount:function(){this._initNextPatterns()},componentDidUpdate:function(e){e.flipPattern!==this.props.flipPattern&&this._initNextPatterns()},_initNextPatterns:function(){this._currPattern=g[this.props.flipPattern](0),this._nextPattern=g[this.props.flipPattern](1),this._patternIndex=2},_shiftPatterns:function(){this._currPattern=this._nextPattern,this._nextPattern=g[this.props.flipPattern](this._patternIndex),this._patternIndex++},_flipTile:function(e,t){var n=b(this.props.cells,e,t,this._currPattern);this._shiftPatterns(),this.change({cells:n,moveCount:this.props.moveCount+1})},_reset:function(){this.change({cells:this.props.startCells,moveCount:0})},simpleValidate:function(e){return P(e,this.getUserInput())}}),P=function(e,t){var n=i.all(t.cells,function(t,n){return i.all(t,function(t,r){return t===e.startCells[n][r]})});if(n)return{type:"invalid",message:i18n._("Click on the tiles to change the lights.")};var r=i.all(t.cells,function(e){return i.all(e,function(e){return e})});return r?{type:"points",earned:1,total:1,message:null}:e.gradeIncompleteAsWrong?{type:"points",earned:0,total:1,message:null}:{type:"invalid",message:i18n._("You must turn on all of the lights to continue.")}},x=function(e){return{cells:e.startCells,startCells:e.startCells,flipPattern:e.flipPattern}};e.exports={name:"lights-puzzle",displayName:"Lights Puzzle",hidden:!0,widget:T,transform:x}},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(12),o=n(10),s=n(11),a=n(9),p=n(101),l=n(8),u=n(103),c=n(104),h=n(75),d=n(17).Options,f=n(70),g=n(73).propTypes.keypadElementPropType,m=n(105).assert,v=n(16).stringArrayOfSize,y={INPUT_MARGIN:4,INPUT_HEIGHT:38,INPUT_WIDTH:82},b={INPUT_MARGIN:3,INPUT_HEIGHT:30,INPUT_WIDTH:40},T={INPUT_MARGIN:4,INPUT_HEIGHT:36,INPUT_WIDTH:64},P=function(e,t){return[""+e,""+t]},x=function(){return P(0,0)},C=function(e){return m(a.isArray(e)&&2===e.length),+e[0]},E=function(e){return m(a.isArray(e)&&2===e.length),+e[1]},k=function(e){var t=C(e),n=E(e);return"answer"+t+","+n},M=function(e){var t=[1,1];return a(e).each(function(e,n){var r=0;a(e).each(function(e,t){null!=e&&e.toString().length&&(r=t+1)}),t[1]=Math.max(t[1],r),r>0&&(t[0]=Math.max(t[0],n+1))}),t},w=o.createClass({displayName:"Matrix",propTypes:{answers:o.PropTypes.arrayOf(o.PropTypes.arrayOf(o.PropTypes.oneOfType([o.PropTypes.string,o.PropTypes.number]))),apiOptions:d.propTypes,cursorPosition:o.PropTypes.arrayOf(o.PropTypes.number),keypadElement:g,matrixBoardSize:o.PropTypes.arrayOf(o.PropTypes.number).isRequired,prefix:o.PropTypes.string,suffix:o.PropTypes.string,trackInteraction:o.PropTypes.func.isRequired},getDefaultProps:function(){return{matrixBoardSize:[3,3],answers:[[]],prefix:"",suffix:"",cursorPosition:[0,0],apiOptions:d.defaults}},getInitialState:function(){return{enterTheMatrix:0}},componentDidMount:function(){this.cursorPosition=[0,0]},render:function(){var e=this,t=void 0;t=this.props.apiOptions.customKeypad?T:this.props.apiOptions.staticRender?y:b;var n=t,s=n.INPUT_MARGIN,d=n.INPUT_HEIGHT,f=n.INPUT_WIDTH,g=M(this.props.answers),m=this.props.matrixBoardSize[0],v=this.props.matrixBoardSize[1],x=this.props.cursorPosition[0],C=this.props.cursorPosition[1],E=Math.max(x,g[0]-1),w=Math.max(C,g[1]-1),S=(E+1)*(d+2*s),I=(w+1)*(f+2*s),N=i({"perseus-matrix":!0,"static-mode":this.props.static,"the-matrix":this.state.enterTheMatrix>=5});return o.createElement("div",{className:N},this.props.prefix&&o.createElement("div",{className:"matrix-prefix"},o.createElement(l,{content:this.props.prefix})),o.createElement("div",{className:"matrix-input"},o.createElement("div",{className:"matrix-bracket bracket-left",style:{height:S}}),o.createElement("div",{className:"matrix-bracket bracket-right",style:{height:S,left:I}}),a(m).times(function(t){var n=e.props.answers[t];return o.createElement("div",{className:"matrix-row",key:t},a(v).times(function(i){var a=t>E||i>w,l={className:a?"outside":"inside",ref:k(P(t,i)),value:n?n[i]:null,style:{height:d,width:f,margin:s},disabled:e.props.apiOptions.readOnly,onFocus:function(){e.cursorPosition=[t,i],e.props.onChange({cursorPosition:[t,i]},function(){return!1}),e._handleFocus(t,i)},onBlur:function(){t===e.cursorPosition[0]&&i===e.cursorPosition[1]&&e.props.onChange({cursorPosition:[0,0]},function(){return!1}),e._handleBlur(t,i)},onKeyDown:function(n){e.handleKeyDown(t,i,n)},onChange:function(n,r){e.onValueChange(t,i,n,r)}},g=void 0;if(e.props.apiOptions.customKeypad){var m={margin:s,minWidth:f,minHeight:d,boxSizing:"border-box",backgroundColor:a?"#f3f3f3":"#fff"};g=o.createElement(h,r({},l,{style:m,scrollable:!0,keypadElement:e.props.keypadElement}))}else g=e.props.apiOptions.staticRender?o.createElement(c,l):e.props.numericInput?o.createElement(p,l):o.createElement(u,l);return o.createElement("span",{key:i,className:"matrix-input-field"},g)}))})),this.props.suffix&&o.createElement("div",{className:"matrix-suffix"},o.createElement(l,{content:this.props.suffix})))},getInputPaths:function(){var e=[],t=this.props.matrixBoardSize[0],n=this.props.matrixBoardSize[1];return a(t).times(function(t){a(n).times(function(n){var r=P(t,n);e.push(r)})}),e},getGrammarTypeForPath:function(e){return"number"},_handleFocus:function(e,t){this.props.onFocus(P(e,t))},_handleBlur:function(e,t){this.props.onBlur(P(e,t))},focus:function(){return this.focusInputPath(x()),!0},focusInputPath:function(e){var t=k(e);this.refs[t].focus()},blurInputPath:function(e){0===e.length&&(e=x());var t=k(e);this.refs[t].blur()},getDOMNodeForPath:function(e){var t=k(e);return s.findDOMNode(this.refs[t])},setInputValue:function(e,t,n){var r=C(e),i=E(e);this.onValueChange(r,i,t,n)},handleKeyDown:function(e,t,n){var r=this.props.matrixBoardSize[0],i=this.props.matrixBoardSize[1],o=null,s=this.refs[k(P(e,t))],a=s.getStringValue(),p=s.getSelectionStart(),l=s.getSelectionEnd(),u=null;if("ArrowUp"===n.key&&e>0?u=P(e-1,t):"ArrowDown"===n.key&&e+1<r?u=P(e+1,t):"ArrowLeft"===n.key&&t>0?0===p&&0===l&&(u=P(e,t-1)):"ArrowRight"===n.key&&t+1<i?p===a.length&&(u=P(e,t+1)):"Enter"===n.key?o=this.state.enterTheMatrix+1:"Escape"===n.key&&(o=0),u){n.preventDefault();var c=this.refs[k(u)],h=c.getStringValue(),d=2*h.length;c.focus(),"ArrowRight"===n.key?c.setSelectionRange(0,0):c.setSelectionRange(d,d)}null!=o&&this.setState({enterTheMatrix:o})},onValueChange:function(e,t,n,r){var i=a.map(this.props.answers,a.clone);i[e]||(i[e]=[]),i[e][t]=n,this.props.onChange({answers:i},r),this.props.trackInteraction()},getUserInput:function(){return{answers:this.props.answers}},simpleValidate:function(e){return w.validate(this.getUserInput(),e)}});a.extend(w,{validate:function(e,t){var n=t.answers,r=e.answers,i=M(n),o=M(r),s=i[0]!==o[0]||i[1]!==o[1],p=f.number.createValidatorFunctional,l=null,u=!1,c=!1;return a(o[0]).times(function(e){a(o[1]).times(function(t){null!=r[e][t]&&0!==r[e][t].toString().length||(u=!0);var i=p(n[e][t],{simplify:!0}),o=i(r[e][t]);o.message&&(l=o.message),o.correct||(c=!0)})}),u?{type:"invalid",message:i18n._("Make sure you fill in all cells in the matrix.")}:s?{type:"points",earned:0,total:1,message:null}:{type:"points",earned:c?0:1,total:1,message:l}}});var S=function(e){var t=a(e.matrixBoardSize[0]).times(function(){return v(e.matrixBoardSize[1])});return e=a.pick(e,"matrixBoardSize","prefix","suffix"),a.extend(e,{answers:t})},I=function(e){var t=a.pick(e,"matrixBoardSize","prefix","suffix");return t.answers=a.map(e.answers,function(e){return a.map(e,function(e){return null!=e?String(e):""})}),t};e.exports={name:"matrix",displayName:"Matrix",widget:w,transform:S,staticTransform:I}},function(e,t,n){"use strict";var r=n(10),i=n(9),o=n(8),s=n(106),a=n(17).Options,p=n(16).shuffle,l=n(16).seededRNG,u=r.createClass({displayName:"Matcher",propTypes:{apiOptions:a.propTypes,labels:r.PropTypes.array,left:r.PropTypes.array,onChange:r.PropTypes.func,orderMatters:r.PropTypes.bool,padding:r.PropTypes.bool,problemNum:r.PropTypes.number,right:r.PropTypes.array,trackInteraction:r.PropTypes.func.isRequired},getDefaultProps:function(){return{left:[],right:[],labels:["",""],orderMatters:!1,padding:!0,problemNum:0,onChange:function(){}}},getInitialState:function(){return{leftHeight:0,rightHeight:0}},render:function(){var e,t=l(this.props.problemNum);e=this.props.orderMatters?p(this.props.left,t,!0):this.props.left;var n=p(this.props.right,t,!0),a=i.any(this.props.labels),u={height:i.max([this.state.leftHeight,this.state.rightHeight])},c=this.props.apiOptions.isMobile?8:5;return r.createElement("div",{className:"perseus-widget-matcher"},a&&r.createElement("div",{className:"perseus-clearfix"},r.createElement("div",{className:"column"},r.createElement("div",{className:"column-label"},r.createElement(o,{content:this.props.labels[0]||"..."}))),r.createElement("div",{className:"column"},r.createElement("div",{className:"column-label"},r.createElement(o,{content:this.props.labels[1]||"..."})))),r.createElement("div",{className:"perseus-clearfix"},r.createElement("div",{className:"column"},r.createElement(s,{options:e,layout:"vertical",padding:this.props.padding,disabled:!this.props.orderMatters,constraints:u,onMeasure:this.onMeasureLeft,onChange:this.changeAndTrack,margin:c,ref:"left"})),r.createElement("div",{className:"column"},r.createElement(s,{options:n,layout:"vertical",padding:this.props.padding,constraints:u,onMeasure:this.onMeasureRight,onChange:this.changeAndTrack,margin:c,ref:"right"}))))},changeAndTrack:function(e){this.props.onChange(e),this.props.trackInteraction()},onMeasureLeft:function(e){var t=i.max(e.heights);this.setState({leftHeight:t})},onMeasureRight:function(e){var t=i.max(e.heights);this.setState({rightHeight:t})},getUserInput:function(){return{left:this.refs.left.getOptions(),right:this.refs.right.getOptions()}},simpleValidate:function(e){return u.validate(this.getUserInput(),e)}});i.extend(u,{validate:function(e,t){var n=i.isEqual(e.left,t.left)&&i.isEqual(e.right,t.right);return{type:"points",earned:n?1:0,total:1,message:null}}}),e.exports={name:"matcher",displayName:"Two column matcher",widget:u}},function(e,t,n){"use strict";var r=n(10),i=n(11),o=n(9),s=n(17).Options,a=n(102),p={url:null,top:0,left:0},l=r.createClass({displayName:"Measurer",propTypes:{apiOptions:s.propTypes,box:r.PropTypes.arrayOf(r.PropTypes.number),image:r.PropTypes.shape({url:r.PropTypes.string,top:r.PropTypes.number,left:r.PropTypes.number}),showProtractor:r.PropTypes.bool,protractorX:r.PropTypes.number,protractorY:r.PropTypes.number,showRuler:r.PropTypes.bool,rulerLabel:r.PropTypes.string,rulerTicks:r.PropTypes.number,rulerPixels:r.PropTypes.number,rulerLength:r.PropTypes.number},getDefaultProps:function(){return{box:[480,480],image:{},showProtractor:!0,protractorX:7.5,protractorY:.5,showRuler:!1,rulerLabel:"",rulerTicks:10,rulerPixels:40,rulerLength:10}},getInitialState:function(){return{}},render:function(){var e=o.extend({},p,this.props.image);return r.createElement("div",{className:"perseus-widget perseus-widget-measurer graphie-container above-scratchpad",style:{width:this.props.box[0],height:this.props.box[1]}},e.url&&r.createElement("img",{src:e.url,style:{top:e.top,left:e.left}}),r.createElement("div",{className:"graphie",ref:"graphieDiv"}))},componentDidMount:function(){this.setupGraphie()},componentDidUpdate:function(e){var t=o.any(["box","showProtractor","showRuler","rulerLabel","rulerTicks","rulerPixels","rulerLength"],function(t){return e[t]!==this.props[t]},this);t&&this.setupGraphie()},setupGraphie:function(){var e=i.findDOMNode(this.refs.graphieDiv);$(e).empty();var t=this.graphie=a.createGraphie(e),n=[40,40],r=[[0,this.props.box[0]/n[0]],[0,this.props.box[1]/n[1]]];t.init({range:r,scale:n}),t.addMouseLayer({allowScratchpad:!0,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable}),this.protractor&&this.protractor.remove(),this.props.showProtractor&&(this.protractor=t.protractor([this.props.protractorX,this.props.protractorY])),this.ruler&&this.ruler.remove(),this.props.showRuler&&(this.ruler=t.ruler({center:[(r[0][0]+r[0][1])/2,(r[1][0]+r[1][1])/2],label:this.props.rulerLabel,pixelsPerUnit:this.props.rulerPixels,ticksPerUnit:this.props.rulerTicks,units:this.props.rulerLength}))},getUserInput:function(){return{}},simpleValidate:function(e){return l.validate(this.getUserInput(),e)},focus:$.noop});o.extend(l,{validate:function(e,t){return{type:"points",earned:1,total:1,message:null}}});var u={1:function(e){var t=o(e).chain().omit("imageUrl","imageTop","imageLeft").extend({image:{url:e.imageUrl,top:e.imageTop,left:e.imageLeft}}).value();return t}};e.exports={name:"measurer",displayName:"Measurer",widget:l,version:{major:1,minor:0},propUpgrades:u}},function(e,t,n){"use strict";var r=n(10),i=n(113),o=n(114),s=o.layout,a=n(115),p=a.parse,l=a.ParseError,u=30,c=r.createClass({displayName:"Molecule",propTypes:{id:r.PropTypes.string.isRequired,rotationAngle:r.PropTypes.number,smiles:r.PropTypes.string},getInitialState:function(){return{parsedSmiles:null,error:null}},componentWillMount:function(){this.stateFromSmiles(this.props.smiles)},componentDidMount:function(){this.canvasRender()},componentWillReceiveProps:function(e){this.stateFromSmiles(e.smiles)},componentDidUpdate:function(){this.canvasRender()},stateFromSmiles:function(e){try{this.setState({parsedSmiles:p(e),error:null})}catch(e){if(!(e instanceof l))throw e;this.setState({error:e.message})}},setCanvasBounds:function(e,t){var n=Math.max.apply(Math,t.map(function(e){return e.pos?e.pos[0]:-(1/0)})),r=Math.max.apply(Math,t.map(function(e){return e.pos?e.pos[1]:-(1/0)})),i=Math.min.apply(Math,t.map(function(e){return e.pos?e.pos[0]:1/0})),o=Math.min.apply(Math,t.map(function(e){return e.pos?e.pos[1]:1/0})),s=n-i+2*u,a=r-o+2*u;return e.width=s,e.height=a,[u-i,u-o]},canvasRender:function(){if(!this.state.error&&this.state.parsedSmiles){var e=s(this.state.parsedSmiles,this.props.rotationAngle),t=this.refs.canvas,n=this.setCanvasBounds(t,e),r=t.getContext("2d");r.clearRect(0,0,t.width,t.height),r.save(),r.translate(n[0],n[1]),i(r,e),r.restore()}},render:function(){var e=r.createElement("canvas",{className:"molecule-canvas",id:this.props.id+"-molecule",ref:"canvas"},"A molecular structure drawing.  SMILES notation:",this.props.smiles,".");return this.state.error&&(e=r.createElement("div",{className:"error"},this.state.error)),r.createElement("div",{className:"molecule-canvas"},e)}}),h=r.createClass({displayName:"MoleculeWidget",propTypes:{rotationAngle:r.PropTypes.number,smiles:r.PropTypes.string,widgetId:r.PropTypes.string},getDefaultProps:function(){return{rotationAngle:0}},simpleValidate:function(){return{type:"points",earned:0,total:0,message:null}},getUserInput:function(){return[]},validate:function(e,t){return{type:"points",earned:0,total:0,message:null}},render:function(){return r.createElement(c,{id:this.props.widgetId,smiles:this.props.smiles,rotationAngle:this.props.rotationAngle})}});e.exports={name:"molecule-renderer",displayName:"Molecule renderer",hidden:!1,widget:h,molecule:c}},function(e,t,n){"use strict";function r(e,t){return 1===t?""+e:e+"/"+t}function i(e,t){if(e<0)return"-"+i(-e,t);var n=Math.floor(e/t);return 0===n?r(e,t):e-n*t===0?""+n:n+"\\:"+r(e-n*t,t)}function o(e,t,n){var i=Math.floor(n/t);return r(e*i,n)}var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=n(10),p=n(11),l=n(9),u=n(80),c=n(101),h=n(104),d=n(75),f=n(17).Options,g=n(73).propTypes.keypadElementPropType,m=n(86),v=m.MovablePoint,y=m.Line,b=n(123).number,T=n(78),P=n(97),x=function(e,t,n){return Math.min(Math.max(e,t),n)},C=n(105).assert,E="â",k=30,M={ge:"le",gt:"lt",le:"ge",lt:"gt"},w={ge:"gt",gt:"ge",le:"lt",lt:"le"},S=function(e,t,n,s,a){if(s=s||n,"decimal"===t||"decimal ticks"===t)return e.label([n,-.53],Math.round(100*s)/100,"center");if("improper"===t){var p=T.toFraction(s);return e.label([n,-.53],r(p[0],p[1]),"center")}if("mixed"===t){var l=T.toFraction(s);return e.label([n,-.53],i(l[0],l[1]),"center")}if("non-reduced"===t){var u=T.toFraction(s);return e.label([n,-.53],o(u[0],u[1],a),"center");
}},I=m.createSimpleClass(function(e,t){if(!l.isFinite(t.tickStep)||t.tickStep<=0)return[];var n,r=[],i=t.range,o=t.labelRange,s=null==o[0]?i[0]:o[0],a=null==o[1]?i[1]:o[1];if("non-reduced"===t.labelStyle){for(var p=[s,a],u=0;u<=t.numDivisions;u++){var c=i[0]+u*t.tickStep;p.push(c)}var h=function(e){return b.toFraction(e)[1]},d=l.map(p,h);n=l.reduce(d,function(e,t){return T.getLCM(e,t)})}else n=void 0;for(var f=0;f<=t.numDivisions;f++){var g=i[0]+f*t.tickStep;r.push(e.line([g,-.2],[g,.2]));var m=t.labelTicks;(m||"decimal ticks"===t.labelStyle)&&r.push(S(e,t.labelStyle,g,g,n))}return r.push(e.style(t.isMobile?{color:P.BLUE_D}:{},function(){return S(e,t.labelStyle,s,s,n)})),r.push(e.style(t.isMobile?{color:P.BLUE_D}:{},function(){return S(e,t.labelStyle,a,a,n)})),e.style({stroke:t.isMobile?P.BLUE_D:P.DYNAMIC,strokeWidth:3.5},function(){r.push(e.line([s,-.2],[s,.2])),r.push(e.line([a,-.2],[a,.2]))}),r}),N=a.createClass({displayName:"NumberLine",propTypes:{range:a.PropTypes.arrayOf(a.PropTypes.number).isRequired,labelRange:a.PropTypes.arrayOf(a.PropTypes.number).isRequired,labelStyle:a.PropTypes.string.isRequired,labelTicks:a.PropTypes.bool.isRequired,divisionRange:a.PropTypes.arrayOf(a.PropTypes.number).isRequired,numDivisions:a.PropTypes.number.isRequired,snapDivisions:a.PropTypes.number.isRequired,isTickCtrl:a.PropTypes.bool.isRequired,isInequality:a.PropTypes.bool.isRequired,numLinePosition:a.PropTypes.number.isRequired,rel:a.PropTypes.oneOf(["lt","gt","le","ge"]),onFocus:a.PropTypes.func.isRequired,onBlur:a.PropTypes.func.isRequired,onChange:a.PropTypes.func.isRequired,apiOptions:f.propTypes,keypadElement:g,static:a.PropTypes.bool,showTooltips:a.PropTypes.bool,trackInteraction:a.PropTypes.func.isRequired},mixins:[u],getDefaultProps:function(){return{range:[0,10],labelStyle:"decimal",labelRange:[null,null],divisionRange:[1,12],labelTicks:!0,isTickCtrl:!1,isInequality:!1,numLinePosition:0,snapDivisions:2,showTooltips:!1,rel:"ge",apiOptions:f.defaults}},getInitialState:function(){return{numDivisionsEmpty:!1}},isValid:function(){var e=this.props.range,t=this.props.numLinePosition,n=this.props.divisionRange;return t=null==t?e[0]:t,e[0]<e[1]&&b.sign(t-e[0])>=0&&b.sign(t-e[1])<=0&&n[0]<n[1]&&0<this.props.numDivisions&&0<this.props.snapDivisions},onNumDivisionsChange:function(e,t){var n=this,r=this.props.divisionRange.slice(),i=this.props.range[1]-this.props.range[0];if(e=Math.round(e),e=e<0?e*-1:e){var o=l.extend({},this.props,{tickStep:i/e}),s=this.snapNumLinePosition(o,this.props.numLinePosition);this.setState({numDivisionsEmpty:!1},function(){n.props.onChange({divisionRange:r,numDivisions:e,numLinePosition:s},t)})}else this.setState({numDivisionsEmpty:!0},t)},_handleTickCtrlFocus:function(){this.props.onFocus(["tick-ctrl"])},_handleTickCtrlBlur:function(){this.props.onBlur(["tick-ctrl"])},focus:function(){if(this.props.isTickCtrl)return this.refs["tick-ctrl"].focus(),!0},focusInputPath:function(e){1===e.length&&this.refs[e[0]].focus()},blurInputPath:function(e){1===e.length&&this.refs[e[0]].blur()},getInputPaths:function(){return this.props.isTickCtrl?[["tick-ctrl"]]:[]},getDOMNodeForPath:function(e){if(1===e.length)return p.findDOMNode(this.refs[e[0]])},getGrammarTypeForPath:function(e){if(1===e.length&&"tick-ctrl"===e[0])return"number"},setInputValue:function(e,t,n){1===e.length&&"tick-ctrl"===e[0]&&this.onNumDivisionsChange(t,n)},_renderGraphie:function(){var e=this,t=this.props.range,n=t[1]-t[0],r=l.pick(this.props,["range","isTickCtrl"]),i=l.extend({},this.props,{tickStep:n/this.props.numDivisions});return a.createElement(m,{ref:"graphie",box:[460,80],options:r,onMouseDown:function(t){e.refs.graphie.movables.numberLinePoint.grab(t)},setup:this._setupGraphie,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable,isMobile:this.props.apiOptions.isMobile},a.createElement(I,s({},l.pick(i,["range","numDivisions","labelTicks","labelStyle","labelRange","tickStep"]),{isMobile:this.props.apiOptions.isMobile})),this._renderInequality(i),this._renderNumberLinePoint(i))},snapNumLinePosition:function(e,t){var n=e.range[0],r=e.range[1],i=e.tickStep/e.snapDivisions,o=x(t,n,r);return o=n+b.roundTo(o-n,i),C(l.isFinite(o)),o},_renderNumberLinePoint:function(e){var t,n=this,r=l(["lt","gt"]).contains(e.rel);t=r?P._BACKGROUND:e.static?P.DYNAMIC:P.INTERACTIVE;var i={fill:t,stroke:e.static?P.DYNAMIC:P.INTERACTIVE,"stroke-width":r?3:1},o={fill:r?P._BACKGROUND:P.INTERACTING,"stroke-width":r?3:1},s=e.isInequality?{stroke:P.INTERACTIVE,"fill-opacity":r?0:1}:{};return a.createElement(v,{ref:"numberLinePoint",pointSize:6,coord:[e.numLinePosition,0],constraints:[function(e,t){return[e[0],t[1]]},function(t,r){var i=n.snapNumLinePosition(e,t[0]);return[i,t[1]]}],normalStyle:i,highlightStyle:o,onMove:function(e){n.change({numLinePosition:e[0]}),n.props.trackInteraction()},isMobile:this.props.apiOptions.isMobile,mobileStyleOverride:s,showTooltips:this.props.showTooltips,xOnlyTooltip:!0})},handleReverse:function(){var e=M[this.props.rel];this.props.onChange({rel:e})},handleToggleStrict:function(){var e=w[this.props.rel];this.props.onChange({rel:e})},_getInequalityEndpoint:function(e){var t=l(["ge","gt"]).contains(e.rel),n=400,r=e.range,i=(r[1]-r[0])/n,o=k*i,s=r[0]-o,a=r[1]+o,p=t?[a,0]:[s,0];return p},_renderInequality:function(e){if(e.isInequality){var t=this._getInequalityEndpoint(e),n={arrows:"->",stroke:this.props.apiOptions.isMobile?P.INTERACTIVE:P.DYNAMIC,strokeWidth:3.5},r=["ge","gt"].includes(e.rel);return a.createElement(y,{start:[(r?.4:-.4)+e.numLinePosition,0],end:t,style:n})}return null},_setupGraphie:function(e,t){if(this.isValid()){var n=this.props.apiOptions.isMobile?288-2*k:400,r=t.range,i=(r[1]-r[0])/n,o=k*i,s=r[0]-o,a=r[1]+o,p=-1,l=1;e.init({range:[[s,a],[p,l]],scale:[1/i,40],isMobile:this.props.apiOptions.isMobile});var u=(r[0]+r[1])/2;e.line([u,0],[a,0],{arrows:"->"}),e.line([u,0],[s,0],{arrows:"->"})}},getUserInput:function(){return{numLinePosition:this.props.numLinePosition,rel:this.props.isInequality?this.props.rel:"eq",numDivisions:this.props.numDivisions,divisionRange:this.props.divisionRange}},simpleValidate:function(e){return N.validate(this.getUserInput(),e)},render:function(){var e,t=this.props.divisionRange,n=t[0]+E+t[1],r=this.props.numDivisions<t[0]||this.props.numDivisions>t[1],i=a.createElement("div",null,a.createElement("input",{type:"button",className:"simple-button",value:i18n._("Switch direction"),onClick:this.handleReverse}),a.createElement("input",{type:"button",className:"simple-button",value:l(["le","ge"]).contains(this.props.rel)?i18n._("Make circle open"):i18n._("Make circle filled"),onClick:this.handleToggleStrict}));if(this.props.isTickCtrl){var o;o=this.props.apiOptions.customKeypad?d:this.props.apiOptions.staticRender?h:c,e=a.createElement("label",null,i18n._("Number of divisions:")," ",a.createElement(o,{ref:"tick-ctrl",value:this.state.numDivisionsEmpty?null:this.props.numDivisions||t[0],checkValidity:function(e){return e>=t[0]&&e<=t[1]},onChange:this.onNumDivisionsChange,onFocus:this._handleTickCtrlFocus,onBlur:this._handleTickCtrlBlur,useArrowKeys:!0,keypadElement:this.props.keypadElement}))}return a.createElement("div",{className:"perseus-widget perseus-widget-interactive-number-line"},e,this.isValid()?this.props.isTickCtrl&&r?a.createElement("div",{className:"perseus-error"},$_({divRangeString:n},"Please make sure the number of divisions is in the range %(divRangeString)s.")):this._renderGraphie():a.createElement("div",{className:"perseus-error"},"Invalid number line configuration."),!this.props.static&&this.props.isInequality&&i)}});l.extend(N,{validate:function(e,t){var n=t.range,r=e.divisionRange,i=null!=t.initialX?t.initialX:n[0],o=t.isInequality?"ge":"eq",s=t.correctRel||"eq",a=b.equal(e.numLinePosition,t.correctX||0),p=e.numDivisions>r[1]||e.numDivisions<r[0];return e.isTickCrtl&&p?{type:"invalid",message:"Number of divisions is outside the allowed range."}:a&&s===e.rel?{type:"points",earned:1,total:1,message:null}:e.numLinePosition===i&&e.rel===o?{type:"invalid",message:null}:{type:"points",earned:0,total:1,message:null}}});var R=function(e){var t,n=l.pick(e,["range","labelRange","labelStyle","labelTicks","divisionRange","snapDivisions","isTickCtrl","isInequality","showTooltips"]),r=null!=e.initialX?e.initialX:e.range[0],i=e.range[1]-e.range[0];return t=null!=e.numDivisions?e.numDivisions:null!=e.tickStep?i/e.tickStep:void 0,l.extend(n,{numLinePosition:r,numDivisions:t,snapDivisions:n.snapDivisions||void 0}),n},O=function(e){var t,n=l.pick(e,["range","labelRange","labelStyle","labelTicks","divisionRange","snapDivisions","isInequality"]),r=null!=e.correctX?e.correctX:e.range[0],i=e.range[1]-e.range[0];return t=null!=e.numDivisions?e.numDivisions:null!=e.tickStep?i/e.tickStep:void 0,l.extend(n,{numLinePosition:r,numDivisions:t,rel:e.isInequality?e.correctRel:null,snapDivisions:n.snapDivisions||void 0}),n};e.exports={name:"number-line",displayName:"Number line",widget:N,transform:R,staticTransform:O}},function(e,t,n){"use strict";var r=n(10),i=n(11),o=n(9),s=n(8),a=n(16),p=n(17).ClassNames,l=r.createClass({displayName:"PlaceholderCard",propTypes:{width:r.PropTypes.number.isRequired,height:r.PropTypes.number.isRequired},render:function(){return r.createElement("div",{className:"card-wrap "+p.INTERACTIVE,style:{width:this.props.width}},r.createElement("div",{className:"card placeholder",style:{height:this.props.height}}))}}),u=r.createClass({displayName:"DragHintCard",render:function(){return r.createElement("div",{className:"card-wrap "+p.INTERACTIVE},r.createElement("div",{className:"card drag-hint"}))}}),c={position:r.PropTypes.shape({left:r.PropTypes.number,top:r.PropTypes.number})},h=r.createClass({displayName:"Card",propTypes:{floating:r.PropTypes.bool.isRequired,animating:r.PropTypes.bool,width:r.PropTypes.number,stack:r.PropTypes.bool,onMouseDown:r.PropTypes.func,onMouseMove:r.PropTypes.func,onMouseUp:r.PropTypes.func,startMouse:c.position,startOffset:c.position,animateTo:c.position,onAnimationEnd:r.PropTypes.func},getDefaultProps:function(){return{stack:!1,animating:!1}},render:function(){var e={};this.props.floating&&(e={position:"absolute",left:this.props.startOffset.left,top:this.props.startOffset.top}),this.props.width&&(e.width=this.props.width);var t=["card"];this.props.stack&&t.push("stack"),this.props.floating&&!this.props.animating&&(t.push("dragging"),e.left+=this.props.mouse.left-this.props.startMouse.left,e.top+=this.props.mouse.top-this.props.startMouse.top);var n=o.pick(this.props,"content"),i=this.props.animating?$.noop:this.onMouseDown;return r.createElement("div",{className:"card-wrap "+p.INTERACTIVE,style:e,onMouseDown:i,onTouchStart:i,onTouchMove:this.onMouseMove,onTouchEnd:this.onMouseUp,onTouchCancel:this.onMouseUp},r.createElement("div",{className:t.join(" ")},r.createElement(s,n)))},shouldComponentUpdate:function(e,t){return this.props.floating||e.floating||this.props.content!==e.content||this.props.fakeRef!==e.fakeRef},componentDidMount:function(){this.mouseMoveUpBound=!1},componentDidUpdate:function(e,t){if(this.props.animating&&!e.animating){var n=15*Math.sqrt(Math.sqrt(Math.pow(this.props.animateTo.left-this.props.startOffset.left,2)+Math.pow(this.props.animateTo.top-this.props.startOffset.top,2)));$(i.findDOMNode(this)).animate(this.props.animateTo,Math.max(n,1),this.props.onAnimationEnd)}},componentWillUnmount:function(){this.mouseMoveUpBound&&(console.warn("Removing an element with bound event handlers."),this.unbindMouseMoveUp(),a.resetTouchHandlers())},bindMouseMoveUp:function(){this.mouseMoveUpBound=!0,$(document).on("mousemove",this.onMouseMove),$(document).on("mouseup",this.onMouseUp)},unbindMouseMoveUp:function(){this.mouseMoveUpBound=!1,$(document).off("mousemove",this.onMouseMove),$(document).off("mouseup",this.onMouseUp)},onMouseDown:function(e){e.preventDefault();var t=a.extractPointerLocation(e);t&&(this.bindMouseMoveUp(),this.props.onMouseDown&&this.props.onMouseDown(t,this))},onMouseMove:function(e){e.preventDefault();var t=a.extractPointerLocation(e);t&&this.props.onMouseMove&&this.props.onMouseMove(t)},onMouseUp:function(e){e.preventDefault();var t=a.extractPointerLocation(e);t&&(this.unbindMouseMoveUp(),this.props.onMouseUp&&this.props.onMouseUp(t))}}),d="normal",f="auto",g="horizontal",m="vertical",v=r.createClass({displayName:"Orderer",propTypes:{correctOptions:r.PropTypes.array,current:r.PropTypes.array,height:r.PropTypes.oneOf([d,f]),layout:r.PropTypes.oneOf([g,m]),options:r.PropTypes.array,trackInteraction:r.PropTypes.func.isRequired},getDefaultProps:function(){return{current:[],options:[],correctOptions:[],height:d,layout:g}},getInitialState:function(){return{current:[],dragging:!1,placeholderIndex:null}},componentWillReceiveProps:function(e){o.isEqual(this.props.current,e.current)||this.setState({current:e.current})},render:function(){var e=this,t=this.state.dragging&&r.createElement(h,{ref:"dragging",floating:!0,content:this.state.dragContent,startOffset:this.state.offsetPos,startMouse:this.state.grabPos,mouse:this.state.mousePos,width:this.state.dragWidth,onMouseUp:this.onRelease,onMouseMove:this.onMouseMove,key:this.state.dragKey||"draggingCard"}),n=this.state.animating&&r.createElement(h,{floating:!0,animating:!0,content:this.state.dragContent,startOffset:this.state.offsetPos,width:this.state.dragWidth,animateTo:this.state.animateTo,onAnimationEnd:this.state.onAnimationEnd,key:this.state.dragKey||"draggingCard"}),i=o.map(this.state.current,function(e,t){return r.createElement(h,{ref:"sortable"+t,fakeRef:"sortable"+t,floating:!1,content:e.content,width:e.width,key:e.key,onMouseDown:this.state.animating?$.noop:this.onClick.bind(null,"current",t)})},this);if(null!=this.state.placeholderIndex){var s=r.createElement(l,{ref:"placeholder",width:this.state.dragWidth,height:this.state.dragHeight,key:"placeholder"});i.splice(this.state.placeholderIndex,0,s)}var a=i.length>0;i.push(t,n);var c=r.createElement("div",{className:"perseus-clearfix draggable-box"},!a&&r.createElement(u,null),r.createElement("div",{ref:"dragList"},i)),d=r.createElement("div",{ref:"bank",className:"bank perseus-clearfix"},o.map(this.props.options,function(t,n){return r.createElement(h,{ref:"bank"+n,floating:!1,content:t.content,stack:!0,key:n,onMouseDown:e.state.animating?$.noop:e.onClick.bind(null,"bank",n),onMouseMove:e.onMouseMove,onMouseUp:e.onRelease})},this));return r.createElement("div",{className:"draggy-boxy-thing orderer height-"+this.props.height+" layout-"+this.props.layout+" above-scratchpad blank-background perseus-clearfix "+p.INTERACTIVE,ref:"orderer"},d,c)},onClick:function(e,t,n,r){var o,s=$(i.findDOMNode(r)),a=this.state.current.slice(),p=null;"current"===e?(a.splice(t,1),o=this.state.current[t],p=t):"bank"===e&&(o=this.props.options[t]),this.setState({current:a,dragging:!0,placeholderIndex:p,dragKey:o.key,dragContent:o.content,dragWidth:s.width(),dragHeight:s.height(),grabPos:n,mousePos:n,offsetPos:s.position()})},onRelease:function(e){var t=this,n=this.refs.dragging;if(null!=n){var r=this.isCardInBank(n),s=this.state.placeholderIndex,a=function(){var e=t.state.current.slice();if(!r){var n={content:t.state.dragContent,key:o.uniqueId("perseus_draggable_card_"),width:t.state.dragWidth};e.splice(s,0,n)}t.props.onChange({current:e}),t.setState({current:e,dragging:!1,placeholderIndex:null,animating:!1}),t.props.trackInteraction()},p=$(i.findDOMNode(n)).position(),l=null;r?o.each(this.props.options,function(e,t){if(e.content===this.state.dragContent){var n=i.findDOMNode(this.refs["bank"+t]);l=$(n).position()}},this):null!=this.refs.placeholder&&(l=$(i.findDOMNode(this.refs.placeholder)).position()),null==l?a():this.setState({offsetPos:p,animateTo:l,onAnimationEnd:a,animating:!0,dragging:!1})}},onMouseMove:function(e){var t=this.refs.dragging;if(null!=t){var n;n=this.isCardInBank(t)?null:this.findCorrectIndex(t,this.state.current),this.setState({mousePos:e,placeholderIndex:n})}},findCorrectIndex:function(e,t){var n=this.props.layout===g,r=$(i.findDOMNode(this.refs.dragList)),s=r.offset().left,a=r.offset().top,p=$(i.findDOMNode(e)).offset().left-s,l=$(i.findDOMNode(e)).offset().top-a,u=0,c=0,h=0;return n?o.each(t,function(e,t){var n=i.findDOMNode(this.refs["sortable"+t]),r=$(n).outerWidth(!0);p>c+r/2&&(u+=1),c+=r},this):o.each(t,function(e,t){var n=i.findDOMNode(this.refs["sortable"+t]),r=$(n).outerHeight(!0);l>h+r/2&&(u+=1),h+=r},this),u},isCardInBank:function(e){if(null==e)return!1;var t=this.props.layout===g,n=$(i.findDOMNode(e)),r=$(i.findDOMNode(this.refs.bank)),o=n.offset(),s=r.offset(),a=n.outerHeight(!0),p=r.outerHeight(!0),l=r.outerWidth(!0),u=i.findDOMNode(this.refs.dragList),c=($(u).width(),n.outerWidth(!0));return t?o.top+a/2<s.top+p:o.left+c/2<s.left+l},getUserInput:function(){return{current:o.map(this.props.current,function(e){return e.content})}},simpleValidate:function(e){return v.validate(this.getUserInput(),e)}});o.extend(v,{validate:function(e,t){if(0===e.current.length)return{type:"invalid",message:null};var n=o.isEqual(e.current,o.pluck(t.correctOptions,"content"));return{type:"points",earned:n?1:0,total:1,message:null}}}),e.exports={name:"orderer",displayName:"Orderer",widget:v}},function(e,t,n){"use strict";var r=n(13),i=r.StyleSheet,o=r.css,s=n(10),a=n(11),p=n(9),l=n(80),u=n(8),c=n(116),h=s.createClass({displayName:"LineHeightMeasurer",measureLineHeight:function(){this.$body.text(" Â");var e=this.$end.offset().top-this.$body.offset().top;return this.$body.text(""),e},render:function(){var e=this;return s.createElement("div",{className:o(d.measurer)},s.createElement("div",null,s.createElement("div",{ref:function(t){return e.$body=$(t)},className:"paragraph"}),s.createElement("div",{ref:function(t){return e.$end=$(t)}})))}}),d=i.create({measurer:{position:"absolute",width:"100%",top:0,left:0}}),f=s.createClass({displayName:"Passage",mixins:[l],propTypes:{passageTitle:s.PropTypes.string,passageText:s.PropTypes.string,footnotes:s.PropTypes.string,showLineNumbers:s.PropTypes.bool,onChange:s.PropTypes.func,highlightRanges:s.PropTypes.arrayOf(s.PropTypes.arrayOf(s.PropTypes.number)),reviewModeRubric:s.PropTypes.shape({passageTitle:s.PropTypes.string,passageText:s.PropTypes.string,footnotes:s.PropTypes.string,showLineNumbers:s.PropTypes.bool,static:s.PropTypes.bool})},getDefaultProps:function(){return{passageTitle:"",passageText:"",footnotes:"",showLineNumbers:!0,highlightRanges:[]}},getInitialState:function(){return{nLines:null,startLineNumbersAfter:0,newHighlightRange:null,selectedHighlightRange:null,mouseX:null,mouseY:null}},supportsHighlighting:function(){return!this.props.passageText.match(/\[\[1\]\]/)},canUpdateHighlighting:function(){return!this.props.reviewModeRubric&&this.supportsHighlighting()},wordsInSection:function(e){e=e.replace(/_+/g,""),e=e.replace(/\[Marker for question [0-9]+\]/g," "),e=e.replace(/\[Sentence [0-9]+\]/g," ");var t=e.split(/\s+/).filter(function(e){return e.length>0});return t.length},compareRanges:function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0},mergeOverlappingRanges:function(e){for(var t=[].concat(e).sort(this.compareRanges),n=[],r=t,i=Array.isArray(r),o=0,r=i?r:r[Symbol.iterator]();;){var s;if(i){if(o>=r.length)break;s=r[o++]}else{if(o=r.next(),o.done)break;s=o.value}var a=s,p=n[n.length-1];p&&a[0]<=p[1]?n[n.length-1]=[p[0],Math.max(p[1],a[1])]:n.push(a)}return n},addHighlightRange:function(){var e=[].concat(this.props.highlightRanges);e.push(this.state.newHighlightRange),e=this.mergeOverlappingRanges(e),this.props.onChange({highlightRanges:e}),this.forceUpdate()},isAnchorFirst:function(e,t,n,r){return e===t?n<r:4===e.compareDocumentPosition(t)},sortIndices:function(e){var t=this.getSelectionIndex(e,"anchor"),n=this.getSelectionIndex(e,"focus"),r=e.anchorNode,i=e.focusNode,o=e.anchorOffset,s=e.focusOffset;return this.isAnchorFirst(r,i,o,s)?{selectionStartIndex:t,selectionEndIndex:n,startNode:r,endNode:i,startNodeOffset:o,endNodeOffset:s}:{selectionStartIndex:n,selectionEndIndex:t,startNode:i,endNode:r,startNodeOffset:s,endNodeOffset:o}},getSelectionRange:function(e){var t=this.sortIndices(e),n=t.selectionStartIndex,r=t.selectionEndIndex,i=t.startNode,o=t.endNode,s=t.startNodeOffset,a=t.endNodeOffset;return null===n||null===r?null:(" "===i.textContent.charAt(s)&&r>n&&(n+=1)," "===o.textContent.charAt(a-1)&&r>n&&(r-=1),[n,r])},isInPassageText:function(e){for(var t=e;t;){if(t.classList&&t.classList.contains("passage-text")){for(;1!==e.nodeType;)e=e.parentNode;return t.contains(e)}t=t.parentNode}return!1},getSelectionIndex:function(e,t){var n=null,r=0,i=".?;:!,'\"";if("anchor"===t?(n=e.anchorNode,r=e.anchorOffset):(n=e.focusNode,r=e.focusOffset),!this.isInPassageText(n))return null;var o=n.textContent;i.indexOf(o.charAt(0))!==-1&&(o=o.slice(1));for(var s=this.charToWordOffset(r,o),a="",p="";n&&(!n.classList||!n.classList.contains("passage-text"));){for(;n.previousSibling;){n=n.previousSibling,p=n.textContent;var l="",u=p.charAt(p.length-1),c=i.indexOf(u)!==-1||!n.nextSibling||"_"===u&&n.nextSibling.textContent.charAt(0).match(/[\w ]/);c&&a.length>0&&(l=" "),a=p+l+a}n=n.parentNode}return s+=this.wordsInSection(a),"_"!==a.charAt(a.length-1)||o.charAt(0).match(/[\w ]/)||(s-=1),s},charToWordOffset:function(e,t){for(;e>0&&" "!==t.charAt(e-1);)e-=1;var n=t.substring(0,e),r=this.wordsInSection(n);return" "===t.charAt(0)&&0===e&&(r-=1),r},handleConfirmHighlightClick:function(){this.setState({newHighlightRange:null}),this.addHighlightRange();var e=window.getSelection();e.collapse(e.anchorNode,e.anchorOffset)},isHighlighted:function(e){for(var t=this.props.highlightRanges,n=t,r=Array.isArray(n),i=0,n=r?n:n[Symbol.iterator]();;){var o;if(r){if(i>=n.length)break;o=n[i++]}else{if(i=n.next(),i.done)break;o=i.value}var s=o;if(e[0]>=s[0]&&e[1]<=s[1])return s}return null},handleMouseDown:function(e){e.target.getAttribute("data-highlighting-tooltip")||this.setState({newHighlightRange:null,selectedHighlightRange:null})},handleMouseUp:function(e){var t=this.state.newHighlightRange||this.state.selectedHighlightRange;if(this.canUpdateHighlighting()&&!t){this.setState({mouseX:e.clientX,mouseY:e.clientY-60});var n=window.getSelection(),r=this.getSelectionRange(n);if(r){var i=this.isHighlighted(r);i?this.setState({newHighlightRange:null,selectedHighlightRange:i}):" "===n.toString()||n.isCollapsed||this.setState({newHighlightRange:r,selectedHighlightRange:null})}}},handleRemoveHighlightClick:function(){var e=this.state.selectedHighlightRange,t=this.props.highlightRanges.findIndex(function(t){return t[0]===e[0]&&t[1]===e[1]}),n=[].concat(this.props.highlightRanges);n.splice(t,1),this.setState({selectedHighlightRange:null}),this.props.onChange({highlightRanges:n})},stringToArrayOfWords:function(e){var t;return e=e.split(" "),e=e.map(function(e){var t=e.match(/\s+/);if(t){var n=t.index+t[0].length;return[e.slice(0,n),e.slice(n)]}return[e]}),e=(t=[]).concat.apply(t,e),e=e.filter(function(e){return""!==e})},adjustIndexforMarkdownAndWhitespace:function(e,t){for(var n=0;n<=e;n++){var r=t[n].match(/^\s+$/)||["{highlighting.end}{highlighting.start}","{highlighting.end}","{highlighting.start}"].includes(t[n]);r&&e++}return e},shouldComponentUpdate:function(e,t){return!p.isEqual(this.props,e)||!p.isEqual(this.state,t)},renderAddHighlightTooltip:function(){var e=this.state.mouseX+"px",t=this.state.mouseY+"px";return s.createElement("span",{onClick:this.handleConfirmHighlightClick,style:{position:"absolute",left:e,top:t}},s.createElement("img",{"data-highlighting-tooltip":!0,width:"130",height:"44",style:{position:"absolute",top:"-54px",left:"-65px"},src:"/images/perseus/add-highlight.svg"}))},renderRemoveHighlightTooltip:function(){var e=this.state.mouseX+"px",t=this.state.mouseY+"px";return s.createElement("span",{onClick:this.handleRemoveHighlightClick,style:{position:"absolute",left:e,top:t}},s.createElement("img",{"data-highlighting-tooltip":!0,width:"163",height:"44",style:{position:"absolute",top:"-54px",left:"-81px"},src:"/images/perseus/remove-highlight.svg"}))},render:function(){var e=this,t=void 0,n=this.state.nLines;this.props.showLineNumbers&&n&&(t=p.range(1,n+1).map(function(t){return 4===t&&n>4?s.createElement("span",{key:"line-marker",className:"line-marker"},"Line"):t+e.state.startLineNumbersAfter}));var r="{highlighting.start}",i="{highlighting.end}";this.props.reviewModeRubric&&(r="{review-highlighting.start}",i="{review-highlighting.end}");var o=this.props.passageText;p.each(this.props.highlightRanges,function(e){o=o.replace(/\n +\n/g,"\n\n"),o=o.replace(/\r\n +\r\n/g,"\r\n\r\n");var t=this.stringToArrayOfWords(o),n=this.adjustIndexforMarkdownAndWhitespace(e[0],t),s=this.adjustIndexforMarkdownAndWhitespace(e[1],t);o=t.slice(0,n).join(" ")+" "+t.slice(n,s+1).map(function(e){var t=new RegExp("[\\(\\)\\â\\-\\â\\-\\â\\.                                            \\[\\]\\+\\$\\?,!A-Za-z0-9                                            Ã-Å¿:;'ââ\"ââ=%<>s]+"),n=e.match(t);if(n){var o=n.index,s=o+n[0].length;return e.slice(0,o)+r+e.slice(o,s)+i+e.slice(s)}return e}).join(r+" "+i)+" "+t.slice(s+1).join(" ")},this);var a={},l=c.parse(o,a);return s.createElement("div",null,s.createElement("div",{onMouseUp:this.handleMouseUp,className:"perseus-widget-passage-container"},this._renderInstructions(a),s.createElement("div",{className:"perseus-widget-passage"},s.createElement("div",{className:"passage-title"},s.createElement(u,{content:this.props.passageTitle})),t&&s.createElement("div",{className:"line-numbers","aria-hidden":!0},t),s.createElement("h3",{className:"perseus-sr-only"},i18n._("Beginning of reading passage.")),s.createElement("div",{className:"passage-text"},this._renderContent(l)),this._hasFootnotes()&&[s.createElement("h4",{key:"footnote-start",className:"perseus-sr-only"},i18n._("Beginning of reading passage footnotes.")),s.createElement("div",{key:"footnotes",className:"footnotes"},this._renderFootnotes())],s.createElement("div",{className:"perseus-sr-only"},i18n._("End of reading passage.")))),this.state.newHighlightRange&&this.renderAddHighlightTooltip(),this.state.selectedHighlightRange&&this.renderRemoveHighlightTooltip())},componentDidMount:function(){this._updateState(),window.addEventListener("mousedown",this.handleMouseDown),this._throttledUpdateState=p.throttle(this._updateState,500),window.addEventListener("resize",this._throttledUpdateState)},componentWillUnmount:function(){window.removeEventListener("mousedown",this.handleMouseDown),window.removeEventListener("resize",this._throttledUpdateState)},componentDidUpdate:function(){this._updateState()},_updateState:function(){this.setState({nLines:this._measureLines(),startLineNumbersAfter:this._getInitialLineNumber()})},_measureLines:function(){var e=$(a.findDOMNode(this.refs.content)),t=e.height(),n=this._getLineHeight(),r=Math.round(t/n);return r},_getInitialLineNumber:function(){var e=this,t=!0,n=this.props.interWidgets(function(n,r){return"passage"===r.type&&(n===e.props.widgetId&&(t=!1),t)});return n.map(function(e){return e.getLineCount()}).reduce(function(e,t){return e+t},0)},getLineCount:function(){return null!=this.state.nLines?this.state.nLines:this._measureLines()},_renderInstructions:function(e){var t=e.firstQuestionRef,n=e.firstSentenceRef,r="";t&&(r+=i18n._("The symbol %(questionSymbol)s indicates that question %(questionNumber)s references this portion of the passage.",{questionSymbol:"[["+t+"]]",questionNumber:t})),n&&(r+=i18n._(" The symbol %(sentenceSymbol)s indicates that the following sentence is referenced in a question.",{sentenceSymbol:"["+n+"]"}));var i=c.parse(r);return s.createElement("div",{className:"perseus-widget-passage-instructions"},c.output(i))},_renderContent:function(e){var t=this;return s.createElement("div",{ref:"content"},s.createElement(h,{ref:function(e){return t._lineHeightMeasurer=e}}),c.output(e))},_hasFootnotes:function(){var e=this.props.footnotes,t=/^\s*$/.test(e);return!t},_renderFootnotes:function(){var e=this.props.footnotes,t=c.parse(e);return c.output(t)},_getStartRefLineNumber:function(e){var t=c.START_REF_PREFIX+e,n=this.refs[t];if(!n)return null;var r=$(a.findDOMNode(n)),i=r.next();0===i.length&&(i=r);var o=i.offset().top;return this.state.startLineNumbersAfter+1+this._convertPosToLineNumber(o)},_getEndRefLineNumber:function(e){var t=c.END_REF_PREFIX+e,n=this.refs[t];if(!n)return null;var r=$(a.findDOMNode(n)),i=r.prev();0===i.length&&(i=r);var o=i.height(),s=i.offset().top,p=this._convertPosToLineNumber(s+o);return 0===o&&(p+=1),this.state.startLineNumbersAfter+p},_getLineHeight:function(){return this._lineHeightMeasurer.measureLineHeight()},_convertPosToLineNumber:function(e){var t=$(a.findDOMNode(this.refs.content)),n=e-t.offset().top,r=this._getLineHeight(),i=Math.round(n/r);return i},_getRefContent:function(e){var t=c.START_REF_PREFIX+e,n=this.refs[t];return n?n.getRefContent():null},getReference:function(e){var t=this._getStartRefLineNumber(e),n=this._getEndRefLineNumber(e);if(null==t||null==n)return null;var r=this._getRefContent(e);return{startLine:t,endLine:n,content:r}},getUserInput:function(){return null},simpleValidate:function(e){return f.validate(this.getUserInput(),e)}});p.extend(f,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),e.exports={name:"passage",displayName:"Passage",widget:f,transform:function(e){return p.pick(e,"passageTitle","passageText","footnotes","showLineNumbers")}}},,function(e,t,n){"use strict";var r=n(10),i=n(9),o=n(80),s=n(93),a=n(8),p=r.createClass({displayName:"PassageRefTarget",mixins:[s,o],propTypes:{content:r.PropTypes.string},getDefaultProps:function(){return{content:""}},render:function(){return r.createElement(a,{content:this.props.content,inline:!0,apiOptions:this.props.apiOptions})},simpleValidate:function(e){return p.validate(this.getUserInput(),e)}});i.extend(p,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),e.exports={name:"passage-ref-target",displayName:"PassageRefTarget",defaultAlignment:"inline",widget:p,hidden:!0,transform:function(e){return i.pick(e,"content")},version:{major:0,minor:0}}},function(e,t,n){"use strict";var r=n(10),i=n(11),o=n(9),s=n(17).ClassNames,a=n(16).deepEq,p=n(78),l=n(97),u=n(102),c=n(94),h=n(96),d="bar",f="line",g="pic",m="histogram",v="dotplot",y=({type:r.PropTypes.oneOf([d,f,g,m,v]),labels:r.PropTypes.arrayOf(r.PropTypes.string),categories:r.PropTypes.arrayOf(r.PropTypes.oneOfType([r.PropTypes.number,r.PropTypes.string])),scaleY:r.PropTypes.number,maxY:r.PropTypes.number,snapsPerLine:r.PropTypes.number,picSize:r.PropTypes.number,pixBoxHeight:r.PropTypes.number,picUrl:r.PropTypes.string,plotDimensions:r.PropTypes.arrayOf(r.PropTypes.number),labelInterval:r.PropTypes.number,starting:r.PropTypes.arrayOf(r.PropTypes.number),static:r.PropTypes.bool},r.createClass({displayName:"Plotter",propTypes:{onChange:r.PropTypes.func.isRequired,trackInteraction:r.PropTypes.func.isRequired},getDefaultProps:function(){return{type:d,labels:["",""],categories:[""],scaleY:1,maxY:10,snapsPerLine:2,picSize:40,picBoxHeight:48,picUrl:"",plotDimensions:[380,300],labelInterval:1}},getInitialState:function(){return{values:this.props.starting||[1]}},DOT_PLOT_POINT_SIZE:function(){return this.props.apiOptions.isMobile?6:4},DOT_PLOT_POINT_PADDING:function(){return 8},DOT_TICK_POINT_SIZE:function(){return 2},render:function(){return r.createElement("div",{className:"perseus-widget-plotter graphie "+s.INTERACTIVE,ref:"graphieDiv"})},componentDidUpdate:function(e,t){this.shouldSetupGraphie&&this.setupGraphie(t)},componentDidMount:function(){this.setupGraphie(this.state)},componentWillReceiveProps:function(e){var t=["type","labels","categories","scaleY","maxY","snapsPerLine","picUrl","labelInterval","static"];this.shouldSetupGraphie=o.any(t,function(t){return!o.isEqual(this.props[t],e[t])},this),o.isEqual(this.props.starting,e.starting)||o.isEqual(this.state.values,e.starting)||(this.shouldSetupGraphie=!0,this.setState({values:e.starting}))},setupGraphie:function(e){
var t=this;t.shouldSetupGraphie=!1;var n=i.findDOMNode(t.refs.graphieDiv);$(n).empty();var r=u.createGraphie(n);t.graphie=r,t.graphie.pics=[],t.graphie.dotTicks=[];var s=t.props.type===d,a=t.props.type===f,c=t.props.type===g,y=t.props.type===m,b=t.props.type===v,T=c||b,P={},x=P,C=this.props.apiOptions.isMobile;x.graph={lines:[],bars:[],points:[],dividers:[]},x.scaleY=t.props.scaleY,x.dimX=t.props.categories.length;var E=C?[288,336]:t.props.plotDimensions;if(a)x.dimX+=C?-.2:1;else if(y)x.barPad=0,x.barWidth=1;else if(s)x.barPad=C?.08:.15,x.barWidth=1-2*x.barPad,x.dimX+=(C?-2:2)*x.barPad;else if(T){x.picBoxHeight=t.props.picBoxHeight,x.picBoxWidthPx=E[0]/t.props.categories.length;var k=E[0]-x.dimX*x.picBoxWidthPx;x.picPad=k/(2*x.dimX+2);var M=x.picBoxWidthPx+2*x.picPad;x.picPad=x.picPad/M,x.picBoxWidth=x.picBoxWidthPx/M,x.dimX+=2*x.picPad}b&&(x.picBoxHeight=2*this.DOT_PLOT_POINT_SIZE()+this.DOT_PLOT_POINT_PADDING()),x.dimY=Math.ceil(t.props.maxY/x.scaleY)*x.scaleY;var w=25,S=25;if((s||a)&&C&&(w=0!==t.props.labels[1].length?17:11),b&&(w/=2),C&&T&&0===t.props.labels[1].length&&(w=0),C?x.scale=o.map([[x.dimX,w],[x.dimY,S]],function(e,t){var n=e[0],r=e[1];return(E[t]-4*r)/n}):x.scale=o.map([x.dimX,x.dimY],function(e,t){return E[t]/e}),w/=x.scale[0],S/=x.scale[1],T&&(x.scale[1]=x.picBoxHeight/x.scaleY),r.init({range:[[-3*w,x.dimX+w],[-3*S,x.dimY+S]],scale:x.scale,isMobile:this.props.apiOptions.isMobile}),r.addMouseLayer({allowScratchpad:!0,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable}),!T)for(var I=C?x.scaleY:0,N=I;N<=x.dimY;N+=x.scaleY)r.label([0,N],p.roundToApprox(N,2),"left",!0),r.style({stroke:C?"#e9ebec":"#000",strokeWidth:1,opacity:C?1:.3},function(){r.line([0,N],[x.dimX,N])});(s||a)&&C&&(t.graphie.dragPrompt=r.label([x.dimX/2,x.dimY/2],"Drag handles to make graph","center",!1).css("font-weight","bold").css("color",l.KA_GREEN).css("display","none")),t.setupCategories(P),T&&C&&(t.graphie.dotPrompt=r.label([x.dimX/2,x.dimY/2],"Tap to add points","center",!1).css("font-weight","bold").css("color",l.KA_GREEN).css("display","none")),T&&t.drawPicHeights(t.state.values,e.values),r.style({stroke:"#000",strokeWidth:2,opacity:1},function(){T?b?r.style({stroke:C?l.GRAY_G:"#000",strokeWidth:C?1:2},function(){return r.line([C?0:.5,0],[x.dimX-(C?0:.5),0])}):(r.line([0,0],[x.dimX,0]),0===t.props.labels[1].length&&C||r.style({stroke:C?l.GRAY_G:"#000",strokeWidth:C?1:2},function(){return r.line([0,0],[0,x.dimY])})):(r.style({stroke:C?l.GRAY_G:"#000",strokeWidth:C?1:2},function(){return r.line([C?3*-w:0,0],[x.dimX+(C?w:0),0])}),(s||a)&&C||r.style({stroke:C?l.GRAY_G:"#000",strokeWidth:C?1:2},function(){return r.line([0,0],[0,x.dimY])}))}),r.label([x.dimX/2,C?3*-S:-35/x.scale[1]],t.props.labels[0],C?"above":"below",!1).css("font-weight","bold").css("color",C&&l.GRAY_F),r.label([(C?-35:-60)/x.scale[0],x.dimY/2],t.props.labels[1],"center",!1).css("font-weight","bold").css("color",C&&l.GRAY_F).addClass("rotate"),this.props.apiOptions.isMobile&&(this.horizHairline=new h(this.graphie,[0,0],[0,0],{normalStyle:{strokeWidth:1}}),this.horizHairline.attr({stroke:l.INTERACTIVE}),this.horizHairline.hide(),this.hairlineRange=[[0,x.dimX],[0,x.dimY]])},showHairlines:function(e){this.props.apiOptions.isMobile&&"none"!==this.props.markings&&(this.horizHairline.moveTo([this.hairlineRange[0][0],e[1]],[this.hairlineRange[0][1],e[1]]),this.horizHairline.show())},hideHairlines:function(){this.props.apiOptions.isMobile&&this.horizHairline.hide()},labelCategory:function(e,t){var n=this.props.apiOptions.isMobile,r=this.graphie;t+="";var i=!1,o=t.match(/^\$(.*)\$$/);o&&(t=o[1],i=!0);var s=(0!==this.props.labels[0].length,"translateX(-50%) translateX(5px) translateY(-50%) rotate(-45deg)");r.style({color:n?l.GRAY_G:"inherit",transform:n&&!o?s:"none",transformOrigin:"100%"},function(){return r.label([e,n?-.5:0],t,"below",i)})},setupCategories:function(e){var t=this,n=e,r=t.graphie,i=this.props.apiOptions.isMobile;t.props.type===m?(o.times(t.props.categories.length-1,function(n){t.setupBar({index:n,startHeight:t.state.values[n],config:e,isHistogram:!0})}),o.each(t.props.categories,function(e,o){var s=.5+o*n.barWidth;t.labelCategory(s,e);var a=6/n.scale[1];r.style({stroke:"#000",strokeWidth:i?1:2,opacity:1},function(){r.line([s,-a],[s,0])})})):o.each(t.props.categories,function(o,s){var a,p=t.state.values[s];t.props.type===d?a=t.setupBar({index:s,startHeight:p,config:e,isHistogram:!1}):t.props.type===f?a=t.setupLine(s,p,e):t.props.type===g?a=t.setupPic(s,e):t.props.type===v&&(a=t.setupDotplot(s,e));var u=0,c=-6/n.scale[1];t.props.type!==v||i||(u=-c),t.props.type===v?s%t.props.labelInterval!==0&&s!==t.props.categories.length-1||(t.labelCategory(a,o),u*=1.5,c*=1.5):t.labelCategory(a,o),r.style({stroke:i?l.GRAY_G:"#000",strokeWidth:i?1:2,opacity:1},function(){r.line([a,u],[a,c])})})},_clampValue:function(e,t,n){return Math.max(Math.min(e,n),t)},_updateDragPrompt:function(e){var t=e.every(function(e){return 0===e});this.graphie.dragPrompt[0].style.display=t?"inline":"none"},setupBar:function(e){var t,n=this,r=this.props.apiOptions.isMobile,i=e.index,s=e.startHeight,a=e.config,p=e.isHistogram,u=this,h=u.graphie,d=a.barWidth/2;t=p?.5+i*a.barWidth+d:(r?d:.5+a.barPad)+i;var f=function(e,t){var n=h.scalePoint(0);if(a.graph.bars[e].scale(1,Math.max(r?.2:.01,t/a.scaleY),n[0],n[1]),p){var i=a.graph.dividers[e-1],o=a.graph.dividers[e];if(i){var s=Math.min(u.state.values[e-1],t);i.scale(1,Math.max(.01,s/a.scaleY),n[0],n[1])}if(o){var s=Math.min(u.state.values[e+1],t);o.scale(1,Math.max(.01,s/a.scaleY),n[0],n[1])}}};return h.style({stroke:"none",fill:r?l.BLUE_C:l.LIGHT_BLUE,opacity:1},function(){a.graph.bars[i]=h.path([[t-d,0],[t-d,a.scaleY],[t+d,a.scaleY],[t+d,0],[t-d,0]])}),p&&i>0&&h.style({stroke:"#000",strokeWidth:1,opacity:.3},function(){a.graph.dividers.push(h.path([[t-d,0],[t-d,a.scaleY]]))}),r?!function(){var e=a.scaleY/u.props.snapsPerLine;a.graph.lines[i]=c.addMaybeMobileMovablePoint(n,{coord:[t,s],constraints:[function(r,i,o){return[t,n._clampValue(Math.round(r[1]/e)*e,0,a.dimY)]}],onMoveStart:function(){a.graph.bars[i].attr({fill:l.INTERACTIVE})},onMove:function(){var e=a.graph.lines[i].coord()[1],t=o.clone(u.state.values);t[i]=e,u.setState({values:t}),u.changeAndTrack({values:t}),u._updateDragPrompt(t),f(i,e)},onMoveEnd:function(){a.graph.bars[i].attr({fill:l.BLUE_C})}}),a.graph.lines[i].state.visibleShape.wrapper.style.zIndex="1",u._updateDragPrompt(u.state.values)}():(a.graph.lines[i]=h.addMovableLineSegment({coordA:[t-d,s],coordZ:[t+d,s],snapY:a.scaleY/u.props.snapsPerLine,constraints:{constrainX:!0},normalStyle:{stroke:l.INTERACTIVE,"stroke-width":this.props.static?0:4}}),a.graph.lines[i].onMove=function(e,t){var n=this.coordA[1];(n<0||n>a.dimY)&&(n=Math.min(Math.max(n,0),a.dimY),this.coordA[1]=this.coordZ[1]=n,this.transform());var r=o.clone(u.state.values);r[i]=n,u.setState({values:r}),u.changeAndTrack({values:r}),f(i,n)}),f(i,s),t},setupLine:function(e,t,n){var r=this,i=this.props.apiOptions.isMobile,s=this,a=n,p=s.graphie,u=e+(i?.4:1);return i?!function(){var i=n.scaleY/s.props.snapsPerLine;a.graph.points[e]=c.addMaybeMobileMovablePoint(r,{coord:[u,t],constraints:[function(e,t,o){return[u,r._clampValue(Math.round(e[1]/i)*i,0,n.dimY)]}],onMove:function(){var t=a.graph.points[e].coord()[1],n=o.clone(s.state.values);n[e]=t,s.setState({values:n}),s.changeAndTrack({values:n}),s._updateDragPrompt(n)}}),s._updateDragPrompt(s.state.values),e>0&&(a.graph.lines[e]=c.addMovableLine(p,{points:[a.graph.points[e-1],a.graph.points[e]],constraints:c.MovablePoint.constraints.fixed(),normalStyle:{stroke:l.BLUE_C,"stroke-width":2},highlightStyle:{stroke:l.BLUE_C,"stroke-width":2}}))}():(a.graph.points[e]=p.addMovablePoint({coord:[u,t],constraints:{constrainX:!0},normalStyle:{fill:l.INTERACTIVE,stroke:l.INTERACTIVE},snapY:a.scaleY/s.props.snapsPerLine}),a.graph.points[e].onMove=function(t,n){n=Math.min(Math.max(n,0),a.dimY);var r=o.clone(s.state.values);return r[e]=n,s.setState({values:r}),s.changeAndTrack({values:r}),[t,n]},e>0&&(a.graph.lines[e]=p.addMovableLineSegment({pointA:a.graph.points[e-1],pointZ:a.graph.points[e],constraints:{fixed:!0},normalStyle:{stroke:"#9ab8ed","stroke-width":2}}))),u},setupDotplot:function(e,t){var n=this,r=this.graphie,i=this.props.apiOptions.isMobile;return this.setupTiledPlot(e,i?.5:1,t,function(e,t){return r.ellipse([e,t],[n.DOT_PLOT_POINT_SIZE()/r.scale[0],n.DOT_PLOT_POINT_SIZE()/r.scale[1]],{fill:l.INTERACTIVE,stroke:l.INTERACTIVE})})},setupPic:function(e,t){var n=this,r=this.graphie;return this.setupTiledPlot(e,0,t,function(e,t){var i=r.scalePoint([e,t]),o=n.props.picSize;return r.raphael.image(n.props.picUrl,i[0]-o/2,i[1]-o/2,o,o)})},setupTiledPlot:function(e,t,n,r){var i=this,s=n,a=i.graphie,p=a.pics,l=a.dotTicks,u=e+.5+s.picPad;p[e]=[],l[e]=[];var c=Math.round(s.dimY/s.scaleY)+1;return o(c).times(function(n){n-=1;var o=(n+.5)*s.scaleY,c=u-s.picBoxWidth/2,h=o+.5*s.scaleY,d=a.scalePoint([c,h+t]),f=a.mouselayer.rect(d[0],d[1],s.picBoxWidthPx,s.picBoxHeight);$(f[0]).css({fill:"#000",opacity:0,cursor:"pointer"}).on("vmousedown",function(n){n.preventDefault(),i.whichPicClicked=e,i.setPicHeight(e,h),$(document).on("vmouseup.plotTile",function(e){$(document).unbind(".plotTile")}),$(document).on("vmousemove.plotTile",function(e){e.preventDefault();var n=a.getMouseCoord(e)[1],r=Math.floor(n-t),o=Math.max(-1,Math.floor(r/s.scaleY)),p=(o+.5)*s.scaleY,l=p+.5*s.scaleY;i.setPicHeight(i.whichPicClicked,l)})}),n<0||(p[e][n]=r(u,o+t),l[e][n]=a.ellipse([u,o+t],[i.DOT_TICK_POINT_SIZE()/a.scale[0],i.DOT_TICK_POINT_SIZE()/a.scale[1]],{fill:"#dee1e3",stroke:"#dee1e3"}))}),u},setPicHeight:function(e,t){var n=o.clone(this.state.values);n[e]=t,this.drawPicHeights(n,this.state.values),this.setState({values:n}),this.changeAndTrack({values:n})},changeAndTrack:function(e){this.props.onChange(e),this.props.trackInteraction()},drawPicHeights:function(e,t){var n=this,r=n.graphie,i=r.pics,s=this.props.apiOptions.isMobile;if(s){var a=e.every(function(e){return 0===e});r.dotPrompt[0].style.display=a?"inline":"none"}o.each(i,function(i,a){o.each(i,function(i,o){var p=(o+1)*n.props.scaleY,l=p<=e[a];if(n.props.type===v){var u=p<=t[a],c=l&&!u;c&&i.animate({"stroke-width":8},75,function(){return i.animate({"stroke-width":2},75)})}$(i[0]).css({display:l?"inline":"none"}),r.dotTicks[a][o][0].style.display=l||!s?"none":"inline"})})},getUserInput:function(){return this.state.values},simpleValidate:function(e){return y.validate(this.getUserInput(),e)}}));o.extend(y,{validate:function(e,t){return a(e,t.starting)?{type:"invalid",message:null}:{type:"points",earned:a(e,t.correct)?1:0,total:1,message:null}}});var b=o.identity;e.exports={name:"plotter",displayName:"Plotter",widget:y,staticTransform:b}},function(e,t,n){"use strict";var r=n(10),i=n(55).molecule,o=r.createClass({displayName:"Separator",propTypes:{data:r.PropTypes.any,index:r.PropTypes.number},componentDidMount:function(){this.drawArrow()},componentDidUpdate:function(){this.drawArrow()},arrowLength:100,drawArrow:function(){var e=this.refs["arrowCanvas"+this.props.index],t=e.getContext("2d");t.clearRect(0,0,e.width,e.height);var n=new Path2D;t.strokeStyle="rgb(0,0,0)",t.lineWidth=1.2,t.lineCap="round";var r=5;n.moveTo(r,e.height/2),n.lineTo(e.width-r,e.height/2),n.moveTo(e.width-2*r,e.height/2-r),n.lineTo(e.width-r,e.height/2),n.moveTo(e.width-2*r,e.height/2+r),n.lineTo(e.width-r,e.height/2),t.stroke(n)},render:function(){return r.createElement("div",{className:"arrow-container"},r.createElement("div",{className:"above-text"},this.props.data.topText),r.createElement("canvas",{height:"30",id:"arrowCanvas"+this.props.index,ref:"arrowCanvas"+this.props.index,width:this.arrowLength},"Reaction arrow pointing to the right."),r.createElement("div",{className:"below-text"},this.props.data.bottomText))}}),s=r.createClass({displayName:"ReactionDiagramWidget",propTypes:{rotationAngle:r.PropTypes.arrayOf(r.PropTypes.number),separators:r.PropTypes.arrayOf(r.PropTypes.object),smiles:r.PropTypes.arrayOf(r.PropTypes.string),widgetId:r.PropTypes.string},getDefaultProps:function(){return{smiles:[],rotationAngle:[],separators:[]}},simpleValidate:function(){return{type:"points",earned:0,total:0,message:null}},getUserInput:function(){return[]},validate:function(e,t){return{type:"points",earned:0,total:0,message:null}},focus:function(){return!0},render:function(){var e=this;return r.createElement("div",{className:"reaction",ref:"reaction"},this.props.smiles.map(function(t,n){var s=e.props.widgetId+"-"+n;return r.createElement("div",{key:s,className:"molecule-container"},r.createElement(i,{id:s,rotationAngle:e.props.rotationAngle[n],smiles:t}),n===e.props.smiles.length-1?null:r.createElement(o,{data:e.props.separators[n],index:n}))}))}});e.exports={name:"reaction-diagram",displayName:"Chemical reaction",hidden:!1,widget:s}},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(10),o=n(9),s=n(17).Options,a=n(80),p=n(84),l=p.iconOk,u=n(81),c=n(8),h=n(16),d=i.createClass({displayName:"Sequence",mixins:[a],propTypes:{apiOptions:s.propTypes,json:i.PropTypes.arrayOf(i.PropTypes.shape({content:i.PropTypes.string,images:i.PropTypes.object,widgets:i.PropTypes.object})),trackInteraction:i.PropTypes.func.isRequired},getDefaultProps:function(){return{json:[{content:"",widgets:{},images:{}}]}},getInitialState:function(){return{visible:1}},shouldComponentUpdate:function(e,t){return e!==this.props||t!==this.state},render:function(){var e=this,t=i.createElement(u,r({},l,{style:{color:"green"}})),n=o.chain(this.props.json).first(this.state.visible).map(function(e,t){return"[["+h.snowman+" group "+t+"]]"}).join("\n\n").value(),s={};return o.each(this.props.json,function(n,r){var i="group "+r;s[i]={type:"group",graded:!0,version:{major:0,minor:0},options:o.extend({},n,{icon:r<e.state.visible-1?t:null})}}),i.createElement("div",{className:"perseus-sequence"},i.createElement(c,{ref:"renderer",content:n,widgets:s,onInteractWithWidget:this._handleInteraction,apiOptions:this.props.apiOptions}))},_handleInteraction:function(e){var t=parseInt(e.split(" ")[1]);if(t===this.state.visible-1){var n=this.refs.renderer.getWidgetInstance("group "+t),r=n.simpleValidate();"points"===r.type&&r.total===r.earned&&(this.setState({visible:this.state.visible+1}),this.props.trackInteraction({visible:this.state.visible+1}))}}}),f=function(e,t){var n=e.json;o.isArray(n)||(n=[n]);var r=o.map(n,function(e){return t(e)});return o.extend({},e,{json:r})};e.exports={name:"sequence",displayName:"Graded Sequence",widget:d,traverseChildWidgets:f,tracking:"all"}},function(e,t,n){"use strict";var r=n(100),i=n(10),o=n(11),s=n(9),a=n(80),p=n(17).Options,l=n(105).assert,u=n(86),c=u.Path,h=u.Arc,d=(u.Circle,u.Label),f=u.Line,g=u.MovablePoint,m=u.MovableLine,v=n(101),y=n(104),b=(n(16).seededRNG,n(16)),T=n(123).number,P=n(97),x=n(78),C=400,E=1e3,k=i.createClass({displayName:"Histogram",propTypes:{data:i.PropTypes.arrayOf(i.PropTypes.number),xAxisLabel:i.PropTypes.string,yAxisLabel:i.PropTypes.string,box:i.PropTypes.arrayOf(i.PropTypes.number)},getDefaultProps:function(){return{data:null,xAxisLabel:"Proportion (%)",yAxisLabel:"Number of times seen",box:[C,C]}},getInitialState:function(){return{threshold:this._getInitialThreshold(this._range())}},componentWillReceiveProps:function(e){var t=this._range(),n=this._range(e);b.deepEq(t,n)||this.setState({threshold:this._getInitialThreshold(n)})},_renderThresholdLine:function(){var e=this,t=[0,this._range()[1][1]],n=s.map(t,function(t){return[e.state.threshold,t]}),r=function(e,t){return i.createElement(g,{key:t,static:!0,coord:e,normalStyle:{stroke:"none",fill:"none"}})};return i.createElement(m,{onMove:this.handleMouseInteraction},s.map(n,r))},_renderCircle:function(){var e=this,t=this.props.data,n=s.reduce(t,function(e,t){return e+t},0),r=s.reduce(t,function(t,n,r){return null!=e.state.threshold&&r<=e.state.threshold?t+n:t},0),o=r/n,a=1e-5,p=20,l=[this.props.box[0]-1.5*p,1.5*p],u=function(){var e={key:"below",center:l,radius:p,startAngle:0,endAngle:o<1?360*o:360-a,sector:1!==o,unscaled:!0,style:{fill:P.LIGHT_RED,stroke:P.RED}};return i.createElement(h,e)},c=function(){var e={key:"above",center:l,radius:p,startAngle:o>0?360*o:a,endAngle:360,sector:0!==o,unscaled:!0,style:{fill:P.LIGHT_BLUE,stroke:P.BLUE}};return i.createElement(h,e)},f=this._range()[0],g=Math.min(Math.max(this.state.threshold,f[0]),f[1]).toFixed(2),m=function(){var e={key:"label",coord:[l[0],l[1]+1.5*p],text:r+" of "+n+" results below "+g+"%",direction:"center",tex:!1,unscaled:!0,style:{fontSize:"12px"}};return i.createElement(d,e)};return[o>0&&u(),o<1&&c(),m()]},_renderData:function(){var e=this,t=this.props.data,n=(this._range(),1),r=function(t,r){if(t){var o=null!=e.state.threshold&&r<=e.state.threshold,s={fill:o?P.LIGHT_RED:P.LIGHT_BLUE,stroke:o?P.RED:P.BLUE},a=[[r,0],[r,t],[r+n,t],[r+n,0]];return i.createElement(c,{key:r,coords:a,style:s})}};return s.map(t,r)},render:function(){var e=this.props.data,t=this._range(),n={xAxisLabel:this.props.xAxisLabel,yAxisLabel:this.props.yAxisLabel,box:this.props.box,range:t,data:e,scale:[b.scaleFromExtent(t[0],this.props.box[0]),b.scaleFromExtent(t[1],this.props.box[1])]},r={stroke:"#000",strokeWidth:1,opacity:1},o=[t[0][0],0],s=[t[0][1],0];return i.createElement(u,{box:n.box,range:n.range,options:n,setup:this._setupGraphie,onMouseMove:this.handleMouseInteraction,onMouseDown:this.handleMouseInteraction,setDrawingAreaAvailable:this.props.setDrawingAreaAvailable},i.createElement(f,{start:o,end:s,style:r}),e&&this._renderData(),e&&this._renderCircle(),e&&this._renderThresholdLine())},_setupGraphie:function(e,t){var n=t.data,r=t.range,i=t.scale,o=r[0][1]-r[0][0],a=r[1][1]-0,p=20,l=Math.ceil(a/p);if(s.each(s.range(0,r[1][1],l),function(t){n&&e.label([r[0][0],t],x.roundToApprox(t,2),"left",!0),e.line([r[0][0],t],[r[0][1],t],{stroke:"#000",strokeWidth:1,opacity:.3})}),n){var u=15,c=Math.ceil(o/u);s.each(s.range(r[0][0],r[0][1],c),function(t){e.label([t,0],T.round(t,2),"below",!0);var n=8;e.line([t,0],[t,-n/i[1]],{stroke:"#000",strokeWidth:1})})}var h={stroke:"#000",strokeWidth:2,opacity:1},d=[r[0][0],0],f=[r[0][0],r[1][1]];e.line(d,f,h);var g=r[0][0]+o/2,m=n?25:0;e.label([g,-m/i[1]],t.xAxisLabel,"below",!1).css("font-weight","bold");var v=0+a/2,y=n?55:28;e.label([r[0][0]-y/i[0],v],t.yAxisLabel,"center",!1).css("font-weight","bold").css("-webkit-transform","rotate(-90deg)")},handleMouseInteraction:function(e){this.setState({threshold:e[0]})},_range:function(e){var t=[[0,100],[-1,10]];return e=e||this.props,e.data?this._getRangeForData(e.data):t},_getRangeForData:function(e){var t=10,n=s.indexOf(e,s.find(e,function(e){return e>0})),r=Math.max(0,n-t),i=s.lastIndexOf(e,s.last(s.filter(e,function(e){return e>0}))),o=Math.min(101,i+1+t),a=-1,p=s.max(e);return[[r,o],[a,p]]},_getInitialThreshold:function(e){var t=e[0];return t[0]+(t[1]-t[0])/3}}),M=i.createClass({displayName:"Simulator",mixins:[a],propTypes:{apiOptions:p.propTypes,data:i.PropTypes.arrayOf(i.PropTypes.number),numTrials:i.PropTypes.number,proportionLabel:i.PropTypes.string,proportionOrPercentage:i.PropTypes.string,randomSeed:i.PropTypes.number,sampleSize:i.PropTypes.number,trackInteraction:i.PropTypes.func.isRequired,userProportion:i.PropTypes.number,xAxisLabel:i.PropTypes.string,yAxisLabel:i.PropTypes.string},getInitialState:function(){return{invalidInput:!1}},getDefaultProps:function(){return{data:null,userProportion:null,sampleSize:null,numTrials:null,randomSeed:0,xAxisLabel:"Proportion (%)",yAxisLabel:"Number of times seen",proportionLabel:"Underlying proportion",proportionOrPercentage:"proportion",apiOptions:p.defaults}},componentWillMount:function(){null!=this.props.randomSeed&&(this.generateNumber=b.seededRNG(this.props.randomSeed))},componentWillReceiveProps:function(e){e.randomSeed!==this.props.randomSeed&&(this.generateNumber=b.seededRNG(e.randomSeed))},render:function(){var e=this,t={marginLeft:"5px"},n="0px 0px 0px 2px rgba(255, 165, 0, 1)",o=s.extend({},t,{WebkitBoxShadow:n,MozBoxShadow:n,boxShadow:n,transition:"all 0.15s"}),a=s.extend({},t,{transition:"all 0.15s"}),p=this.state.invalidInput?o:a,l=this.props.apiOptions.staticRender?y:v,u=i.createElement("div",null,i.createElement(l,{ref:"userProportion",style:p,value:this.calculateDisplayProportion(),checkValidity:this.checkProportionValidity,disabled:this.props.apiOptions.readOnly,onChange:this.handleUserProportionChange,onFocus:function(){return e.props.onFocus(["userProportion"])},onBlur:function(){return e.props.onBlur(["userProportion"])}}),i.createElement(r,null,i.createElement("p",null,"This controls the proportion or percentage that will be used in your simulation."))),c=i.createElement("div",null,i.createElement(l,{ref:"sampleSize",style:p,value:this.props.sampleSize,checkValidity:function(e){return e>=0},disabled:this.props.apiOptions.readOnly,onChange:this.handleSampleSizeChange,onFocus:function(){return e.props.onFocus(["sampleSize"])},onBlur:function(){return e.props.onBlur(["sampleSize"])}}),i.createElement(r,null,i.createElement("p",null,"This controls the sample size that will be used in your simulation. For example, if you set this to 100, then for each trial, responses from 100 participants will be simulated."))),h=i.createElement("div",{style:{textAlign:"right"}},i.createElement("b",null,this.props.numTrials),i.createElement(r,null,i.createElement("p",null,"This is the number of trials used in the simulation. For example, if set to 50, then the survey will be conducted 50 times."))),d=function(e){var t=i.createElement("thead",null,i.createElement("tr",null,i.createElement("th",null,"Parameter"),i.createElement("th",null,"Value"))),n=i.createElement("tbody",null,s.map(e,function(e,t){return i.createElement("tr",{key:t},i.createElement("td",null,e.title),i.createElement("td",null,e.value))}));return i.createElement("table",null,t,n)},f=[{title:this.props.proportionLabel+":",value:u},{title:"Sample size:",value:c},{title:"Number of trials:",value:h}],g={margin:"20px 0"},m=i.createElement("button",{className:"simple-button",style:g,disabled:this.props.apiOptions.readOnly,onClick:this.handleRunSimulation},i18n._("Run simulation")),b={paddingBottom:this.props.data?40:0},T=i.createElement("div",{style:b},i.createElement(k,{data:this.props.data,xAxisLabel:this.props.xAxisLabel,yAxisLabel:this.props.yAxisLabel,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable}));return i.createElement("div",null,d(f),m,T)},calculateDisplayProportion:function(){var e=this.props.userProportion;return"percentage"===this.props.proportionOrPercentage?Math.round(100*e):e},checkProportionValidity:function(e){return e>=0&&"proportion"===this.props.proportionOrPercentage&&e<=1||"percentage"===this.props.proportionOrPercentage&&e<=100},handleUserProportionChange:function(e,t){var n;n="percentage"===this.props.proportionOrPercentage?e/100:e,null!=n&&(n=Math.min(1,Math.max(0,n))),this.props.onChange({userProportion:n},t)},handleSampleSizeChange:function(e,t){null!=e&&(e=Math.min(E,Math.max(0,Math.floor(e)))),this.props.onChange({sampleSize:e},t)},handleRunSimulation:function(){return null==this.props.numTrials||null==this.props.userProportion||null==this.props.sampleSize?void this.setState({invalidInput:!0}):(this.setState({invalidInput:!1}),this.props.onChange({data:this.generateData()}),void this.props.trackInteraction())},generateData:function(e){var t=this;e=e||this.props;var n=function(e,n,r){var i=function(){return t.generateNumber()<r},o=s.times(101,function(){return 0});return s.times(n,function(){var t=s.times(e,i),n=s.filter(t,s.identity).length,r=Math.floor(100*n/e);o[r]++}),o};return n(e.sampleSize,e.numTrials,e.userProportion)},getInputPaths:function(){return[["userProportion"],["sampleSize"]]},focus:function(){var e=s.head(this.getInputPaths());return this.focusInputPath(e),!0},focusInputPath:function(e){l(e.length>0);var t=s.head(e),n=this.refs[t];n.focus()},blurInputPath:function(e){l(e.length>0);var t=s.head(e),n=this.refs[t];n.blur()},getDOMNodeForPath:function(e){l(e.length>0);var t=s.head(e);return o.findDOMNode(this.refs[t])},getGrammarTypeForPath:function(e){return l(e.length>0),"number"},setInputValue:function(e,t,n){l(e.length>0);var r=s.head(e),i=r.charAt(0).toUpperCase()+r.slice(1),o="handle"+i+"Change";this[o](t,n)},getUserInput:function(){return null},simpleValidate:function(e){return M.validate(this.getUserInput(),e)}});s.extend(M,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}});var w=function(e){var t=s.clone(e);return t.randomSeed=e.problemNum,t};e.exports={name:"simulator",displayName:"Simulator",widget:M,transform:w}},function(e,t,n){"use strict";var r=n(10),i=n(9),o=n(106),s=n(17).Options,a=n(16).shuffle,p="horizontal",l="vertical",u=r.createClass({displayName:"Sorter",propTypes:{apiOptions:s.propTypes,correct:r.PropTypes.array,layout:r.PropTypes.oneOf([p,l]),onChange:r.PropTypes.func,padding:r.PropTypes.bool,problemNum:r.PropTypes.number,trackInteraction:r.PropTypes.func.isRequired},getDefaultProps:function(){return{correct:[],layout:p,padding:!0,problemNum:0,onChange:function(){}}},render:function(){var e=a(this.props.correct,this.props.problemNum,!0),t=this.props.apiOptions.isMobile?8:5;return r.createElement("div",{className:"perseus-widget-sorter perseus-clearfix"},r.createElement(o,{options:e,layout:this.props.layout,margin:t,padding:this.props.padding,onChange:this.handleChange,ref:"sortable"}))},handleChange:function(e){this.props.onChange(e),this.props.trackInteraction()},getUserInput:function(){return{options:this.refs.sortable.getOptions()}},simpleValidate:function(e){return u.validate(this.getUserInput(),e)}});i.extend(u,{validate:function(e,t){var n=i.isEqual(e.options,t.correct);return{type:"points",earned:n?1:0,total:1,message:null}}}),e.exports={name:"sorter",displayName:"Sorter",widget:u}},function(e,t,n){"use strict";var r=n(10),i=n(11),o=n(9),s=n(104),a=n(8),p=n(16),l=n(17).Options,u=n(70),c=n(105).assert,h=function(e,t){return[""+e,""+t]},d=function(){return h(0,0)},f=function(e){return c(o.isArray(e)&&2===e.length),+e[0]},g=function(e){return c(o.isArray(e)&&2===e.length),+e[1]},m=function(e){var t=f(e),n=g(e);return"answer"+t+","+n},v=r.createClass({displayName:"Table",propTypes:{answers:r.PropTypes.arrayOf(r.PropTypes.arrayOf(r.PropTypes.string)),editableHeaders:r.PropTypes.bool,Editor:r.PropTypes.func,headers:r.PropTypes.arrayOf(r.PropTypes.string),trackInteraction:r.PropTypes.func.isRequired},getDefaultProps:function(){var e=4,t=1,n=o(e).times(function(){return p.stringArrayOfSize(t)});return{apiOptions:l.defaults,headers:[""],editableHeaders:!1,rows:e,columns:t,answers:n}},_getRows:function(){return this.props.answers.length},_getColumns:function(){return this.props.answers[0].length},render:function(){var e,t=this,n=this._getRows(),i=this._getColumns(),p=this.props.headers;return e=this.props.apiOptions.staticRender?s:"input",r.createElement("table",{className:"perseus-widget-table-of-values non-markdown"},r.createElement("thead",null,r.createElement("tr",null,o.map(p,function(e,n){return t.props.editableHeaders?r.createElement("th",{key:n},r.createElement(t.props.Editor,{ref:"columnHeader"+n,apiOptions:t.props.apiOptions,content:e,widgetEnabled:!1,onChange:o.partial(t.onHeaderChange,n)})):r.createElement("th",{key:n},r.createElement(a,{content:e}))}))),r.createElement("tbody",null,o(n).times(function(n){return r.createElement("tr",{key:n},o(i).times(function(i){return r.createElement("td",{key:i},r.createElement(e,{ref:m(h(n,i)),type:"text",value:t.props.answers[n][i],disabled:t.props.apiOptions.readOnly,onFocus:o.partial(t._handleFocus,h(n,i)),onBlur:o.partial(t._handleBlur,h(n,i)),onChange:o.partial(t.onValueChange,n,i)}))}))})))},getUserInput:function(){return o.map(this.props.answers,o.clone)},onValueChange:function(e,t,n){var r=o.map(this.props.answers,o.clone);r[e][t]=n.target.value,this.props.onChange({answers:r}),this.props.trackInteraction()},onHeaderChange:function(e,t){var n=this.props.headers.slice();n[e]=t.content,this.props.onChange({headers:n})},simpleValidate:function(e){return v.validate(this.getUserInput(),e)},_handleFocus:function(e){this.props.onFocus(e)},_handleBlur:function(e){this.props.onBlur(e)},focus:function(){return this.focusInputPath(d()),!0},focusInputPath:function(e){var t=m(e),n=this.refs[t];this.props.apiOptions.staticRender?n.focus():i.findDOMNode(n).focus()},blurInputPath:function(e){var t=m(e),n=this.refs[t];this.props.apiOptions.staticRender?n.blur():i.findDOMNode(n).blur()},getDOMNodeForPath:function(e){var t=m(e);return i.findDOMNode(this.refs[t])},getInputPaths:function(){var e=this._getRows(),t=this._getColumns(),n=[];return o(e).times(function(e){o(t).times(function(t){var r=h(e,t);n.push(r)})}),n},getGrammarTypeForPath:function(e){return"number"},setInputValue:function(e,t,n){var r=f(e),i=g(e),s=o.map(this.props.answers,o.clone);s[r][i]=t,this.props.onChange({answers:s},n)}});o.extend(v,{validate:function(e,t){var n=function(e){return o.filter(e,function(e){return o.some(e,o.identity)})},r=n(t.answers),i=n(e),s=o.some(i,function(e){return o.some(e,function(e){return""===e})});if(s||!i.length)return{type:"invalid",message:null};if(i.length!==r.length)return{type:"points",earned:0,total:1,message:null};var a=u.number.createValidatorFunctional,p=null,l=o.every(r,function(e){var t;for(t=0;t<i.length;t++){var n=i[t],r=o.every(n,function(t,n){var r=e[n],i=a(r,{simplify:!0}),o=i(t);return o.message&&(p=o.message),o.correct});if(r)return i.splice(t,1),!0}return!1});return{type:"points",earned:l?1:0,total:1,message:p}}});var y=function(e){var t=e.answers.length,n=e.answers[0].length,r=o(t).times(function(){return p.stringArrayOfSize(n)});return o.extend({},e,{answers:r})};e.exports={name:"table",displayName:"Table of values",accessible:!0,widget:v,transform:y}},function(e,t,n){"use strict";function r(e,t){return m.object(m.map(e,function(e,n){return[n,e[t]]}))}function i(e){return e.constraints.fixed?z.DYNAMIC:z.INTERACTIVE}function o(e,t){var n=t[0][1]-t[0][0],r=t[1][1]-t[1][0];return e*Math.max(n,r)/20}function s(e,t,n){var r=G.subtract(e,t),i=G.scale(r,n),o=G.add(t,i);return o}function a(e){return String(H.roundTo(9,e))}function p(e){var t=H.toFraction(e,L.DEFAULT_TOLERANCE);return 1===t[1]?a(e):a(t[0])+"/"+a(t[1])}function l(e){return[f.createElement(P,null,"("),a(e[0]),f.createElement(P,null,", {}"),a(e[1]),f.createElement(P,null,")")]}function u(e){return[f.createElement(P,null,"\\langle"),a(e[0]),f.createElement(P,null,", {}"),a(e[1]),f.createElement(P,null,"\\rangle")]}function c(e){return a(e)+M}function h(e,t){return e=m.clone(e).sort(U.compare),t=m.clone(t).sort(U.compare),m.all(m.map(e,function(e,n){var r=t[n];return U.equal(e,r)}))}var d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=n(10),g=n(11),m=n(9),v=n(99),y=n(81),b=n(101),T=n(104),P=n(38),x=n(75),C=n(17).Options,E=n(73).propTypes.keypadElementPropType,k=15,M="Â°",w=300,S=1.5,I=2,N=1,R=n(84),O=R.iconPlus,A=R.iconUndo,_=n(16).deepEq,D=n(16).getGridStep,F=n(16).captureScratchpadTouchStart,L=n(123).number,G=n(123).vector,U=n(123).point,q=n(123).ray,B=n(123).line,H=n(78),z=n(97),V=n(105).assert,W=400,Y={url:null},j=function(e,t){e=e||{};var n=e.labels||["x","y"],r=e.range||[[-10,10],[-10,10]],i=e.step||[1,1],o=e.gridStep||D(r,i,t);return{box:[t,t],labels:n,range:r,step:i,gridStep:o,valid:!0,backgroundImage:Y,markings:"grid",showProtractor:!1}},X={apiOptions:C.defaults,gradeEmpty:!1,graphMode:"interactive",listMode:"dynamic",graph:{},tools:{translation:{enabled:!0,required:!1,constraints:{}},rotation:{enabled:!0,required:!1,constraints:{fixed:!1},coord:[1,6]},reflection:{enabled:!0,required:!1,constraints:{fixed:!1},coords:[[2,-4],[2,2]]},
dilation:{enabled:!0,required:!1,constraints:{fixed:!1},coord:[6,6]}},drawSolutionShape:!0,starting:{shape:{type:"polygon-3",coords:[[2,2],[2,6],[7,2]]},transformations:[]},correct:{shape:{type:"polygon-3",coords:[[2,2],[2,6],[7,2]]},transformations:[]}},K=function(e){return e.customKeypad?x:e.staticRender?T:b},Q={apply:function(e){return Z[e.type].isValid(e)?Z[e.type].apply(e):m.identity},append:function(e,t){var n=Q._appendAndCollapseLastTwo(e,t);return Q._collapseFinalNoOps(n)},_collapseFinalNoOps:function(e){return e.length&&Q.isNoOp(m.last(e))?m.initial(e):e},_appendAndCollapseLastTwo:function(e,t){if(e.length){var n=Q.collapse(m.last(e),t);return m.initial(e).concat(n)}return[t]},isNoOp:function(e){return Z[e.type].isNoOp(e)},collapse:function(e,t){return e.type!==t.type?[e,t]:Q.isEmpty(e)&&Q.isEmpty(t)?[]:Q.isValid(e)&&Q.isValid(t)?Q._collapseValidMonotypedTransforms(e,t):[e,t]},isValid:function(e){return Z[e.type].isValid(e)},isEmpty:function(e){return Z[e.type].isEmpty(e)},_collapseValidMonotypedTransforms:function(e,t){var n=Z[e.type].collapse(e,t);return n?(m.isArray(n)||(n=[n]),m.each(n,function(t){t.type=e.type}),n):[e,t]},toTeX:function(e){return Z[e.type].toTeX(e)},ListItem:f.createClass({displayName:"ListItem",render:function(){if("dynamic"===this.props.mode)return f.createElement("div",null,Q.toTeX(this.props.transform));if("interactive"===this.props.mode){var e=Z[this.props.transform.type].Input;return f.createElement(e,d({ref:"transform",onChange:this.handleChange,onFocus:this.props.onFocus,onBlur:this.props.onBlur,keypadElement:this.props.keypadElement,apiOptions:this.props.apiOptions},this.props.transform))}throw new Error("Invalid mode: "+this.props.mode)},value:function(){return"interactive"===this.props.mode?m.extend({type:this.props.transform.type},this.refs.transform.value()):this.props.transform},handleChange:m.debounce(function(e){this.props.onChange(this.value(),e)},w),_getComponentAtPath:function(e){var t=this.refs.transform,n=m.head(e);return t.refs[n]},focus:function(){var e=this.refs.transform,t=m.head(e.getInputPaths());t&&this.focusInputPath(t)},focusInputPath:function(e){this._getComponentAtPath(e).focus()},blurInputPath:function(e){this._getComponentAtPath(e).blur()},getDOMNodeForPath:function(e){return g.findDOMNode(this._getComponentAtPath(e))},getGrammarTypeForPath:function(e){return"number"},setInputValue:function(e,t,n){t.length&&(t=parseFloat(t),isNaN(t))||this.refs.transform.setInputValue(e,t,n)},getInputPaths:function(){return"dynamic"===this.props.mode?[]:this.refs.transform.getInputPaths()}})},Z={translation:{verbName:i18n._("Translate"),nounName:i18n._("Translation"),lowerNounName:i18n._("translation"),apply:function(e){return function(t){return G.add(t,e.vector)}},isValid:function(e){return m.isFinite(e.vector[0])&&m.isFinite(e.vector[1])},isEmpty:function(e){return null===e.vector[0]&&null===e.vector[1]},isNoOp:function(e){return G.equal(e.vector,[0,0])},collapse:function(e,t){return{vector:G.add(e.vector,t.vector)}},toTeX:function(e){return $_({vector:u(e.vector)},"Translation by %(vector)s")},Input:f.createClass({displayName:"Input",getInitialState:function(){return{vector:this.props.vector||[null,null]}},componentDidUpdate:function(e){_(this.props,e)||this.setState({vector:this.props.vector})},render:function(){var e=this,t=K(this.props.apiOptions),n=[f.createElement(P,null,"\\langle"),f.createElement(t,{ref:"x",placeholder:0,value:this.state.vector[0],useArrowKeys:!0,onChange:function(t){var n=e.state.vector[1];e.setState({vector:[t,n]},function(){e.props.onChange()})},onFocus:m.partial(this.props.onFocus,"x"),onBlur:m.partial(this.props.onBlur,"x"),keypadElement:this.props.keypadElement}),f.createElement(P,null,", {}"),f.createElement(t,{ref:"y",placeholder:0,value:this.state.vector[1],useArrowKeys:!0,onChange:function(t){var n=e.state.vector[0];e.setState({vector:[n,t]},function(){e.props.onChange()})},onFocus:m.partial(this.props.onFocus,"y"),onBlur:m.partial(this.props.onBlur,"y"),keypadElement:this.props.keypadElement}),f.createElement(P,null,"\\rangle")];return f.createElement("div",null,$_({vector:n},"Translation by %(vector)s"))},value:function(){var e=this.refs.x.getValue(),t=this.refs.y.getValue();return{vector:[e,t]}},setInputValue:function(e,t,n){var r=this,i=m.first(e),o=m.clone(this.state.vector);"x"===i?o[0]=t:"y"===i&&(o[1]=t),this.setState({vector:o},function(){r.props.onChange(n)})},getInputPaths:function(){return[["x"],["y"]]}})},rotation:{verbName:i18n._("Rotate"),nounName:i18n._("Rotation"),lowerNounName:i18n._("rotation"),apply:function(e){return function(t){return U.rotateDeg(t,e.angleDeg,e.center)}},isValid:function(e){return m.isFinite(e.angleDeg)&&m.isFinite(e.center[0])&&m.isFinite(e.center[1])},isEmpty:function(e){return null===e.angleDeg&&null===e.center[0]&&null===e.center[1]},isNoOp:function(e){return L.equal(e.angleDeg,0)},collapse:function(e,t){return!!U.equal(e.center,t.center)&&{center:e.center,angleDeg:e.angleDeg+t.angleDeg}},toTeX:function(e){return $_({degrees:c(e.angleDeg),point:l(e.center)},"Rotation by %(degrees)s about %(point)s")},Input:f.createClass({displayName:"Input",getInitialState:function(){return{center:this.props.center||[null,null],angleDeg:this.props.angleDeg||null}},componentDidUpdate:function(e){_(this.props,e)||this.setState({center:this.props.center,angleDeg:this.props.angleDeg})},render:function(){var e=this,t=K(this.props.apiOptions),n=[f.createElement(P,null,"("),f.createElement(t,{ref:"centerX",placeholder:0,value:this.state.center[0],useArrowKeys:!0,onChange:function(t){var n=e.state.center[1];e.setState({center:[t,n]},function(){e.props.onChange()})},onFocus:m.partial(this.props.onFocus,"centerX"),onBlur:m.partial(this.props.onBlur,"centerX"),keypadElement:this.props.keypadElement}),f.createElement(P,null,", {}"),f.createElement(t,{ref:"centerY",placeholder:0,value:this.state.center[1],useArrowKeys:!0,onChange:function(t){var n=e.state.center[0];e.setState({center:[n,t]},function(){e.props.onChange()})},onFocus:m.partial(this.props.onFocus,"centerY"),onBlur:m.partial(this.props.onBlur,"centerY"),keypadElement:this.props.keypadElement}),f.createElement(P,null,")")],r=[f.createElement(t,{ref:"angleDeg",placeholder:0,value:this.state.angleDeg,useArrowKeys:!0,onChange:function(t){e.setState({angleDeg:t},function(){e.props.onChange()})},onFocus:m.partial(this.props.onFocus,"angleDeg"),onBlur:m.partial(this.props.onBlur,"angleDeg"),keypadElement:this.props.keypadElement}),M],i=$_({point:n,degrees:r},"Rotation about %(point)s by %(degrees)s");return f.createElement("div",null,i)},value:function(){var e=this.refs.angleDeg.getValue(),t=this.refs.centerX.getValue(),n=this.refs.centerY.getValue();return{angleDeg:e,center:[t,n]}},setInputValue:function(e,t,n){var r=this,i=m.first(e),o=m.clone(this.state.angleDeg),s=m.clone(this.state.center);"angleDeg"===i?o=t:"centerX"===i?s[0]=t:"centerY"===i&&(s[1]=t),this.setState({angleDeg:o,center:s},function(){r.props.onChange(n)})},getInputPaths:function(){return[["centerX"],["centerY"],["angleDeg"]]}})},reflection:{verbName:i18n._("Reflect"),nounName:i18n._("Reflection"),lowerNounName:i18n._("reflection"),apply:function(e){return function(t){return U.reflectOverLine(t,e.line)}},isValid:function(e){return m.all(m.flatten(e.line),m.isFinite)&&!U.equal(e.line[0],e.line[1])},isEmpty:function(e){return m.all(m.flatten(e.line),m.isNull)},isNoOp:function(e){return!1},collapse:function(e,t){return!!B.equal(e.line,t.line)&&[]},toTeX:function(e){var t=e.line[0],n=e.line[1];return $_({point1:l(t),point2:l(n)},"Reflection over the line from %(point1)s to %(point2)s")},Input:f.createClass({displayName:"Input",getInitialState:function(){return{line:this.props.line||[[null,null],[null,null]]}},componentDidUpdate:function(e){_(this.props,e)||this.setState({line:this.props.line})},render:function(){var e=K(this.props.apiOptions),t=[f.createElement(P,null,"("),f.createElement(e,{ref:"x1",value:this.state.line[0][0],useArrowKeys:!0,onChange:this.changePoint.bind(this,0,0),onFocus:m.partial(this.props.onFocus,"x1"),onBlur:m.partial(this.props.onBlur,"x1"),keypadElement:this.props.keypadElement}),f.createElement(P,null,", {}"),f.createElement(e,{ref:"y1",value:this.state.line[0][1],useArrowKeys:!0,onChange:this.changePoint.bind(this,0,1),onFocus:m.partial(this.props.onFocus,"y1"),onBlur:m.partial(this.props.onBlur,"y1"),keypadElement:this.props.keypadElement}),f.createElement(P,null,")")],n=[f.createElement(P,null,"("),f.createElement(e,{ref:"x2",value:this.state.line[1][0],useArrowKeys:!0,onChange:this.changePoint.bind(this,1,0),onFocus:m.partial(this.props.onFocus,"x2"),onBlur:m.partial(this.props.onBlur,"x2"),keypadElement:this.props.keypadElement}),f.createElement(P,null,", {}"),f.createElement(e,{ref:"y2",value:this.state.line[1][1],useArrowKeys:!0,onChange:this.changePoint.bind(this,1,1),onFocus:m.partial(this.props.onFocus,"y2"),onBlur:m.partial(this.props.onBlur,"y2"),keypadElement:this.props.keypadElement}),f.createElement(P,null,")")];return f.createElement("div",null,$_({point1:t,point2:n},"Reflection over the line from %(point1)s to %(point2)s"))},changePoint:function(e,t,n,r){var i=this,o=m.map(this.state.line,m.clone);o[e][t]=n,this.setState({line:o},function(){i.props.onChange(r)})},value:function(){var e=this.refs.x1.getValue(),t=this.refs.y1.getValue(),n=this.refs.x2.getValue(),r=this.refs.y2.getValue();return{line:[[e,t],[n,r]]}},setInputValue:function(e,t,n){var r,i=m.first(e);"x"===i[0]?r=0:"y"===i[0]&&(r=1);var o;"1"===i[1]?o=0:"2"===i[1]&&(o=1),this.changePoint(o,r,t,n)},getInputPaths:function(){return[["x1"],["y1"],["x2"],["y2"]]}})},dilation:{verbName:i18n._("Dilate"),nounName:i18n._("Dilation"),lowerNounName:i18n._("dilation"),apply:function(e){return function(t){return s(t,e.center,e.scale)}},isValid:function(e){return m.isFinite(e.scale)&&m.isFinite(e.center[0])&&m.isFinite(e.center[1])},isEmpty:function(e){return null===e.scale&&null===e.center[0]&&null===e.center[1]},isNoOp:function(e){return L.equal(e.scale,1)},collapse:function(e,t){return!!U.equal(e.center,t.center)&&{center:e.center,scale:e.scale*t.scale}},toTeX:function(e){var t=p(e.scale);return $_({scale:t,point:l(e.center)},"Dilation of scale %(scale)s about %(point)s")},Input:f.createClass({displayName:"Input",getInitialState:function(){return{center:this.props.center||[null,null],scale:this.props.scale||null}},componentDidUpdate:function(e){_(this.props,e)||this.setState({center:this.props.center,scale:this.props.scale})},render:function(){var e=this,t=K(this.props.apiOptions),n=[f.createElement(P,null,"("),f.createElement(t,{ref:"x",placeholder:0,value:this.state.center[0],useArrowKeys:!0,onChange:function(t){var n=e.state.center[1];e.setState({center:[t,n]},function(){e.props.onChange()})},onFocus:m.partial(this.props.onFocus,"x"),onBlur:m.partial(this.props.onBlur,"x"),keypadElement:this.props.keypadElement}),f.createElement(P,null,", {}"),f.createElement(t,{ref:"y",placeholder:0,value:this.state.center[1],useArrowKeys:!0,onChange:function(t){var n=e.state.center[0];e.setState({center:[n,t]},function(){e.props.onChange()})},onFocus:m.partial(this.props.onFocus,"y"),onBlur:m.partial(this.props.onBlur,"y"),keypadElement:this.props.keypadElement}),f.createElement(P,null,")")],r=f.createElement(t,{ref:"scale",placeholder:1,value:this.state.scale,useArrowKeys:!0,onChange:function(t){e.setState({scale:t},function(){e.props.onChange()})},onFocus:m.partial(this.props.onFocus,"scale"),onBlur:m.partial(this.props.onBlur,"scale"),keypadElement:this.props.keypadElement});return f.createElement("div",null,$_({point:n,scale:r},"Dilation about %(point)s by %(scale)s"))},value:function(){var e=this.refs.scale.getValue(),t=this.refs.x.getValue(),n=this.refs.y.getValue();return{scale:e,center:[t,n]}},setInputValue:function(e,t,n){var r=this,i=m.first(e),o=this.state.scale,s=m.clone(this.state.center);"x"===i?s[0]=t:"y"===i?s[1]=t:"scale"===i&&(o=t),this.setState({scale:o,center:s},function(){r.props.onChange(n)})},getInputPaths:function(){return[["x"],["y"],["scale"]]}})}},J={getPointCountForType:function(e){var t=e.split("-");return"polygon"===t[0]?t[1]||3:"line"===t[0]||"lineSegment"===t[0]?2:"angle"===t[0]?3:"circle"===t[0]?2:"point"===t[0]?1:void 0},addMovableShape:function(e,t){if(t.editable&&t.translatable)throw new Error("It doesn't make sense to have a movable shape where you can stretch the points and translate them simultaneously. options: "+JSON.stringify(t));var n,r=m.map(t.shape.coords,function(i){var o,s=!1,a=i,p=function(e,i){s||(a=o.coord,s=!0);var p=G.subtract([e,i],o.coord);t.onMove&&(p=t.onMove(p[0],p[1])),t.translatable&&m.each(r,function(e){e!==o&&e.setCoord(G.add(e.coord,p))});var l=o.coord,u=G.add(o.coord,p);return o.coord=u,n.update(),o.coord=l,u},l=function(){if(t.onMoveEnd&&s){s=!1;var e=G.subtract(o.coord,a);t.onMoveEnd(e[0],e[1])}n.update()};return o=e.addMovablePoint({coord:i,normalStyle:t.normalPointStyle,highlightStyle:t.highlightPointStyle,constraints:{fixed:!t.translatable&&!t.editable},visible:t.showPoints,snapX:t.snap&&t.snap[0]||0,snapY:t.snap&&t.snap[1]||0,bounded:!1,onMove:p,onMoveEnd:l}),o.bounded=!0,o});n=J.addShape(e,t,r);var i=n.remove;return n.remove=function(){i.apply(n),m.invoke(r,"remove")},n},addShape:function(e,t,n){n=n||t.shape.coords;var r=J._typesOf(t.shape),i=t.shape.options||J.defaultOptions(r),o=J._mapTypes(r,n,function(n,r,o){var s=m.extend({},t,i[o]);return J._addType(e,n,r,s)}),s=m.filter(m.pluck(o,"update"),m.identity),a=function(){m.invoke(s,"call")},p=m.filter(m.pluck(o,"remove"),m.identity),l=function(){m.invoke(p,"call")},u=function(){return m.map(o,function(e){return e.getOptions?e.getOptions():{}})},c=function(){var e=m.map(n,function(e){return m.isArray(e)?e:e.coord});return{type:r,coords:e,options:u()}};return{type:r,points:n,update:a,remove:l,toJSON:c,getOptions:u}},equal:function(e,t){var n=J._typesOf(e),r=J._typesOf(t);if(n.length!==r.length)return!1;var i=J._mapTypes(n,e.coords,J._combine),o=J._mapTypes(r,t.coords,J._combine);return m.all(m.map(i,function(e,t){var n=o[t];return e.type===n.type&&J._forType(e.type).equal(e.coords,n.coords)}))},_typesOf:function(e){var t=e.type;return m.isArray(t)||(t=[t]),m.map(t,function(e){return"polygon"===e?"polygon-3":e})},defaultOptions:function(e){return m.map(e,function(e){var t=J._forType(e).defaultOptions;return m.extend({},t)})},_forType:function(e){var t=e.split("-")[0];return J[t]},_mapTypes:function(e,t,n,r){return m.map(e,function(e,i){var o=J.getPointCountForType(e),s=m.first(t,o);return t=m.rest(t,o),n.call(r,e,s,i)})},_addType:function(e,t,n,r){var i=m.isArray(n[0])?{coordA:n[0],coordZ:n[1]}:{pointA:n[0],pointZ:n[1]};if(t=t.split("-")[0],"polygon"===t){var o=e.addMovablePolygon(m.extend({},r,{fixed:!r.editable,snapX:r.snap&&r.snap[0]||0,snapY:r.snap&&r.snap[1]||0,points:n,constrainToGraph:!1}));return{update:o.transform.bind(o),remove:o.remove.bind(o)}}if("line"===t||"lineSegment"===t){var s=e.addMovableLineSegment(m.extend({},r,i,{movePointsWithLine:!0,fixed:!0,constraints:{fixed:!0},extendLine:"line"===t}));return{update:s.transform.bind(s,!0),remove:s.remove.bind(s)}}if("angle"===t){var a=!!r.editable&&null,p=e.addMovableAngle({angleLabel:"$deg0",fixed:!0,points:n,normalStyle:r.normalStyle,reflex:r.reflex});return m.isArray(n[0])||r.editable||(n[0].remove(),n[2].remove()),{update:p.update.bind(p,a),remove:p.remove.bind(p),getOptions:function(){return{reflex:p.isReflex()}}}}if("circle"===t){var l={remove:m.identity},u=function(){var t=n[0].coord||n[0],i=n[1].coord||n[1],o=U.distanceToPoint(t,i);l.remove(),l=e.circle(t,o,m.extend({stroke:z.DYNAMIC,"stroke-width":2},r.normalStyle))};return u(),n[1].remove&&!r.editable&&n[1].remove(),{update:u,remove:function(){l.remove()}}}if("point"===t)return{update:null,remove:null};throw new Error("Invalid shape type "+t)},_combine:function(e,t){return{type:e,coords:t}},polygon:{equal:h},line:{equal:B.equal},lineSegment:{equal:h},angle:{equal:function(e,t){if(!U.equal(e[1],t[1]))return!1;var n=[e[1],e[0]],r=[e[1],e[2]],i=[t[1],t[0]],o=[t[1],t[2]],s=q.equal(n,i)&&q.equal(r,o),a=q.equal(n,o)&&q.equal(r,i);return s||a},defaultOptions:{reflex:!1}},circle:{equal:function(e,t){var n=U.distanceToPoint(e[0],e[1]),r=U.distanceToPoint(t[0],t[1]);return U.equal(e[0],t[0])&&L.equal(n,r)}},point:{equal:U.equal}},ee=Q.ListItem,te=f.createClass({displayName:"TransformationList",render:function(){if("static"===this.props.mode)return f.createElement("span",null);var e=m.map(this.props.transformations,function(e,t){return f.createElement(ee,{ref:"transformation"+t,key:"transformation"+t,transform:e,mode:this.props.mode,onChange:this.handleChange,onFocus:m.partial(this.props.onFocus,""+t),onBlur:m.partial(this.props.onBlur,""+t),keypadElement:this.props.keypadElement,apiOptions:this.props.apiOptions})},this);return f.createElement("div",{className:"perseus-transformation-list"},e)},_transformationRefs:function(){var e=this;return m.times(this.props.transformations.length,function(t){return e.refs["transformation"+t]})},value:function(){return m.invoke(this._transformationRefs(),"value")},handleChange:function(e,t){this.props.onChange(this.value(),t)},focusLast:function(){var e=this._transformationRefs();0!==e.length&&m.last(e).focus()}}),ne=f.createClass({displayName:"ToolButton",render:function(){var e=this.props.toggled?"simple-button exercise-orange toggled highlighted-tool-button":"simple-button";return f.createElement("button",{type:"button",className:e,disabled:this.props.disabled,onClick:this.props.onClick,onTouchStart:F},this.props.children)}}),re=f.createClass({displayName:"ToolsBar",getInitialState:function(){return{selected:null}},render:function(){var e=m.map(Z,function(e,t){if(this.props.enabled[t])return f.createElement(ne,{key:t,disabled:this.props.apiOptions.readOnly,toggled:this.state.selected===t,onClick:this.changeSelected.bind(this,t)},e.verbName)},this);return f.createElement("div",{className:"transformer-tools-bar"},f.createElement("span",{className:"simple-button-group"},e),f.createElement("button",{className:"transformer-undo-button simple-button",type:"button",disabled:this.props.apiOptions.readOnly,onClick:this.props.onUndoClick,onTouchStart:F},f.createElement(y,A)," ","Undo"),f.createElement("div",{className:"clear"}))},changeSelected:function(e){this.props.removeTool(this.state.selected),e&&e!==this.state.selected?(this.props.addTool(e),this.setState({selected:e})):this.setState({selected:null})}}),ie=f.createClass({displayName:"AddTransformBar",render:function(){var e=m.map(Z,function(e,t){if(this.props.enabled[t])return f.createElement(ne,{key:t,toggled:!1,disabled:this.props.apiOptions.readOnly,onClick:this.changeSelected.bind(this,t)},f.createElement(y,O)," ",e.nounName)},this);return f.createElement("div",{className:"transformer-tools-bar"},e,f.createElement("button",{className:"transformer-undo-button simple-button",type:"button",onClick:this.props.onUndoClick,disabled:this.props.apiOptions.readOnly,onTouchStart:F},f.createElement(y,A)," ","Undo"),f.createElement("div",{className:"clear"}))},changeSelected:function(e){e&&this.props.addTool(e)}}),oe=f.createClass({displayName:"Transformer",propTypes:{apiOptions:C.propTypes,keypadElement:E,trackInteraction:f.PropTypes.func.isRequired},getDefaultProps:function(){return m.defaults({transformations:[]},X)},render:function(){var e=m.extend(j(this.props.graph,W),this.props.graph),t="interactive"===this.props.graphMode,n=t?re:ie,i=f.createElement("div",{style:{width:e.box[0]}},f.createElement(n,{ref:"toolsBar",enabled:r(this.props.tools,"enabled"),apiOptions:this.props.apiOptions,addTool:this.addTool,removeTool:this.removeTool,onUndoClick:this.handleUndoClick}));return f.createElement("div",{className:"perseus-widget perseus-widget-transformer"},f.createElement(v,{ref:"graph",box:e.box,range:e.range,labels:e.labels,step:e.step,gridStep:e.gridStep,markings:e.markings,backgroundImage:e.backgroundImage,showProtractor:e.showProtractor,onGraphieUpdated:this.setupGraphie,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable}),!t&&"Add transformations below:","static"===this.props.graphMode&&[f.createElement("br",{key:"static-br"}),f.createElement("em",{key:"static-nomove"}," ","Note: For this question, the shape will not move."," ")],t&&i,f.createElement(te,{ref:"transformationList",mode:this.props.listMode,transformations:this.props.transformations,onChange:this.setTransformationProps,onFocus:this._handleFocus,onBlur:this._handleBlur,keypadElement:this.props.keypadElement,apiOptions:this.props.apiOptions}),!t&&i)},componentDidMount:function(){this.setupGraphie(this.graphie())},componentDidUpdate:function(e){this.shouldSetupGraphie(this.props,e)?this.refs.graph.reset():_(this.props.transformations,this.transformations)||this.setTransformations(this.props.transformations)},shouldSetupGraphie:function(e,t){return!_(t.starting,e.starting)||t.graphMode!==e.graphMode||t.listMode!==e.listMode||t.drawSolutionShape!==e.drawSolutionShape||!(!e.drawSolutionShape||_(t.correct.shape,e.correct.shape))||!_(this.tools,e.tools)},graphie:function(){return this.refs.graph.graphie()},setupGraphie:function(e){this.props.drawSolutionShape&&this.props.correct.shape&&this.props.correct.shape.coords&&J.addShape(e,{fixed:!0,shape:this.props.correct.shape,normalStyle:{stroke:z.GRAY,"stroke-dasharray":"","stroke-width":2}}),this.currentTool=null,this.refs.toolsBar.changeSelected(null),this.addTransformerShape(this.props.starting.shape,!1),this.setTransformations(this.props.transformations),this.tools={translation:m.clone(this.props.tools.translation),rotation:m.clone(this.props.tools.rotation),reflection:m.clone(this.props.tools.reflection),dilation:m.clone(this.props.tools.dilation)}},setTransformations:function(e){this.resetCoords(),this.transformations=m.clone(e),m.each(this.transformations,this.applyTransform)},addTransformerShape:function(e,t){var n=this,r=this.graphie();this.shape=J.addMovableShape(r,{shape:e,editable:!1,showPoints:"static"!==this.props.graphMode,translatable:t,onMove:function(e,t){return e=H.roundToNearest(r.snap[0],e),t=H.roundToNearest(r.snap[1],t),n.addTransform({type:"translation",vector:[e,t]}),[e,t]},normalPointStyle:{fill:t?z.INTERACTIVE:z.DYNAMIC,stroke:t?z.INTERACTIVE:z.DYNAMIC},highlightPointStyle:{fill:z.INTERACTING,stroke:z.INTERACTING}})},addTool:function(e){var t=this;if("interactive"===this.props.graphMode)if("translation"===e)this.currentTool=this.addTranslationTool();else if("rotation"===e)this.currentTool=this.addRotationTool();else if("reflection"===e)this.currentTool=this.addReflectionTool();else{if("dilation"!==e)throw new Error("Invalid tool id: "+e);this.currentTool=this.addDilationTool()}else{var n;if("translation"===e)n={type:e,vector:[null,null]};else if("rotation"===e)n={type:e,center:[null,null],angleDeg:null};else if("reflection"===e)n={type:e,line:[[null,null],[null,null]]};else{if("dilation"!==e)throw new Error("Invalid tool id: "+e);n={type:e,center:[null,null],scale:null}}this.doTransform(n,function(){t.refs.transformationList.focusLast()})}},removeTool:function(e){this.currentTool&&this.currentTool.remove(),this.currentTool=null},addTranslationTool:function(){var e=this;return this.shape.remove(),this.addTransformerShape(this.shape.toJSON(),!0),{remove:function(){e.shape.remove(),e.addTransformerShape(e.shape.toJSON(),!1)}}},snapCoord:function(e){var t=this.graphie();return m.map(e,function(e,n){return H.roundToNearest(t.snap[n],e)})},normalizeReflectionCoords:function(e){var t=this.snapCoord(B.midpoint(e)),n=G.polarDegFromCart(G.subtract(e[0],e[1])),r=[1,H.roundToNearest(45,n[1])],i=G.cartFromPolarDeg(r),o=m.map([-1,1],function(e){var n=G.add(t,G.scale(i,e*this.scaleToCurrentRange(I)));return this.snapCoord(n)},this);return o},addReflectionTool:function(){var e=this.props.tools.reflection;if(e.enabled){var t,n=this,r=this.refs.graph.graphie(),o=function(){n.changeTool("reflection",{coords:m.pluck(a,"coord")})},s=this.normalizeReflectionCoords(e.coords),a=m.map(s,function(e){return r.addMovablePoint({coord:e,visible:!1})},this),p=i(e);r.style({},function(){t=r.addMovableLineSegment({fixed:e.constraints.fixed,constraints:e.constraints,pointA:a[0],pointZ:a[1],snapX:r.snap[0],snapY:r.snap[1],extendLine:!0,normalStyle:{stroke:p,"stroke-width":2,"stroke-dasharray":"- "},highlightStyle:{stroke:z.INTERACTING,"stroke-width":2,"stroke-dasharray":"- "},movePointsWithLine:!0,onMoveEnd:o})});var l=r.addReflectButton({fixed:e.constraints.fixed,line:t,size:this.scaleToCurrentRange(N),onClick:function(){n.doTransform({type:"reflection",line:m.pluck(a,"coord")}),u&&(u.setCoord(G.add(l.coord,G.subtract(l.coord,u.coord))),u.update())},normalStyle:{stroke:p,"stroke-width":2,fill:p},highlightStyle:{stroke:z.INTERACTING,"stroke-width":3,fill:z.INTERACTING},onMoveEnd:o}),u=null;if(!e.constraints.fixed){var c=G.polarDegFromCart(G.subtract(a[1].coord,a[0].coord))[1]+90;u=r.addRotateHandle({center:l,radius:this.scaleToCurrentRange(I),angleDeg:c,width:this.scaleToCurrentRange(.24),hoverWidth:this.scaleToCurrentRange(.4),lengthAngle:17,onMove:function(e){return H.roundToNearest(45,e)},onMoveEnd:o})}return $(t).on("move",function(){l.update(),$(l).trigger("move")}),u&&$(u).on("move",function(){var e=n.snapCoord(u.coord),r=G.subtract(e,l.coord),i=l.isFlipped()?1:0;a[i].setCoord(G.add(l.coord,G.rotateDeg(r,90))),a[1-i].setCoord(G.add(l.coord,G.rotateDeg(r,-90))),t.transform(!0),l.update()}),{remove:function(){l.remove(),u&&u.remove(),t.remove(),a[0].remove(),a[1].remove()}}}},scaleToCurrentRange:function(e){return o(e,this.refs.graph.props.range)},addRotationTool:function(){var e=this.props.tools.rotation;if(e.enabled){var t=this,n=this.refs.graph.graphie(),r=i(e);return this.rotatePoint=n.addMovablePoint({constraints:e.constraints,coord:e.coord,snapX:n.snap[0],snapY:n.snap[1],normalStyle:{"stroke-dasharray":"",stroke:r,fill:r},highlightStyle:{"stroke-dasharray":"",stroke:z.INTERACTING,fill:z.INTERACTING}}),this.rotateHandle=n.addRotateHandle({center:this.rotatePoint,radius:this.scaleToCurrentRange(S),width:this.scaleToCurrentRange(.24),hoverWidth:this.scaleToCurrentRange(.4),onMove:function(e,n){var r=t.getRotationTransformFromAngle(t.rotatePoint.coord,e-n);return t.doTransform(r),n+r.angleDeg}}),this.rotatePoint.onMoveEnd=function(e,n){t.changeTool("rotation",{coord:[e,n]})},{remove:function(){t.rotateHandle.remove(),t.rotatePoint.remove()}}}},addDilationTool:function(){var e=this.props.tools.dilation;if(e.enabled){var t=this,n=this.refs.graph.graphie(),r=i(e);t.dilationCircle=n.addCircleGraph({centerConstraints:e.constraints,center:e.coord,radius:t.scaleToCurrentRange(2),snapX:n.snap[0],snapY:n.snap[1],minRadius:t.scaleToCurrentRange(1),snapRadius:t.scaleToCurrentRange(.5),onResize:function(e,n){t.doTransform({type:"dilation",center:t.dilationCircle.centerPoint.coord,scale:e/n})},circleNormalStyle:{stroke:r,"stroke-width":2,"stroke-dasharray":"- ","fill-opacity":0},circleHighlightStyle:{stroke:z.INTERACTING,"stroke-width":2,"stroke-dasharray":"",fill:z.INTERACTING,"fill-opacity":.05},centerNormalStyle:{stroke:r,fill:r,"stroke-width":2,"stroke-dasharray":""},centerHighlightStyle:{stroke:r,fill:r,"stroke-width":2,"stroke-dasharray":""}});var o=this.dilationCircle.centerPoint.onMoveEnd;return this.dilationCircle.centerPoint.onMoveEnd=function(){o&&o.apply(this,m.toArray(arguments)),t.changeTool("dilation",{coord:t.dilationCircle.centerPoint.coord})},{remove:function(){t.dilationCircle.remove()}}}},getRotationTransformFromAngle:function(e,t){t=(t+360)%360,t>180&&(t-=360);var n=Math.round(t/k)*k;return{type:"rotation",center:e,angleDeg:n}},doTransform:function(e,t){this.applyTransform(e),this.addTransform(e,t)},applyTransform:function(e){if("static"!==this.props.graphMode){var t=Q.apply(e);this.applyCoordTransformation(t)}},applyCoordTransformation:function(e){m.each(this.shape.points,function(t){var n=e(t.coord);t.setCoord(n)}),this.shape.update()},resetCoords:function(){var e=this.props.starting.shape.coords;m.each(this.shape.points,function(t,n){t.setCoord(e[n])}),this.shape.update()},handleUndoClick:function(){this.refs.toolsBar.changeSelected(null),this.props.transformations.length&&this.props.onChange({transformations:m.initial(this.props.transformations)})},setTransformationProps:function(e,t){this.props.onChange({transformations:e},t)},addTransform:function(e,t){this.transformations=Q.append(this.transformations,e),this.props.onChange({transformations:m.clone(this.transformations)},t)},changeTool:function(e,t){var n=m.clone(this.props.tools);n[e]=m.extend({},this.props.tools[e],t),this.tools[e]=m.clone(n[e]),this.props.onChange({tools:n}),this.props.trackInteraction()},simpleValidate:function(e){return oe.validate(this.getUserInput(),e)},getCoords:function(){var e=this.props.starting.shape.coords,t=this.props.transformations;return m.reduce(t,function(e,t){return m.map(e,Q.apply(t))},e)},getEditorJSON:function(){var e=m.pick(this.props,"grading","starting","graphMode","listMode","tools","drawSolutionShape","gradeEmpty");return e.graph=this.refs.graph.toJSON(),e.version=1.2,e.answer=this.getUserInput(),e},getUserInput:function(){return{transformations:this.props.transformations,shape:{type:this.shape.type,coords:this.getCoords(),options:this.shape.getOptions()}}},_handleFocus:function(){var e=Array.prototype.slice.call(arguments);this.props.onFocus(e)},_handleBlur:function(){var e=Array.prototype.slice.call(arguments);this.props.onBlur(e)},_getTransformationForID:function(e){var t=["transformationList","transformation"+e],n=this;return m.each(t,function(e){n=n.refs[e]}),n},getInputPaths:function(){var e=this;if("static"===this.props.listMode)return[];var t=[];return m.each(this.props.transformations,function(n,r){var n=e._getTransformationForID(r),i=n.getInputPaths(),o=m.map(i,function(e){return[""+r].concat(e)});t=t.concat(o)}),t},_passToInner:function(e,t){if(t&&t.length){var n=m.rest(t),r=[n].concat(m.rest(arguments,2)),i=m.head(t),o=this._getTransformationForID(i);return o[e].apply(o,r)}},focus:function(){var e=this.getInputPaths();return e.length>0&&(this.focusInputPath(e[0]),!0)},focusInputPath:function(e){return 0!==e.length&&(V(e.length>=2),this._passToInner("focusInputPath",e))},blurInputPath:function(e){return 0!==e.length&&(V(e.length>=2),this._passToInner("blurInputPath",e))},setInputValue:function(e,t,n){return V(e.length>=2),this._passToInner("setInputValue",e,t,n)},getDOMNodeForPath:function(e){return V(e.length>=2),this._passToInner("getDOMNodeForPath",e)},getGrammarTypeForPath:function(e){return V(e.length>=2),this._passToInner("getGrammarTypeForPath",e)}});m.extend(oe,{validate:function(e,t){for(var n in Z)if(t.tools[n].required){var r=m.any(m.map(e.transformations,function(e){return e.type===n&&!Q.isEmpty(e)&&!Q.isNoOp(e)}));if(!r)return{type:"invalid",message:i18n._("Your transformation must use a %(type)s.",{type:Z[n].lowerNounName})}}return J.equal(e.shape,t.correct.shape)?{type:"points",earned:1,total:1,message:null}:!t.gradeEmpty&&_(e.shape.coords,t.starting.shape.coords)?{type:"invalid",message:i18n._("Use the interactive graph to define a correct transformation.")}:{type:"points",earned:0,total:1,message:null}}}),e.exports={name:"transformer",displayName:"Transformer",widget:oe}},function(e,t,n){"use strict";var r=n(92),i=n(10),o=n(11),s=n(9),a=n(17).ClassNames,p=n(17).Options,l=n(80),u=n(104),c=n(107),h=c.SignificantFigures,d=c.displaySigFigs,f="all",g=10,m=function(e){return new h(e).sigFigs},v=function(e,t){return d(e,t,-g,!1)},y=i.createClass({displayName:"OldUnitInput",mixins:[l],propTypes:{value:i.PropTypes.string},getDefaultProps:function(){return{apiOptions:p.defaults,value:""}},render:function(){var e=this.props.apiOptions.staticRender?i.createFactory(u):i.DOM.input,t=e({onChange:this.handleChange,ref:"input",className:a.INTERACTIVE,value:this.props.value,onFocus:this.handleFocus,onBlur:this.handleBlur});return i.createElement("div",{
className:"old-unit-input"},t,i.createElement("div",{ref:"error",className:"error",style:{display:"none"}},i18n._("I don't understand that")))},_errorTimeout:null,_showError:function(){if(""!==this.props.value){var e=$(o.findDOMNode(this.refs.error));e.is(":visible")||e.css({top:50,opacity:.1}).show().animate({top:0,opacity:1},300)}},_hideError:function(){var e=$(o.findDOMNode(this.refs.error));e.is(":visible")&&e.animate({top:50,opacity:.1},300,function(){$(this).hide()})},componentDidUpdate:function(){clearTimeout(this._errorTimeout),KAS.unitParse(this.props.value).parsed?this._hideError():this._errorTimeout=setTimeout(this._showError,2e3)},componentWillUnmount:function(){clearTimeout(this._errorTimeout)},handleBlur:function(){this.props.onBlur([]),clearTimeout(this._errorTimeout),KAS.unitParse(this.props.value).parsed||this._showError()},handleChange:function(e){this._hideError(),this.props.onChange({value:e.target.value})},simpleValidate:function(e,t){return t=t||function(){},y.validate(this.getUserInput(),e)},getUserInput:function(){return this.props.value},getInputPaths:function(){return[[]]},focusInputPath:function(e){o.findDOMNode(this.refs.input).focus()},handleFocus:function(){this.props.onFocus([])},blurInputPath:function(e){o.findDOMNode(this.refs.input).blur()},setInputValue:function(e,t,n){this.props.onChange({value:t},n)},getDOMNodeForPath:function(){return o.findDOMNode(this.refs.input)},getGrammarTypeForPath:function(e){return"unit"}}),b=function(e){return e.simplify().asMul().partition()[1].flatten().simplify()};s.extend(y,{validate:function(e,t){var n=KAS.unitParse(t.value).expr,r=KAS.unitParse(e);if(!r.parsed)return{type:"invalid",message:i18n._("I couldn't understand those units.")};var i=null,o=t.sigfigs,a=m(r.coefficient)===o;a||(i=i18n._("Check your significant figures."));var p;try{var l=new KAS.Var("x"),u=new KAS.Eq(n.simplify(),"=",new KAS.Mul(l,r.expr.simplify())),c=u.solveLinearEquationForVariable(l);p=Number(c.eval()).toPrecision(o)===Number(1).toPrecision(o)}catch(e){p=!1}p||(i=i18n._("That answer is numerically incorrect."));var h,d=b(r.expr.simplify()),g=b(n.simplify());if(h=t.accepting===f?KAS.compare(d,g).equal:s(t.acceptingUnits).any(function(e){var t=b(KAS.unitParse(e).unit.simplify());return KAS.compare(t,d).equal}),!h)var i=i18n._("Check your units.");var v=h&&p&&a;return{type:"points",earned:v?1:0,total:1,message:i}}}),e.exports={name:"unit-input",displayName:"Unit",defaultAlignment:"inline-block",widget:y,transform:function(e){return r(e).del(["value"]).freeze()},version:{major:0,minor:1},countSigfigs:m,sigfigPrint:v,hidden:!0}},function(e,t,n){"use strict";var r=n(10),i=n(9),o=n(80),s=n(85),a=1280,p=720,l="https://{hostname}/embed_video?slug={slug}&internal_video_only=1",u=/^https?:\/\//,c=/khanacademy\.org/,h=r.createClass({displayName:"Video",propTypes:{alignment:r.PropTypes.string,location:r.PropTypes.string},mixins:[o],getUserInput:function(){return null},simpleValidate:function(e){return h.validate(null,e)},render:function(){var e=this.props.location;if(!e)return r.createElement("div",null);var t;if(u.test(e))t=e;else{t=l.replace("{slug}",e);var n=document.location.hostname,i="www.khanacademy.org";c.test(n)&&(i=n),t=t.replace("{hostname}",i)}return r.createElement(s,{width:a,height:p,key:e+this.props.alignment},r.createElement("iframe",{className:"perseus-video-widget",sandbox:"allow-same-origin allow-scripts",width:a,height:p,src:t,allowFullScreen:!0}))}});i.extend(h,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),e.exports={name:"video",displayName:"Video",defaultAlignment:"block",supportedAlignments:["block","float-left","float-right","full-width"],widget:h}},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(10),i=n(11),o=n(9),s=n(132),a=n(13).css,p=r.createClass({displayName:"ButtonGroup",propTypes:{value:r.PropTypes.any,buttons:r.PropTypes.arrayOf(r.PropTypes.shape({value:r.PropTypes.any.isRequired,content:r.PropTypes.node,title:r.PropTypes.string})).isRequired,onChange:r.PropTypes.func.isRequired,allowEmpty:r.PropTypes.bool},getDefaultProps:function(){return{value:null,allowEmpty:!0}},render:function(){var e=this,t=this.props.value,n=o(this.props.buttons).map(function(n,i){return r.createElement("button",{title:n.title,type:"button",id:""+i,ref:"button"+i,key:""+i,className:a(s.button.buttonStyle,n.value===t&&s.button.selectedStyle),onClick:e.toggleSelect.bind(e,n.value)},n.content||""+n.value)}),i={display:"inline-block"};return r.createElement("div",{style:i},n)},focus:function(){return i.findDOMNode(this).focus(),!0},toggleSelect:function(e){var t=this.props.value;this.props.allowEmpty?this.props.onChange(t!==e?e:null):this.props.onChange(e)}});e.exports=p},,,function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(10),o=n(17).Options,s=n(81),a=n(84),p=a.iconStar,l=a.iconTryAgain,u=n(36),c=u.boldFontFamily,h=u.gray68,d=u.gray76,f=u.gray85,g=u.gray95,m=u.kaGreen,v=u.phoneMargin,y=u.negativePhoneMargin,b={HIDDEN:Symbol("HIDDEN"),ACTIVE:Symbol("ACTIVE"),INACTIVE:Symbol("INACTIVE"),INCORRECT:Symbol("INCORRECT"),CORRECT:Symbol("CORRECT")},T=i.createClass({displayName:"GradedGroupAnswerBar",propTypes:{answerBarState:i.PropTypes.any.isRequired,apiOptions:o.propTypes,onCheckAnswer:i.PropTypes.func.isRequired,onNextQuestion:i.PropTypes.func},render:function(){var e=this.props,t=e.apiOptions,n=e.answerBarState,o=e.onCheckAnswer,a=e.onNextQuestion,u=r({},x.answerBar,{backgroundColor:n===b.CORRECT?g:"white",justifyContent:n!==b.CORRECT||a?"space-between":"center"}),c=r({},x.button,{backgroundColor:n===b.ACTIVE||n===b.CORRECT?m:f}),d=r({},x.text,{color:n===b.CORRECT?m:h}),v=n===b.INCORRECT?i.createElement("span",{style:d},i.createElement("span",{style:x.tryAgainIcon},i.createElement(s,l)),i.createElement("span",{style:{marginLeft:8}},i18n._("Keep trying"))):i.createElement("span",null);if(n!==b.CORRECT){var y=n===b.INCORRECT?i18n._("Try again"):i18n._("Check");return i.createElement("div",{style:u},v,i.createElement("button",{style:c,disabled:t.readOnly||n!==b.ACTIVE,onClick:o},y))}return i.createElement("div",{style:u},i.createElement("span",{style:d},i.createElement("span",{style:{fontSize:28,color:"#FFB300"}},i.createElement(s,r({},p,{style:{marginBottom:5}}))),i.createElement("span",{style:{marginLeft:8}},i18n._("Correct!"))),a&&i.createElement("button",{style:c,onClick:a},i18n._("Next question")))}}),P=17,x={answerBar:{display:"flex",alignItems:"center",height:68,marginLeft:y,marginRight:y,marginBottom:y,marginTop:v,paddingLeft:v,paddingRight:10,borderTop:"1px solid "+d},button:{height:48,width:143,borderRadius:4,color:"white",fontFamily:c,fontSize:P,border:"none"},tryAgainIcon:{fontSize:28,color:"#63D9EA",transform:"scale(-1,1) rotate(-268deg)"},text:{display:"flex",flexDirection:"row",alignItems:"center",fontFamily:c,fontSize:P}};T.ANSWER_BAR_STATES=b,e.exports=T},function(e,t,n){"use strict";function r(e,t){return Math.floor((e[1]-e[0])/t)}var i=n(10),o=n(11),s=n(9),a=n(16),p=n(102),l=n(36),u=l.interactiveSizes,c=n(32),h={url:null},d={fontStyle:"italic",fontWeight:"bold",fontSize:"32px",width:"100%",height:"100%",textAlign:"center",backgroundColor:"white",position:"absolute",zIndex:1,transition:"opacity .25s ease-in-out","-moz-transition":"opacity .25s ease-in-out","-webkit-transition":"opacity .25s ease-in-out"},f={position:"relative",top:"25%"},g=i.createClass({displayName:"Graph",propTypes:{box:i.PropTypes.array.isRequired,labels:i.PropTypes.arrayOf(i.PropTypes.string),range:i.PropTypes.arrayOf(i.PropTypes.arrayOf(i.PropTypes.number)),step:i.PropTypes.arrayOf(i.PropTypes.number),gridStep:i.PropTypes.arrayOf(i.PropTypes.number),snapStep:i.PropTypes.arrayOf(i.PropTypes.number),markings:i.PropTypes.string,backgroundImage:i.PropTypes.shape({url:i.PropTypes.string}),showProtractor:i.PropTypes.bool,showRuler:i.PropTypes.bool,rulerLabel:i.PropTypes.string,rulerTicks:i.PropTypes.number,onGraphieUpdated:i.PropTypes.func,instructions:i.PropTypes.string,onClick:i.PropTypes.func,setDrawingAreaAvailable:i.PropTypes.func,isMobile:i.PropTypes.bool},getDefaultProps:function(){return{labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],snapStep:[.5,.5],markings:"graph",backgroundImage:h,showProtractor:!1,showRuler:!1,rulerLabel:"",rulerTicks:10,instructions:null,onGraphieUpdated:null,onClick:null,onMouseDown:null,isMobile:!1}},render:function(){var e,t=this.props.backgroundImage;if(t.url){var n=this.props.box[0]/u.defaultBoxSize;e=i.createElement(c,{src:t.url,width:t.width,height:t.height,scale:n,responsive:!1})}else e=null;return i.createElement("div",{className:"graphie-container above-scratchpad",style:{width:this.props.box[0],height:this.props.box[1]},onMouseOut:this.onMouseOut,onMouseOver:this.onMouseOver,onClick:this.onClick},e,i.createElement("div",{className:"graphie",ref:"graphieDiv"}))},componentDidMount:function(){this._setupGraphie(!0)},componentDidUpdate:function(){this._hasSetupGraphieThisUpdate=!1,this._shouldSetupGraphie&&(this._setupGraphie(!1),this._shouldSetupGraphie=!1)},componentWillReceiveProps:function(e){var t=["labels","range","step","markings","showProtractor","showRuler","rulerLabel","rulerTicks","gridStep","snapStep"],n=this;s.each(t,function(t){s.isEqual(n.props[t],e[t])||(n._shouldSetupGraphie=!0)})},reset:function(){this._setupGraphie(!1)},graphie:function(){return this._graphie},pointsFromNormalized:function(e,t){var n=this;return s.map(e,function(e){return s.map(e,function(e,i){var o=n.props.range[i];if(t)return o[0]+(o[1]-o[0])*e;var s=n.props.step[i],a=r(o,s),p=Math.round(e*a);return o[0]+s*p})})},_setupGraphie:function(e){if(!this._hasSetupGraphieThisUpdate){var t=o.findDOMNode(this.refs.graphieDiv);$(t).empty();var n=this.props.labels,r=this.props.range,i=this._graphie=p.createGraphie(t),a=this._getGridConfig();i.snap=this.props.snapStep,"graph"===this.props.markings?(i.graphInit({range:r,scale:s.pluck(a,"scale"),axisArrows:"<->",labelFormat:function(e){return"\\small{"+e+"}"},gridStep:this.props.gridStep,tickStep:s.pluck(a,"tickStep"),labelStep:1,unityLabels:s.pluck(a,"unityLabel"),isMobile:this.props.isMobile}),i.label([0,r[1][1]],n[1],this.props.isMobile?"below right":"above"),i.label([r[0][1],0],n[0],this.props.isMobile?"above left":"right")):"grid"===this.props.markings?i.graphInit({range:r,scale:s.pluck(a,"scale"),gridStep:this.props.gridStep,axes:!1,ticks:!1,labels:!1,isMobile:this.props.isMobile}):"none"===this.props.markings&&i.init({range:r,scale:s.pluck(a,"scale"),isMobile:this.props.isMobile});var l,u=.5,c=0;if(this.props.instructions){var l=$("<div/>");s.each(d,function(e,t){l.css(t,e)}),l.css("opacity",u);var h=$("<span/>",{text:this.props.instructions});s.each(f,function(e,t){h.css(t,e)}),l.append(h),$(t).append(l)}else l=void 0;var g=l||this.props.onMouseDown?s.bind(function(e){l&&(l.remove(),l=null),this.props.onMouseDown(e)},this):null,m=l?function(){l&&l.css("opacity",c)}:null,v=l?function(){l&&l.css("opacity",u)}:null;i.addMouseLayer({onClick:this.props.onClick,onMouseDown:g,onMouseOver:m,onMouseOut:v,onMouseUp:this.props.onMouseUp,onMouseMove:this.props.onMouseMove,allowScratchpad:!0,setDrawingAreaAvailable:this.props.setDrawingAreaAvailable}),this._updateProtractor(),this._updateRuler(),this._hasSetupGraphieThisUpdate=!0,!e&&this.props.onGraphieUpdated&&this.props.onGraphieUpdated(i)}},_getGridConfig:function(){var e=this;return s.map(e.props.step,function(t,n){return a.gridDimensionConfig(t,e.props.range[n],e.props.box[n],e.props.gridStep[n])})},_updateProtractor:function(){if(this.protractor&&this.protractor.remove(),this.props.showProtractor){var e=this.pointsFromNormalized([[.5,.05]])[0];this.protractor=this._graphie.protractor(e)}},_updateRuler:function(){if(this.ruler&&this.ruler.remove(),this.props.showRuler){var e=this.pointsFromNormalized([[.5,.25]])[0],t=this._graphie.range[0][1]-this._graphie.range[0][0];this.ruler=this._graphie.ruler({center:e,label:this.props.rulerLabel,pixelsPerUnit:this._graphie.scale[0],ticksPerUnit:this.props.rulerTicks,units:Math.round(.8*t)})}},toJSON:function(){return s.pick(this.props,"range","step","markings","labels","backgroundImage","showProtractor","showRuler","rulerLabel","rulerTicks","gridStep","snapStep")}});e.exports=g},function(e,t,n){"use strict";var r=n(10),i=n(134),o=r.createClass({displayName:"InfoTip",getInitialState:function(){return{didMount:!1}},componentDidMount:function(){this.setState({didMount:!0})},render:function(){return this.state.didMount?r.createElement(i,this.props):r.createElement("div",null)}});e.exports=o},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(12),o=n(10),s=n(11),a=n(9),p=n(16).firstNumericalParse,l=n(16).captureScratchpadTouchStart,u=n(123).number,c=n(78),h=c.toNumericString,d=c.getNumericFormat,f=o.createClass({displayName:"NumberInput",propTypes:{value:o.PropTypes.number,format:o.PropTypes.string,placeholder:o.PropTypes.oneOfType([o.PropTypes.string,o.PropTypes.number]),onChange:o.PropTypes.func.isRequired,onFormatChange:o.PropTypes.func,checkValidity:o.PropTypes.func,size:o.PropTypes.string,label:o.PropTypes.oneOf(["put your labels outside your inputs!"])},getDefaultProps:function(){return{value:null,placeholder:null,format:null,onFormatChange:function(){return null},checkValidity:function(){return!0},useArrowKeys:!1}},getInitialState:function(){return{format:this.props.format}},render:function(){var e=i({"number-input":!0,"invalid-input":!this._checkValidity(this.props.value),mini:"mini"===this.props.size,small:"small"===this.props.size,normal:"normal"===this.props.size});return null!=this.props.className&&(e=e+" "+this.props.className),o.createElement("input",r({},this.props,{className:e,type:"text",ref:"input",onChange:this._handleChange,onFocus:this._handleFocus,onBlur:this._handleBlur,onKeyPress:this._handleBlur,onKeyDown:this._onKeyDown,onTouchStart:l,defaultValue:h(this.props.value,this.state.format),value:void 0}))},componentDidUpdate:function(e){u.equal(this.getValue(),this.props.value)||this._setValue(this.props.value,this.state.format)},getValue:function(){return this.parseInputValue(s.findDOMNode(this.refs.input).value)},getStringValue:function(){return s.findDOMNode(this.refs.input).value.toString()},parseInputValue:function(e){if(""===e){var t=this.props.placeholder;return a.isFinite(t)?+t:null}var n=p(e);return a.isFinite(n)?n:this.props.value},focus:function(){s.findDOMNode(this.refs.input).focus(),this._handleFocus()},blur:function(){s.findDOMNode(this.refs.input).blur(),this._handleBlur()},setSelectionRange:function(e,t){s.findDOMNode(this).setSelectionRange(e,t)},getSelectionStart:function(){return s.findDOMNode(this).selectionStart},getSelectionEnd:function(){return s.findDOMNode(this).selectionEnd},_checkValidity:function(e){if(null==e)return!0;var t=p(e),n=this.props.checkValidity;return a.isFinite(t)&&n(t)},_handleChange:function(e){var t=e.target.value,n=this.parseInputValue(t),r=d(t);this.props.onChange(n),r&&(this.props.onFormatChange(n,r),this.setState({format:r}))},_handleFocus:function(){this.props.onFocus&&this.props.onFocus()},_handleBlur:function(e){e&&"keypress"===e.type&&13!==e.keyCode||(this._setValue(this.props.value,this.state.format),this.props.onBlur&&this.props.onBlur())},_onKeyDown:function(e){if(this.props.onKeyDown&&this.props.onKeyDown(e),this.props.useArrowKeys&&a.contains(["ArrowUp","ArrowDown"],e.key)){var t=this.getValue();t===Math.floor(t)&&("ArrowUp"===e.key?t+=1:"ArrowDown"===e.key&&(t-=1),this._checkValidity(t)&&this.props.onChange(t))}},_setValue:function(e,t){$(s.findDOMNode(this.refs.input)).val(h(e,t))}});e.exports=f},,,,,function(e,t,n){"use strict";var r=n(10),i=n(11),o=n(9),s=n(16),a=n(8),p=n(17).ClassNames,l="perseus-sortable",u=r.createClass({displayName:"Placeholder",propTypes:{width:r.PropTypes.number.isRequired,height:r.PropTypes.number.isRequired},render:function(){var e=[l+"-card",l+"-placeholder"].join(" "),t={width:this.props.width,height:this.props.height};return null!=this.props.margin&&(t.margin=this.props.margin),r.createElement("li",{className:e,style:t})}}),c="static",h="dragging",d="animating",f="disabled",g=r.createClass({displayName:"Draggable",propTypes:{type:r.PropTypes.oneOf([c,h,d,f]),content:r.PropTypes.string.isRequired,endPosition:r.PropTypes.object.isRequired,onRender:r.PropTypes.func.isRequired,onMouseDown:r.PropTypes.func.isRequired,onMouseMove:r.PropTypes.func.isRequired,onMouseUp:r.PropTypes.func.isRequired,onAnimationEnd:r.PropTypes.func.isRequired},getDefaultProps:function(){return{type:c}},getInitialState:function(){return{startPosition:{left:0,top:0},startMouse:{left:0,top:0},mouse:{left:0,top:0}}},componentDidMount:function(){this.isMouseMoveUpBound=!1},componentWillUnmount:function(){this.isMouseMoveUpBound&&this.unbindMouseMoveUp()},getCurrentPosition:function(){return{left:this.state.startPosition.left+this.state.mouse.left-this.state.startMouse.left,top:this.state.startPosition.top+this.state.mouse.top-this.state.startMouse.top}},render:function(){var e=[l+"-card",l+"-draggable",l+"-"+this.props.type,p.INTERACTIVE].join(" "),t={position:"static"};return this.props.type!==h&&this.props.type!==d||o.extend(t,{position:"absolute"},this.getCurrentPosition()),this.props.width&&(t.width=this.props.width+1),this.props.height&&(t.height=this.props.height),null!=this.props.margin&&(t.margin=this.props.margin),r.createElement("li",{className:e,style:t,onMouseDown:this.onMouseDown,onTouchStart:this.onMouseDown,onTouchMove:this.onMouseMove,onTouchEnd:this.onMouseUp,onTouchCancel:this.onMouseUp},r.createElement(a,{content:this.props.content,onRender:this.props.onRender}))},componentDidUpdate:function(e){if(this.props.type!==e.type)if(this.props.type===d){var t=this.getCurrentPosition(),n=15*Math.sqrt(Math.sqrt(Math.pow(this.props.endPosition.left-t.left,2)+Math.pow(this.props.endPosition.top-t.top,2)));$(i.findDOMNode(this)).animate(this.props.endPosition,{duration:Math.max(n,1),complete:this.props.onAnimationEnd})}else this.props.type===c&&$(i.findDOMNode(this)).finish()},bindMouseMoveUp:function(){this.isMouseMoveUpBound=!0,$(document).on("mousemove",this.onMouseMove),$(document).on("mouseup",this.onMouseUp)},unbindMouseMoveUp:function(){this.isMouseMoveUpBound=!1,$(document).off("mousemove",this.onMouseMove),$(document).off("mouseup",this.onMouseUp)},onMouseDown:function(e){if(this.props.type===c&&(0===e.button||null!=e.touches&&1===e.touches.length)){e.preventDefault();var t=s.extractPointerLocation(e);t&&this.setState({startPosition:$(i.findDOMNode(this)).position(),startMouse:t,mouse:t},function(){this.bindMouseMoveUp(),this.props.onMouseDown()})}},onMouseMove:function(e){if(this.props.type===h){e.preventDefault();var t=s.extractPointerLocation(e);t&&this.setState({mouse:t},this.props.onMouseMove)}},onMouseUp:function(e){if(this.props.type===h){e.preventDefault();var t=s.extractPointerLocation(e);t&&(this.unbindMouseMoveUp(),this.props.onMouseUp())}}}),m="horizontal",v="vertical",y=r.createClass({displayName:"Sortable",propTypes:{options:r.PropTypes.array.isRequired,layout:r.PropTypes.oneOf([m,v]),padding:r.PropTypes.bool,disabled:r.PropTypes.bool,constraints:r.PropTypes.object,onMeasure:r.PropTypes.func,margin:r.PropTypes.number,onChange:r.PropTypes.func},getDefaultProps:function(){return{layout:m,padding:!0,disabled:!1,constraints:{},onMeasure:function(){},margin:5,onChange:function(){}}},getInitialState:function(){return{items:this.itemsFromProps(this.props)}},componentWillReceiveProps:function(e){var t=this.props;o.isEqual(e.options,t.options)?e.layout===t.layout&&e.padding===t.padding&&e.disabled===t.disabled&&o.isEqual(e.constraints,t.constraints)||this.setState({items:this.clearItemMeasurements(this.state.items)}):this.setState({items:this.itemsFromProps(e)})},componentDidUpdate:function(e){this.state.items.length&&!this.state.items[0].width&&this.measureItems()},itemsFromProps:function(e){var t=e.disabled?f:c;return o.map(e.options,function(e,n){return{option:e,key:n,type:t,endPosition:{},width:0,height:0}})},clearItemMeasurements:function(e){return o.map(e,function(e){return o.extend(e,{width:0,height:0})})},measureItems:function(){var e,t=this,n=o.clone(this.state.items),r=o.map(n,function(e){return $(i.findDOMNode(this.refs[e.key]))},this),s=o.invoke(r,"outerWidth"),a=o.invoke(r,"outerHeight"),p=this.props.constraints,l=this.props.layout;p.width?e=o.max(s.concat(p.width)):l===v&&(e=o.max(s));var u;p.height?u=o.max(a.concat(p.height)):l===m&&(u=o.max(a)),n=o.map(n,function(t,n){return t.width=e||s[n],t.height=u||a[n],t}),this.setState({items:n},function(){t.props.onMeasure({widths:s,heights:a})})},remeasureItems:o.debounce(function(){this.setState({items:this.clearItemMeasurements(this.state.items)},this.measureItems)},20),render:function(){var e=[l,"layout-"+this.props.layout].join(" "),t=[];return e+=this.props.padding?"":" unpadded",o.each(this.state.items,function(e,n,i){var o,s=n===i.length-1,a=e.type===c||e.type===f;this.props.layout===m?o="0 "+this.props.margin+"px 0 0":this.props.layout===v&&(o="0 0 "+this.props.margin+"px 0"),t.push(r.createElement(g,{content:e.option,key:e.key,type:e.type,ref:e.key,width:e.width,height:e.height,margin:s&&a?0:o,endPosition:e.endPosition,onRender:this.remeasureItems,onMouseDown:this.onMouseDown.bind(this,e.key),onMouseMove:this.onMouseMove.bind(this,e.key),onMouseUp:this.onMouseUp.bind(this,e.key),onTouchMove:this.onMouseMove.bind(this,e.key),onTouchEnd:this.onMouseUp.bind(this,e.key),onTouchCancel:this.onMouseUp.bind(this,e.key),onAnimationEnd:this.onAnimationEnd.bind(this,e.key)})),e.type!==h&&e.type!==d||t.push(r.createElement(u,{key:"placeholder_"+e.key,ref:"placeholder_"+e.key,width:e.width,height:e.height,margin:s?0:o}))},this),r.createElement("ul",{className:e},t)},onMouseDown:function(e){var t=o.map(this.state.items,function(t){return t.key===e&&(t.type=h),t});this.setState({items:t})},onMouseMove:function(e){var t=$(i.findDOMNode(this.refs[e])),n=$(i.findDOMNode(this)),r=o.clone(this.state.items),s=o.findWhere(this.state.items,{key:e}),a=this.props.margin,p=o.indexOf(r,s),l=0;if(r.splice(p,1),this.props.layout===m){var u,c=t.offset().left-n.offset().left,h=0;o.each(r,function(e){u=e.width,c>h+u/2&&(l+=1),h+=u+a})}else{var d,f=t.offset().top-n.offset().top,g=0;o.each(r,function(e){d=e.height,f>g+d/2&&(l+=1),g+=d+a})}l!==p&&(r.splice(l,0,s),this.setState({items:r}))},onMouseUp:function(e){var t=o.map(this.state.items,function(t){return t.key===e&&(t.type=d,t.endPosition=$(i.findDOMNode(this.refs["placeholder_"+e])).position()),t},this);this.setState({items:t}),this.props.onChange({})},onAnimationEnd:function(e){var t=o.map(this.state.items,function(t){return t.key===e&&(t.type=c),t});this.setState({items:t})},getOptions:function(){return o.pluck(this.state.items,"option")}});e.exports=y},function(e,t,n){"use strict";function r(e){this.order=p(e),this.mantissa=a(e),this.positive=s(e),this.sigFigs=this.mantissa.length,this.sigDecs=this.order-this.mantissa.length}function i(e,t,n,r){var i,u,c,h=""+e,d=p(h),f=a(h),g=s(h),m=!1;if(0==e||""==f||"0"==f){for(f="",C=0;C<t;C++)f+="0";d=t+n,n<0&&-n>=t&&(m=!0)}else{if(u=d-f.length-n,c=t-f.length,i=Math.min(c,u),i<0){var v=l(f,-i);v.length>f.length+i&&(d++,u>c&&(v=l(v,1))),f=v}else if(i>0)for(C=0;C<i;C++)f+="0";""!=f&&"0"!=f||(f="0",g=!0,d=1+n,0!=d&&(m=!0))}var y=r||f.length>20||d>4||d<-2||d-f.length>0&&o(f)>0||m,b="";if(g||(b+="-"),y)b+=f.charAt(0),f.length>1&&(b+="."+f.substring(1,f.length)),d-1!=0&&(b+=" x 10^"+(d-1));else{var T="",P="",x=!0;if(d>0)if(f.length>d)T=f.substring(0,d),P=f.substring(d,f.length);else{T=f,x=0!=o(f);for(var C=0;C<d-f.length;C++)T+="0"}else{for(C=0;C<-d;C++)P+="0";P+=f}b+=(""==T?"0":T)+(x?".":"")+P}return b}function o(e){for(var t=0,n=e.length-1;n>=0;n--){var r=e.charAt(n);if("0"!=r)return t;t++}return t}function s(e){for(var t=!0,n=!1,r=!1,i="",o="",s="",a=0,p=0,l=!0,u=0;u<e.length;u++){var c=e.charAt(u);if(c>="1"&&c<="9")s+=i+c,i="",r=!0,n||(p++,a++),t=!1;else if("0"==c)n?r?(s+=i+c,i=""):(o+=c,a--):(p++,r?(o+=c,a++,i+=c):o+=c),t=!1;else if(n||"."!=c)if("e"==c||"E"==c&&u+1<e.length){var h=parseInt(e.substring(u+1,e.length));a+=h,p+=h,u=e.length}else!t||"+"!=c&&"-"!=c||"-"==c&&(l=!l);else s+=i,i="",n=!0,t=!1}return""==s||l}function a(e){for(var t=!0,n=!1,r=!1,i="",o="",s="",a=0,p=0,l=!0,u=0;u<e.length;u++){var c=e.charAt(u);if(c>="1"&&c<="9")s+=i+c,i="",r=!0,n||(p++,a++),t=!1;else if("0"==c)n?r?(s+=i+c,i=""):(o+=c,a--):(p++,r?(o+=c,a++,i+=c):o+=c),t=!1;else if(n||"."!=c)if("e"==c||"E"==c&&u+1<e.length){var h=parseInt(e.substring(u+1,e.length));a+=h,p+=h,u=e.length}else!t||"+"!=c&&"-"!=c||"-"==c&&(l=!l);else s+=i,i="",n=!0,t=!1}return""==s?o:s}function p(e){for(var t=!0,n=!1,r=!1,i="",o="",s="",a=0,p=0,l=!0,u=0;u<e.length;u++){var c=e.charAt(u);if(c>="1"&&c<="9")s+=i+c,i="",r=!0,n||(p++,a++),t=!1;else if("0"==c)n?r?(s+=i+c,i=""):(o+=c,a--):(p++,r?(o+=c,a++,i+=c):o+=c),t=!1;else if(n||"."!=c)if("e"==c||"E"==c&&u+1<e.length){var h=parseInt(e.substring(u+1,e.length));a+=h,p+=h,u=e.length}else!t||"+"!=c&&"-"!=c||"-"==c&&(l=!l);else s+=i,i="",n=!0,t=!1}return""==s?p:a}function l(e,t){var n=e.length-t-1;if(n<0)return"";if(n>=e.length-1)return e;var r=e.charAt(n+1),i=e.charAt(n),o=!1;if(r>"5")o=!0;else if("5"==r){for(var s=n+2;s<e.length;s++)"0"!=e.charAt(s)&&(o=!0);i%2==1&&(o=!0)}for(var a="",p=n;p>=0;p--){var l=e.charAt(p);if(o){var u;if("9"==l)u="0";else{switch(l){case"0":u="1";break;case"1":u="2";break;case"2":u="3";break;case"3":u="4";break;case"4":u="5";break;case"5":u="6";break;case"6":u="7";break;case"7":u="8";break;case"8":u="9"}o=!1}a=u+a}else a=l+a}return o&&(a="1"+a),a}e.exports={SignificantFigures:r,displaySigFigs:i}},,,,,function(e,t,n){"use strict";function r(e){var t=e[0],n=e[1],r=e[2],i=e[3];t<0&&(t*=-1,n*=-1,r*=-1);var o=2*Math.PI;for(n<0&&(n*=-1,r*=-1,r+=o/2);r>0;)r-=o;for(;r<0;)r+=o;return[t,n,r,i]}function i(e){var t=e[0],n=e[1],r=e[2],i=e[3];t<0&&(t*=-1,n*=-1,r*=-1);var o=Math.PI;for(n<0&&(n*=-1,r*=-1,r+=o/2);r>0;)r-=o;for(;r<0;)r+=o;return[t,n,r,i]}function o(e){return P[e]}function s(e){var t=e.charAt(0).toUpperCase()+e.substring(1);return{value:e,title:t,content:React.createElement("img",{src:o(e).url,alt:t})}}var a=n(9),p=n(16),l=n(86),u=l.Plot,c=n(123).point,h={url:null},d={areEqual:function(e,t){return p.deepEq(e,t)},Movable:u,getPropsForCoeffs:function(e){return{fn:a.partial(this.getFunctionForCoeffs,e)}}},f=a.extend({},d,{url:"https://ka-perseus-graphie.s3.amazonaws.com/67aaf581e6d9ef9038c10558a1f70ac21c11c9f8.png",defaultCoords:[[.25,.75],[.75,.75]],getCoefficients:function(e){var t=e[0],n=e[1],r=n[0]-t[0],i=n[1]-t[1];if(0!==r){var o=i/r,s=n[1]-o*n[0];return[o,s]}},getFunctionForCoeffs:function(e,t){var n=e[0],r=e[1];return n*t+r},getEquationString:function(e){var t=this.getCoefficients(e),n=t[0],r=t[1];return"y = "+n.toFixed(3)+"x + "+r.toFixed(3)}}),g=a.extend({},d,{url:"https://ka-perseus-graphie.s3.amazonaws.com/e23d36e6fc29ee37174e92c9daba2a66677128ab.png",defaultCoords:[[.5,.5],[.75,.75]],Movable:l.Parabola,getCoefficients:function(e){var t=e[0],n=e[1],r=t[0],i=t[1],o=(n[1]-i)/((n[0]-r)*(n[0]-r)),s=-2*r*o,a=o*r*r+i;return[o,s,a]},getFunctionForCoeffs:function(e,t){var n=e[0],r=e[1],i=e[2];return(n*t+r)*t+i},getPropsForCoeffs:function(e){return{a:e[0],b:e[1],c:e[2]}},getEquationString:function(e){var t=this.getCoefficients(e),n=t[0],r=t[1],i=t[2];return"y = "+n.toFixed(3)+"x^2 + "+r.toFixed(3)+"x + "+i.toFixed(3)}}),m=a.extend({},d,{url:"https://ka-perseus-graphie.s3.amazonaws.com/3d68e7718498475f53b206c2ab285626baf8857e.png",defaultCoords:[[.5,.5],[.6,.6]],Movable:l.Sinusoid,getCoefficients:function(e){var t=e[0],n=e[1],r=n[1]-t[1],i=Math.PI/(2*(n[0]-t[0])),o=t[0]*i,s=t[1];return[r,i,o,s]},getFunctionForCoeffs:function(e,t){var n=e[0],r=e[1],i=e[2],o=e[3];return n*Math.sin(r*t-i)+o},getPropsForCoeffs:function(e){return{a:e[0],b:e[1],c:e[2],d:e[3]}},getEquationString:function(e){var t=this.getCoefficients(e),n=t[0],r=t[1],i=t[2],o=t[3];return"y = "+n.toFixed(3)+" sin("+r.toFixed(3)+"x - "+i.toFixed(3)+") + "+o.toFixed(3)},areEqual:function(e,t){return p.deepEq(r(e),r(t))}}),v=a.extend({},d,{url:"https://ka-perseus-graphie.s3.amazonaws.com/7db80d23c35214f98659fe1cf0765811c1bbfbba.png",defaultCoords:[[.5,.5],[.75,.75]],getCoefficients:function(e){var t=e[0],n=e[1],r=n[1]-t[1],i=Math.PI/(4*(n[0]-t[0])),o=t[0]*i,s=t[1];return[r,i,o,s]},getFunctionForCoeffs:function(e,t){var n=e[0],r=e[1],i=e[2],o=e[3];return n*Math.tan(r*t-i)+o},getEquationString:function(e){var t=this.getCoefficients(e),n=t[0],r=t[1],i=t[2],o=t[3];return"y = "+n.toFixed(3)+" sin("+r.toFixed(3)+"x - "+i.toFixed(3)+") + "+o.toFixed(3)},areEqual:function(e,t){return p.deepEq(i(e),i(t))}}),y=a.extend({},d,{url:"https://ka-perseus-graphie.s3.amazonaws.com/9cbfad55525e3ce755a31a631b074670a5dad611.png",defaultCoords:[[.5,.55],[.75,.75]],defaultAsymptote:[[0,.5],[1,.5]],extraCoordConstraint:function(e,t,n,r,i){var o=a.head(r)[1];return a.all(n,function(e){return e[1]!==o})},extraAsymptoteConstraint:function(e,t,n,r,i){var o=e[1],s=a.all(n,function(e){return e[1]>o})||a.all(n,function(e){return e[1]<o});if(s)return[t[0],o];var p=t[1],l=a.all(n,function(e){return e[1]>p});if(l){var u=a.min(a.map(n,function(e){return e[1]}));return[t[0],u-i.snapStep[1]]}var c=a.max(a.map(n,function(e){return e[1]}));return[t[0],c+i.snapStep[1]]},allowReflectOverAsymptote:!0,getCoefficients:function(e,t){var n=e[0],r=e[1],i=a.head(t)[1],o=Math.log((n[1]-i)/(r[1]-i))/(n[0]-r[0]),s=(n[1]-i)/Math.exp(o*n[0]);return[s,o,i]},getFunctionForCoeffs:function(e,t){var n=e[0],r=e[1],i=e[2];return n*Math.exp(r*t)+i},getEquationString:function(e,t){if(!t)return null;var n=this.getCoefficients(e,t),r=n[0],i=n[1],o=n[2];return"y = "+r.toFixed(3)+"e^("+i.toFixed(3)+"x) + "+o.toFixed(3)}}),b=a.extend({},d,{url:"https://ka-perseus-graphie.s3.amazonaws.com/f6491e99d34af34d924bfe0231728ad912068dc3.png",defaultCoords:[[.55,.5],[.75,.75]],defaultAsymptote:[[.5,0],[.5,1]],extraCoordConstraint:function(e,t,n,r,i){var o=a.head(r)[0];return a.all(n,function(e){return e[0]!==o})&&n[0][1]!==n[1][1]},extraAsymptoteConstraint:function(e,t,n,r,i){var o=e[0],s=a.all(n,function(e){return e[0]>o})||a.all(n,function(e){return e[0]<o});if(s)return[o,t[1]];var p=t[0],l=a.all(n,function(e){return e[0]>p});if(l){var u=a.min(a.map(n,function(e){return e[0]}));return[u-i.snapStep[0],t[1]]}var c=a.max(a.map(n,function(e){return e[0]}));return[c+i.snapStep[0],t[1]]},allowReflectOverAsymptote:!0,getCoefficients:function(e,t){var n=function(e){return[e[1],e[0]]},r=y.getCoefficients(a.map(e,n),a.map(t,n)),i=-r[2]/r[0],o=1/r[0],s=1/r[1];return[s,o,i]},getFunctionForCoeffs:function(e,t,n){var r=e[0],i=e[1],o=e[2];return r*Math.log(i*t+o)},getEquationString:function(e,t){if(!t)return null;var n=this.getCoefficients(e,t),r=n[0],i=n[1],o=n[2];return"y = ln("+r.toFixed(3)+"x + "+i.toFixed(3)+") + "+o.toFixed(3)}}),T=a.extend({},d,{url:"https://ka-perseus-graphie.s3.amazonaws.com/8256a630175a0cb1d11de223d6de0266daf98721.png",defaultCoords:[[.5,.5],[.75,.75]],getCoefficients:function(e){var t=e[0],n=e[1],r=n[0]-t[0],i=n[1]-t[1];if(0!==r){var o=Math.abs(i/r);n[1]<t[1]&&(o*=-1);var s=t[0],a=t[1];return[o,s,a]}},getFunctionForCoeffs:function(e,t){var n=e[0],r=e[1],i=e[2];return n*Math.abs(t-r)+i},getEquationString:function(e){var t=this.getCoefficients(e),n=t[0],r=t[1],i=t[2];return"y = "+n.toFixed(3)+"| x - "+r.toFixed(3)+"| + "+i.toFixed(3)}}),P={linear:f,quadratic:g,sinusoid:m,tangent:v,exponential:y,logarithm:b,absolute_value:T},x=a.keys(P),C={validate:function(e,t){if(e.type!==t.correct.type)return{type:"points",earned:0,total:1,message:null};if(null==e.coords)return{type:"invalid",message:null};var n=o(e.type),r=n.getCoefficients(e.coords,e.asymptote),i=n.getCoefficients(t.correct.coords,t.correct.asymptote);
return null==r||null==i?{type:"invalid",message:null}:n.areEqual(r,i)?{type:"points",earned:1,total:1,message:null}:{type:"points",earned:0,total:1,message:null}},getEquationString:function(e){var t=e.plot;if(t.type&&t.coords){var n=o(t.type),r=n.getEquationString(t.coords,t.asymptote);return r||""}return""},pointsFromNormalized:function(e,t,n,r){var i=function(e,t){return Math.floor((e[1]-e[0])/t)};return a.map(e,function(e){var o=a.map(e,function(e,r){var o=t[r],s=n[r],a=i(o,s),p=Math.round(e*a);return o[0]+s*p});return c.roundTo(o,r)})},maybePointsFromNormalized:function(e,t,n,r){return e?this.pointsFromNormalized(e,t,n,r):e},defaultPlotProps:function(e,t){var n=o(e),r=[1,1],i=p.snapStepFromGridStep(r);return{type:e,asymptote:this.maybePointsFromNormalized(n.defaultAsymptote,t.range,t.step,i),coords:null}},chooseType:a.first,getGridAndSnapSteps:function(e,t){var n=e.gridStep||p.getGridStep(e.range,e.step,t),r=e.snapStep||p.snapStepFromGridStep(n);return{gridStep:n,snapStep:r}}},E={};E.graph={labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],backgroundImage:h,markings:"graph",rulerLabel:"",rulerTicks:10,valid:!0,showTooltips:!1},E.plot=C.defaultPlotProps("linear",E.graph),E.availableTypes=[E.plot.type],e.exports={GrapherUtil:C,allTypes:x,typeToButton:s,functionForType:o,DEFAULT_GRAPHER_PROPS:E,DEFAULT_BACKGROUND_IMAGE:h}},function(e,t,n){"use strict";function r(e,t){null!==t.value&&(e.fillStyle=h.fgColor,e.font=h.font,e.fillText(t.value,t.pos[0]-h.fontSizePx/2+1,t.pos[1]+h.fontSizePx/2))}function i(e,t){var n=new Path2D;e.lineWidth=5*h.lineWidth,e.strokeStyle=h.fgColor,n.moveTo(t.startPos[0],t.startPos[1]),n.lineTo(t.endPos[0],t.endPos[1]),e.stroke(n),n=new Path2D,e.lineWidth=3*h.lineWidth,e.strokeStyle=h.bgColor,n.moveTo(t.startPos[0],t.startPos[1]),n.lineTo(t.endPos[0],t.endPos[1]),e.stroke(n)}function o(e,t){var n=new Path2D;e.lineWidth=7*h.lineWidth,e.strokeStyle=h.fgColor,n.moveTo(t.startPos[0],t.startPos[1]),n.lineTo(t.endPos[0],t.endPos[1]),e.stroke(n),n=new Path2D,e.lineWidth=5*h.lineWidth,e.strokeStyle=h.bgColor,n.moveTo(t.startPos[0],t.startPos[1]),n.lineTo(t.endPos[0],t.endPos[1]),e.stroke(n),s(e,t)}function s(e,t){var n=new Path2D;e.lineWidth=h.lineWidth,e.strokeStyle=h.fgColor,n.moveTo(t.startPos[0],t.startPos[1]),n.lineTo(t.endPos[0],t.endPos[1]),e.stroke(n)}function a(e){return function(t){u[t.type](e,t)}}function p(e,t){return c[e.type]-c[t.type]}function l(e,t){t.sort(p).forEach(a(e))}var u={text:r,"line:single":s,"line:double":i,"line:triple":o},c={"line:single":0,"line:double":0,"line:triple":0,text:1},h={bgColor:"rgb(255, 255, 255)",fgColor:"rgb(0, 0, 0)",fontSizePx:12,lineWidth:1};h.font=h.fontSizePx+"px sans",e.exports=l},function(e,t,n){"use strict";function r(e,t,n){var r=e[0],i=e[1];return[r+Math.cos(2*t*Math.PI/360)*n,i+-1*Math.sin(2*t*Math.PI/360)*n]}function i(e,t,n,i){var o=e.symbol;if("C"===o&&1!==Object.keys(t).length&&(o=null),"1,0"===e.idx){var s=[0,0];return e.pos=s,e.baseAngle=-30+i,{type:"text",value:o,pos:s,idx:e.idx}}var a=t[e.connections.find(function(e){return t[e].pos})],p=a.connections.indexOf(e.idx),l=60,u=120;4===a.connections.length?(u=90,l=90):(n.find(function(t){return"triple"===t.bondType&&t.to===e.idx})||n.find(function(e){return"triple"===e.bondType&&e.to===a.idx}))&&(u=0,l=0);var c=0,d=a.idx.split(":"),f=d[d.length-1].split(",")[0];c=parseInt(f)%2!==0?a.baseAngle-(l-u*p):a.baseAngle+(l-u*p);var g=r(a.pos,c,h);return e.pos=g,e.baseAngle=c,{type:"text",value:o,pos:g,idx:e.idx}}function o(e,t){var n=.25,r=[e.pos[0],e.pos[1]],i=[t.pos[0],t.pos[1]];return"C"!==e.symbol&&(r=[t.pos[0]-(1-n)*(t.pos[0]-e.pos[0]),t.pos[1]-(1-n)*(t.pos[1]-e.pos[1])]),"C"!==t.symbol&&(i=[e.pos[0]-(1-n)*(e.pos[0]-t.pos[0]),e.pos[1]-(1-n)*(e.pos[1]-t.pos[1])]),[r,i]}function s(e,t){var n=t[e.from],r=t[e.to],i=o(n,r);return{type:"line:"+e.bondType,startPos:i[0],endPos:i[1]}}function a(e){return e.join(":")}function p(e,t,n){return null===n?[e,t]:("atom"===n.type&&!function(){var r=a(n.idx);e[r]={idx:r,symbol:n.symbol,connections:[]},n.bonds&&n.bonds.forEach(function(n){var i=a(n.to.idx);e[r].connections.push(i),t.push({from:r,to:i,bondType:n.bondType}),p(e,t,n.to),e[i].connections.push(r)})}(),[e,t])}function l(e,t,n,r,o){if(0===t.length)return e;var s=t.shift(),a=n[s];return a.connections.forEach(function(e){n[e].pos||t.push(e)}),l(e.concat(i(a,n,r,o)),t,n,r,o)}function u(e,t,n){return 0===n.length?e:u(e.concat(s(n[0],t)),t,n.slice(1))}function c(e,t){var n=p({},[],e),r=n[0],i=n[1],o=l([],["1,0"],r,i,t);return u(o,r,i)}var h=30;e.exports={layout:c,_atomLayout:i,_bondLayout:s,_bondLength:h,_convertTree:p}},function(e,t,n){"use strict";function r(e){this.message=e}function i(e,t,n){var r=t[0],o=t.slice(1),s=void 0;s=Array.isArray(e)?[].concat(e):g({},e||{});var a=n;return o.length>0&&(a=i(s[r],o,n)),s[r]=a,s}function o(e,t){var n=t.reduce(function(e,t){return e[t]},e);return i(e,t,n+1)}function s(e){return m.test(e)}function a(e,t){var n=e[0],o=e.slice(1);if("="===n)return f(o,i(t,["bond","bondType"],"double"));if("#"===n)return f(o,i(t,["bond","bondType"],"triple"));throw new r("Invalid character: "+n)}function p(e,t){if(0===t.length)return e;if(""===e)throw new r("Mismatched parentheses");var n=e[0],i=e.slice(1);return"("===n?p(i,t.concat(n)):")"===n?p(i,t.slice(1)):p(i,t)}function l(e,t){var n=e[0],i=e.slice(1);if("("===n){var s=g({},t,{parens:t.parens+"("});s=o(t,["idx",t.idx.length-1,1]);var a=-1;t.idx[t.idx.length-1][0]%2===0&&(a=0);var l=g({},s,{idx:s.idx.concat([[a,0]]),parens:s.parens.concat("(")}),u=f(i,l),c=f(p(i,["("]),s);return[u].concat(c)}if(")"===n){if("("!==t.parens[t.parens.length-1])throw new r("Mismatched parentheses");return null}throw new r("Invalid bare character: "+n)}function u(e,t){var n=null,r=null;if("["===e[0]){var i=e.indexOf("]");if(i===-1)return["",e];n=e.slice(1,i),r=e.slice(i+1)}else{var o=v.exec(e);n=o[1],r=e.slice(n.length)}return[n,r]}function c(e,t){var n=u(e,t),r=n[0];if(""===r)return["error","Unable to parse bracketed atom."];var o=n[1],s=i(t,["idx",t.idx.length-1],[1+t.idx[t.idx.length-1][0],0]),a=f(o,i(s,["bond","bondType"],"single"));Array.isArray(a)||!a||(a=[a]);var p={type:"atom",symbol:r,bonds:a,idx:s.idx};return t.bond?{type:"bond",bondType:t.bond.bondType,to:p}:p}function h(e){return v.test(e)}function d(e){return"="===e||"#"===e}function f(e,t){if(!s(e))throw new r("Invalid input.");return e&&0!==e.length?h(e)?c(e,t||{idx:[[0,0]],parens:[],stack:[],bondModifiers:[]}):d(e[0])?a(e,t):l(e,t):null}var g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m=new RegExp("^[A-Za-z\\[\\]()=#+-]*$"),v=new RegExp("^(Cl|Br|[CONPSFBI]|\\[)");e.exports={parse:f,ParseError:r}},function(e,t,n){"use strict";var r=n(10),i=n(109),o=n(9),s="start-ref-",a="end-ref-",p={display:"inline-block",width:0,visibility:"hidden"},l={display:"inline",whiteSpace:"nowrap"},u={display:"inline-block",color:"rgb(255, 255, 255)",backgroundColor:"rgb(90, 90, 90)",paddingLeft:10,paddingRight:10,userSelect:"none",WebkitUserSelect:"none"},c={display:"inline-block",color:"rgb(255, 255, 255)",backgroundColor:"rgb(90, 90, 90)",userSelect:"none",WebkitUserSelect:"none",width:22,height:22,borderRadius:"50%",textAlign:"center"},h=r.createClass({displayName:"RefStart",propTypes:{refContent:r.PropTypes.node.isRequired},render:function(){return r.createElement("span",{style:p},"_")},getRefContent:function(){return this.props.refContent}}),d=r.createClass({displayName:"RefEnd",render:function(){return r.createElement("span",{style:p},"_")}}),f={newline:i.defaultRules.newline,paragraph:i.defaultRules.paragraph,escape:i.defaultRules.escape,passageFootnote:{order:i.defaultRules.escape.order+.1,match:i.inlineRegex(/^\^/),parse:function(e,t,n){var r=n.lastFootnote.id+1,i={id:r,text:1===r?"*":""+r};return"*"===n.lastFootnote.text&&(n.lastFootnote.text=""+n.lastFootnote.id),n.lastFootnote=i,i},react:function(e,t,n){return r.createElement("sup",{key:n.key},e.text)}},refStart:{order:i.defaultRules.escape.order+.2,match:function(e,t){var n=/^\{\{/.exec(e);if(n){for(var r=2,i=0;r<e.length;){var o=e.slice(r,r+2);if("{{"===o)i++,r++;else if("}}"===o){if(!(i>0))break;i--,r++}r++}var s=e.slice(2,r);return[n[0],s]}return null},parse:function(e,t,n){if(!n.useRefs)return{ref:null,refContent:null};var r=n.lastRef+1;n.lastRef=r,n.currentRef.push(r);var i=t("(â"+e[1]+"â)\n\n",o.defaults({useRefs:!1},g));return{ref:r,refContent:i}},react:function(e,t,n){if(null==e.ref)return null;var i=t(e.refContent,{});return r.createElement(h,{ref:s+e.ref,key:s+e.ref,refContent:i})}},refEnd:{order:i.defaultRules.escape.order+.3,match:i.inlineRegex(/^\}\}/),parse:function(e,t,n){if(!n.useRefs)return{ref:null};var r=n.currentRef.pop()||null;return{ref:r}},react:function(e,t,n){return null!=e.ref?r.createElement(d,{ref:a+e.ref,key:a+e.ref}):null}},squareLabel:{order:i.defaultRules.escape.order+.4,match:i.inlineRegex(/^\[\[(\w+)\]\]( *)/),parse:function(e,t,n){return n.firstQuestionRef||(n.firstQuestionRef=e[1]),{content:e[1],space:e[2].length>0}},react:function(e,t,n){return[r.createElement("span",{key:"visual-square",className:"perseus-passage-square-label",style:l,"aria-hidden":"true"},r.createElement("span",{style:u},e.content)),r.createElement("span",{key:"alt-text",className:"perseus-sr-only"},$_({number:e.content},"[Marker for question %(number)s]")),e.space?"Â ":null]}},circleLabel:{order:i.defaultRules.escape.order+.5,match:i.inlineRegex(/^\(\((\w+)\)\)( *)/),parse:function(e,t,n){return{content:e[1],space:e[2].length>0}},react:function(e,t,n){return[r.createElement("span",{key:"visual-circle",className:"perseus-passage-circle-label",style:l,"aria-hidden":!0},r.createElement("span",{style:c},e.content)),r.createElement("span",{key:"alt-text",className:"perseus-sr-only"},$_({number:e.content},"[Circle marker %(number)s]")),e.space?"Â ":null]}},squareBracketRef:{order:i.defaultRules.escape.order+.6,match:i.inlineRegex(/^\[(\d+)\]( *)/),parse:function(e,t,n){return n.firstSentenceRef||(n.firstSentenceRef=e[1]),{content:e[1],space:e[2].length>0}},react:function(e,t,n){return[r.createElement("span",{key:"visual-brackets",className:"perseus-passage-bracket-label","aria-hidden":"true"},"[",e.content,"]"),r.createElement("span",{key:"alt-text",className:"perseus-sr-only"},$_({number:e.content},"[Sentence %(number)s]")),e.space?"Â ":null]}},highlight:{order:i.defaultRules.escape.order+.7,match:i.inlineRegex(/^{highlighting.start}(.+?){highlighting.end}/),parse:function(e,t,n){return{content:e[1]}},react:function(e,t,n){return[r.createElement("span",{className:"perseus-highlight"},e.content)]}},reviewHighlight:{order:i.defaultRules.escape.order+.7,match:i.inlineRegex(/^{review-highlighting.start}(.+?){review-highlighting.end}/),parse:function(e,t,n){return{content:e[1]}},react:function(e,t,n){return[r.createElement("span",{className:"perseus-review-highlight"},e.content)]}},strong:i.defaultRules.strong,u:i.defaultRules.u,em:i.defaultRules.em,del:i.defaultRules.del,text:i.defaultRules.text},g={currentRef:[],useRefs:!0,lastRef:0,lastFootnote:{id:0,text:""}},m=i.parserFor(f),v=function(e,t){t=t||{};var n=e+"\n\n";return m(n,o.extend(t,g))};e.exports={parse:v,output:i.reactFor(i.ruleOutput(f,"react")),START_REF_PREFIX:s,END_REF_PREFIX:a,_rulesForTesting:f}},,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(13).StyleSheet,i=r.create({buttonStyle:{backgroundColor:"white",border:"1px solid #ccc",borderLeft:"0",cursor:"pointer",margin:"0",padding:"5px 10px",position:"relative",":first-child":{borderLeft:"1px solid #ccc",borderTopLeftRadius:"3px",borderBottomLeftRadius:"3px"},":last-child":{borderRight:"1px solid #ccc",borderTopRightRadius:"3px",borderBottomRightRadius:"3px"},":hover":{backgroundColor:"#ccc"},":focus":{zIndex:"2"}},selectedStyle:{backgroundColor:"#ddd"}});e.exports={button:i}},,function(e,t,n){"use strict";var r=n(13),i=r.StyleSheet,o=r.css,s=n(10),a=n(9),p={grayLight:"#aaa",basicBorderColor:"#ccc",white:"#fff"},l={borderBottom:"9px solid transparent",borderTop:"9px solid transparent",content:'" "',height:"0",position:"absolute",top:"0",width:"0"},u=i.create({infoTip:{display:"inline-block",marginLeft:"5px",position:"relative"},infoTipContainer:{position:"absolute",top:"-12px",left:"22px",zIndex:"1000"},infoTipTriangle:{height:"10px",left:"0",position:"absolute",top:"8px",width:"0",zIndex:"1",":before":a.extend({},l,{borderRight:"9px solid #bbb",right:"0"}),":after":a.extend({},l,{borderRight:"9px solid "+p.white,right:"-1px"})},verticalShadow:{border:"1px solid "+p.basicBorderColor,boxShadow:"0 1px 3px "+p.basicBorderColor,borderBottom:"1px solid "+p.grayLight},infoTipContentContainer:{background:p.white,padding:"5px 10px",width:"240px"}}),c="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3NpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo2N2M3NTAxYS04YmVlLTQ0M2MtYmRiNS04OGM2N2IxN2NhYzEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUJCRTk4Qjc4NjAwMTFFMzg3QUJDNEI4Mzk2QTRGQkQiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUJCRTk4QjY4NjAwMTFFMzg3QUJDNEI4Mzk2QTRGQkQiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NGE5ZDI0OTMtODk1NC00OGFkLTlhMTgtZDAwM2MwYWNjNDJlIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjY3Yzc1MDFhLThiZWUtNDQzYy1iZGI1LTg4YzY3YjE3Y2FjMSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pqm89uYAAADMSURBVHjaXJA9DoJAEIUH1M4TUHIFsCMGen9OwCGw1YRGW2ntKel0exsojHIBC0ouQAyUviFDstmXfNmZeS+zm7XSNCXRFiRgJf0bXIHixpbhGdxBBJYC1w/xaA424MhNEATkui71fU9KqfEU78UbD9PdbJRlOdae55GmhIP+1NV1TcMwkOM41DSNHvRtMhTHMRVFQW3b6mOLgx99kue5GRp/gIOZuZGvNpTNwjD8oliANU+qqqKu6/TQBdymN57AHjzBT+B6Jx79BRgAvc49kQA4yxgAAAAASUVORK5CYII=",h=s.createClass({displayName:"InfoTip",getInitialState:function(){return{hover:!1}},render:function(){return s.createElement("div",{className:o(u.infoTip)},s.createElement("img",{width:10,height:10,src:c,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave}),s.createElement("div",{className:o(u.infoTipContainer),style:{display:this.state.hover?"block":"none"}},s.createElement("div",{className:o(u.infoTipTriangle)}),s.createElement("div",{className:o(u.verticalShadow,u.infoTipContentContainer)},this.props.children)))},handleMouseEnter:function(){this.setState({hover:!0})},handleMouseLeave:function(){this.setState({hover:!1})}});e.exports=h}]);